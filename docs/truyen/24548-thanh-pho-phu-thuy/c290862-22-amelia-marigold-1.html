<!DOCTYPE html>
<html lang="vi" class="light">
<head>
    <meta charset="utf-8">
    
    <title>Đọc Thành Phố Phù Thủy - #22 - Amelia Marigold (1) - Cổng Light Novel - Đọc Light Novel</title>

    <meta name="description" content="5 năm đã trôi qua kể từ khi tôi bị bắt cóc và biến thành nô lệ trong một thành phố đầy rẫy phù thủy.">
    <meta name="theme-color" content="#000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="RYt3gQiv6TWmz022x2UAxMvLTv9p27tV8uPnFZPT">
    <meta name="logged-in" content="0">
    <meta property="fb:app_id" content="1864643850436909">

    <link rel="canonical" href="https://docln.net/truyen/24548-thanh-pho-phu-thuy/c290862-22-amelia-marigold-1">
    <meta property="og:image" content="https://i.hako.vn/ln/series/covers/s24548-0bd6f8e4-7ee5-4601-907e-c53123862cbd.jpg">


<style type="text/css">@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek/wght/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek-ext/wght/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/devanagari/wght/normal.woff2);unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FF;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek/400/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek-ext/400/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}</style>
    <link rel="preload" href="/fonts/OpenSans-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/fonts/OpenSans-SemiBold.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preconnect" href="https://www.google-analytics.com">

    <link rel="shortcut icon" href="/img/favicon.png?v=3">
    <link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon.png?v=3">
    <link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png?v=3">
    <link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png?v=3">

    <link rel="stylesheet" href="/css/interface.css?id=300c3109a58d319c9bb94c8585835c77">
    <link rel="stylesheet" href="/css/tailwind.css?id=9128bdee617e5eb876ffd418ed3597bf">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css" integrity="sha256-BtbhCIbtfeVWGsqxk1vOHEYXS6qcvQvLMZqjtpWUEx8=" crossorigin="anonymous" />
            
    
    <script src="/scripts/plugins.js?id=b612d946b32459430eed3066ed15adf2"></script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-34864968-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
      gtag('config', 'UA-34864968-3');
    </script>
</head>

<body>
	
    <div x-data="{ open: Cookies.get('globalwarning2') === undefined ? true : false }">
    <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4" x-show="open" style="display: none">
        <div class="flex">
            <div class="shrink-0">
                <button x-on:click="open = false; Cookies.set('globalwarning2', false, { expires: 0.5 })" type="button" class="inline-flex rounded-md bg-yellow-50 p-1.5 text-yellow-500 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-600 focus:ring-offset-2 focus:ring-offset-yellow-50">
                    <span class="sr-only">Dismiss</span>
                    <svg class="size-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
                    <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z" />
                    </svg>
                </button>
            </div>
            <div class="ml-3 font-bold">
                <p class="text-sm text-yellow-700">
                Nếu không thể <a class="font-medium text-blue-700" href="/thao-luan/2898-ten-mien-da-bi-chan">truy cập trang web</a> xin vui lòng sử dụng DNS 
                <a class="font-medium text-blue-700" href="https://www.google.com/search?q=c%C3%A1ch+c%C3%A0i+dns+1.1.1.1" target="_blank">1.1.1.1</a> hoặc <a class="font-medium text-blue-700" href="https://docln.sbs" target="_blank">docln.sbs</a>
                
                </p>
                <p>
                    <p class="text-sm text-orange-700">Hiện đang đứt cáp Internet APG, kết nối có thể chậm hoặc rất chậm. Dùng VPN không chắc có hiệu quả.</p>
                </p>
            </div>

        </div>
    </div>
</div>



	<style>
    body {
        background: inherit;
    }

    #footer {
        display: none;
    }
    
    .current-reading {
        background-color: rgba(189, 224, 254, 0.3);
        border-left: 5px solid #007bff;
        padding-left: 10px;
        transition: background-color 0.3s ease;
    }
</style>


<main id="mainpart" class="reading-page style-4">
    <section id="rd-side_icon" class="none force-block-l" aria-hidden="true">
                <a class="rd_sd-button_item rd_top-left" href="/truyen/24548-thanh-pho-phu-thuy/c290607-21-thi-tran-bien-gioi-6"><i class="fas fa-backward"></i></a>
        
        <a class="rd_sd-button_item" href="/truyen/24548-thanh-pho-phu-thuy"><i class="fas fa-home"></i></a>     
        <a id="rd-setting_icon" data-affect="#" class="rd_sd-button_item"><i class="fas fa-font"></i></a>
        <a id="rd-tts_icon" class="rd_sd-button_item"><i class="fas fa-volume-up"></i></a>
        <a id="rd-info_icon" data-affect="#rd_sidebar.chapters" class="rd_sd-button_item"><i class="fas fa-info"></i></a>
        <a id="rd-bookmark_icon" data-affect="#rd_sidebar.bookmarks" class="rd_sd-button_item"><i class="fas fa-bookmark"></i></a>

        
                <a class="rd_sd-button_item rd_top-right" href="/truyen/24548-thanh-pho-phu-thuy/c290870-23-amelia-marigold-2"><i class="fas fa-forward"></i></a>
            </section>    
    
    <section id="chapters" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <header class="rd_sidebar-header clear">
                <a class="img" href="/truyen/24548-thanh-pho-phu-thuy/c290862-22-amelia-marigold-1" style="background: url('https://i.hako.vn/ln/series/covers/s24548-0bd6f8e4-7ee5-4601-907e-c53123862cbd.jpg') no-repeat"></a> 
                <div class="rd_sidebar-name">                    
                    <h5><a href="/truyen/24548-thanh-pho-phu-thuy">Thành Phố Phù Thủy</a></h5>
                    <small><i class="fas fa-pen"></i>Hoa Tàn</small>
                    <small><i class="fas fa-paint-brush"></i></small>                
                </div>
            </header>

            <ul id="chap_list" class="unstyled">
                                                            <li class=""><a href="/truyen/24548-thanh-pho-phu-thuy/c287641-phu-thuy-nuoc-hoa-amelia-marigold">Minh họa nhân vật</a></li>
                                        
                                                            <li class="current"><a href="/truyen/24548-thanh-pho-phu-thuy/t35553-1-100">1-100</a></li>
                        <ul class="sub-chap_list unstyled">
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c287332-01-no-le-cua-thanh-pho-phu-thuy-1">
                                                                        #01 - Nô Lệ Của Thành Phố Phù Thủy (1)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c287397-02-no-le-cua-thanh-pho-phu-thuy-2">
                                                                        #02 - Nô Lệ Của Thành Phố Phù Thủy (2)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c287657-03-no-le-cua-thanh-pho-phu-thuy-3">
                                                                        #03 - Nô Lệ Của Thành Phố Phù Thủy (3)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c287835-04-no-le-cua-thanh-pho-phu-thuy-4">
                                                                        #04 - Nô Lệ Của Thành Phố Phù Thủy (4)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c287917-05-no-le-cua-thanh-pho-phu-thuy-5">
                                                                        #05 - Nô Lệ Của Thành Phố Phù Thủy (5)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c287918-06-no-le-cua-thanh-pho-phu-thuy-6">
                                                                        #06 - Nô Lệ Của Thành Phố Phù Thủy (6)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c287919-07-song-sinh-phu-thuy-1">
                                                                        #07 - Song Sinh Phù Thủy (1)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c287920-08-song-sinh-phu-thuy-2">
                                                                        #08 - Song Sinh Phù Thủy (2)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c288341-09-song-sinh-phu-thuy-3">
                                                                        #09 - Song Sinh Phù Thủy (3)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c288488-10-song-sinh-phu-thuy-4">
                                                                        #10 - Song Sinh Phù Thủy (4)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c288774-11-song-sinh-phu-thuy-5">
                                                                        #11 - Song Sinh Phù Thủy (5)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c289021-12-song-sinh-phu-thuy-6">
                                                                        #12 - Song Sinh Phù Thủy (6)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c289451-13-song-sinh-phu-thuy-7">
                                                                        #13 - Song Sinh Phù Thủy (7)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c289548-14-tai-nang-1">
                                                                        #14 - Tài Năng (1)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c289659-15-tai-nang-2">
                                                                        #15 - Tài Năng (2)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c289895-16-thi-tran-bien-gioi-1">
                                                                        #16 - Thị Trấn Biên Giới (1)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c289963-17-thi-tran-bien-gioi-2">
                                                                        #17 - Thị Trấn Biên Giới (2)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c290006-18-thi-tran-bien-gioi-3">
                                                                        #18 - Thị Trấn Biên Giới (3)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c290274-19-thi-tran-bien-gioi-4">
                                                                        #19 - Thị Trấn Biên Giới (4)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c290456-20-thi-tran-bien-gioi-5">
                                                                        #20 - Thị Trấn Biên Giới (5)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c290607-21-thi-tran-bien-gioi-6">
                                                                        #21 - Thị Trấn Biên Giới (6)
                                </a>
                            </li>
                                                        <li  class="current" >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c290862-22-amelia-marigold-1">
                                                                        #22 - Amelia Marigold (1)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24548-thanh-pho-phu-thuy/c290870-23-amelia-marigold-2">
                                                                        #23 - Amelia Marigold (2)
                                </a>
                            </li>
                                                    </ul>
                                        
                                        
            </ul>
        </main>
        <div class="black-click"></div>
    </section>
    
    <section id="bookmarks" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <div class="rd_sidebar-header">
                <h2 class="rd_s-name"><i class="fas fa-bookmark"></i><a href="/bookmark" style="color: white;"> Bookmarks</a></h2>
            </div>
            <ul id="bookmarks_list" class="unstyled">
                                            <li>Bạn phải đăng nhập để sử dụng bookmark</li>
                                        </ul>
        </main>
        <div class="black-click"></div>
    </section>

    <section id="setting" class="rdtoggle" aria-hidden="true">
        <section class="re_set-in basic-section clear rdtoggle_body">
        <header class="sect-header"><span class="sect-title">Tùy chỉnh</span></header>
            <main class="sect-body">
                <div class="set-list set-color clear">
                    <label class="font-bold">Màu nền</label>
                    <div class="set-input clear justify-center">
                        <span data-color="#ffffff" data-id="0" style="background-color: #ffffff"></span>
                        <span data-color="#e6f0e6" data-id="1" style="background-color: #e6f0e6"></span>
                        <span data-color="#e3f5fa" data-id="2" style="background-color: #e3f5fa"></span>
                        <span data-color="#f6f4ec" data-id="3" style="background-color: #f6f4ec"></span>
                        <span data-color="#eae4d3" data-id="4" style="background-color: #eae4d3"></span>
                        <span data-color="#f5e9ef" data-id="5" style="background-color: #f5e9ef"></span>
                        <span data-color="#222222" data-id="6" style="background-color: #222222"></span>
                        <span data-color="#000000" data-id="7" style="background-color: #000000"></span>
                    </div>
                </div>
                <div class="set-list set-font-family clear">
                    <label class="font-bold">Font chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <select>
                            <option>Times New Roman</option>
                            <option>Merriweather</option>
                            <option>Lora</option>
                            <option>Roboto</option>
                            <option>Noto Sans</option>
                            <option>Nunito</option>
                        </select>
                    </div>
                </div>
                <div class="set-list set-font clear">
                    <label class="font-bold">Kích cỡ chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="16px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-margin clear">
                    <label class="font-bold">Bản lề</label>
                    <div class="set-slide set-input justify-center">
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="20px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-text-align clear">
                    <label class="font-bold">Kiểu căn chỉnh</label>
                    <div class="set-input clear justify-center font-medium text-2xl flex flex-row gap-10">
                        <span data-align="text-left" class="p-1"><i class="fas fa-align-left"></i></span>
                        <span data-align="text-center" class="p-1"><i class="fas fa-align-center"></i></span>
                        <span data-align="text-right" class="p-1"><i class="fas fa-align-right"></i></span>
                        <span data-align="text-justify" class="p-1"><i class="fas fa-align-justify"></i></span>
                    </div>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>

    <section id="tts-panel" class="rdtoggle" aria-hidden="true">
        <section class="tts-settings basic-section clear rdtoggle_body">
            <header class="sect-header"><span class="sect-title">Text-to-Speech</span></header>
            <main class="sect-body">
                <div class="set-list clear" style="color: red; font-size: 14px; margin-bottom: 20px">
                    Đây là chức năng đang thử nghiệm, chi tiết xem tại <a href="/thao-luan/3305-chuc-nang-doc" style="color: blue">Link</a>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Giọng đọc</label>
                    <select id="tts-voice-select" class="w-full p-2 border rounded bg-white dark:bg-gray-800 text-sm dark:border-gray-600"></select>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Tốc độ</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-rate" min="0.1" max="3" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-rate-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Độ cao (Pitch)</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-pitch" min="0" max="2" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-pitch-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="flex gap-2 pt-4">
                    <button id="tts-play-btn" class="flex-1 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Phát</button>
                    <button id="tts-pause-btn" class="flex-1 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Tạm dừng</button>
                    <button id="tts-stop-btn" class="flex-1 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Dừng</button>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>
    
    <div class="container">
        <div class="row">
            <div class="reading-content col-12 col-lg-10 offset-lg-1" style="word-wrap: break-word;">
                <div id="bookmark_top" class="block d-lg-none"><i class="fas fa-bookmark"></i></div>
                <span class="save_bookmark" style="position: absolute; top: 9999px; display: none"><i class="fas fa-bookmark"></i></span>
                
                
                
                <div class="title-top" style="padding-top: 20px">
                    <h2 class="title-item text-xl font-bold" align="center">1-100</h2>
                    <h4 class="title-item text-base font-bold" align="center">#22 - Amelia Marigold (1)</h4>
                    <h6 class="title-item font-bold" align="center" aria-hidden="true">
                        <a href="https://docln.net/truyen/24548-thanh-pho-phu-thuy/c290862-22-amelia-marigold-1#chapter-comments" style="text-decoration: underline">3 Bình luận</a> -
                        Độ dài: 2,749 từ - Cập nhật: 
                        <time class="topic-time timeago" title="15-01-2026 22:47:01" datetime="2026-01-15T22:47:01+07:00"></time>                    </h6>
                </div>

                <div style="text-align: center; margin: 20px auto -20px auto;">
                                                            <a href="https://docs.google.com/forms/d/e/1FAIpQLSe3y_bpPb6ADsKAgPWE3o3Jgzzftw8NKkp93_5vUayXLaQICg/viewform" target="_blank">
                        <img src="https://i2.hako.vip/vault/2025final_1.webp" style="width: 700px; height: auto">
                    </a>
                </div>

                <div id="chapter-content" class="long-text no-select text-justify">
                    <p style="display: none">#22 - Amelia Marigold (1)</p>
                    <p id="1"><strong>1.</strong></p><p id="2">Amelia, sau khi buông những lời quở trách cay nghiệt với Siwoo.</p><p id="3">Y cúi đầu lia lịa, rời khỏi phòng tắm như thể đang trốn chạy.</p><p id="4">Nhìn bóng y khuất dần sau vách kính mờ, Amelia mới khẽ buông một tiếng thở dài.</p><p id="5">Sự nhẹ nhõm khi lời bao biện vội vã và vụng về đã thành công.</p><p id="6">Và rồi, cảm giác tự khinh bỉ vì đã phải nói dối để thoát khỏi khoảnh khắc ấy cứ nhói lên trong lồng ngực.</p><p id="7">Amelia vùi mình đến tận chóp mũi trong bồn tắm đầy bọt xà phòng, và ký ức của năm năm về trước chợt lướt qua tâm trí.</p><p id="8">Đó là câu chuyện của một ngày đông buồn tẻ, chán ngán, chẳng có gì khác biệt.</p><p id="9">“Amelia, cô không thấy chán sao?”</p><p id="10">“Lại chuyện gì nữa đây, Avenuga.”</p><p id="11">“Vì buồn chán nên ta mới tìm đến cô đây.”</p><p id="12">“Thật phiền phức.”</p><p id="13">Amelia đáp lời con quạ của Avenuga, kẻ chẳng biết chán mà tìm đến phòng nghiên cứu.</p><p id="14">Một con quạ mà khi sải cánh cũng lớn gần bằng màn hình máy tính.</p><p id="15">Bị mu bàn tay Amelia khẽ đẩy ra tỏ vẻ phiền phức, con quạ vỗ cánh phần phật rồi đáp xuống chiếc đèn bàn.</p><p id="16">Nàng ta vẫn luôn tìm đến và phá rối những lúc nàng đang nghiên cứu thế này.</p><p id="17">“Ngày nào cũng vùi đầu vào ma thuật hai mươi tiếng đồng hồ, sao cô cứ phải sống một cuộc đời vô vị như vậy? Cô đã đi trước tiền nhân đến hai con đường ma thuật rồi cơ mà.”</p><p id="18">“Đây là sự nghiệp vĩ đại mà ta kế thừa, thứ đã phải đánh đổi bằng cả sinh mệnh của Sư phụ. Ta không thể lơ là dù chỉ một khoảnh khắc.”</p><p id="19">“Qua-ack”.</p><p id="20">Nghe lời Amelia, con quạ chớp chớp lớp màng mắt trắng đục, nghiêng đầu qua lại vài lần.</p><p id="21">Quả thực, lời nói của Amelia ẩn chứa một quan niệm khác thường mà một phù thủy bình thường khó lòng thấu tỏ.</p><p id="22">Hoàn thiện Ấn ký là một sự nghiệp vĩ đại, còn quan trọng hơn cả việc bảo toàn sinh mệnh của một phù thủy.</p><p id="23">Việc kế thừa ắt hẳn cũng vì mục đích đó, vậy mà nàng lại nói như thể chính Ấn ký đã tước đi sinh mệnh của Sư phụ mình.</p><p id="24">Dĩ nhiên, Sophia đâu nông nổi đến mức nói toạc ra điều đó.</p><p id="25">Sophia biết rõ mối quan hệ giữa Amelia và Sư phụ.</p><p id="26">Chẳng hiếm những trường hợp mà sợi dây liên kết bền chặt như tình thân cha mẹ chảy trôi giữa một phù thủy tập sự và sư phụ của mình.</p><p id="27">“Nhưng cứ lao tâm khổ tứ như vậy, chẳng mấy chốc cô cũng sẽ phải truyền lại Ấn ký thôi, thấy chưa?”</p><p id="28">“Nếu tài năng cạn kiệt thì đó là lẽ dĩ nhiên.”</p><p id="29">“Nói vậy chứ cô cũng đã nhận phù thủy tập sự nào đâu.”</p><p id="30">“Vì ta vẫn còn nhiều điều có thể làm.”</p><p id="31">“Thế thì có cần phải miệt mài đến vậy ngay từ bây giờ không? Trông cô cứ như một phù thủy trong buổi hoàng hôn, sắp phải truyền lại Ấn ký cho đệ tử đến nơi rồi.”</p><p id="32">Nhìn con quạ đang mở miệng quàng quạc, Amelia thở dài rồi đặt bút xuống.</p><p id="33">Xem chừng Sophia hôm nay không có ý định lặng lẽ rời đi.</p><p id="34">“Hôm nay cô định làm phiền ta bằng chuyện gì đây?”</p><p id="35">“Học viện vừa tiếp nhận nô lệ mới, cô biết không?.”</p><p id="36">“Thì sao?”</p><p id="37">“Là đàn ông đó. Mà còn tận hai người.”</p><p id="38">Một chuyện chẳng liên quan, cũng chẳng đáng bận tâm.</p><p id="39">Dường như đọc được vẻ mặt đó, con quạ vội vã cất lời.</p><p id="40">Vẻ mặt vội vã của một con quạ, quả là một cách diễn tả có phần nực cười.</p><p id="41">“Amelia, đây là lời khuyên của tiền nhân gia tộc Avenuga... cô có muốn nghe không?”</p><p id="42">“Thế nào rồi cô cũng sẽ lải nhải bên tai cho đến khi ta đồng ý nghe thôi chứ gì? Nói đi.”</p><p id="43">Amelia và Sophia vốn không hợp nhau.</p><p id="44">Bởi Sophia là một kẻ lì lợm, cứ thế xông tới mà chẳng hề nao núng trước những lời châm chọc mà Amelia dùng để tránh phiền phức.</p><p id="45">Vì thế, để ngăn chặn một sự phiền toái lớn hơn, nàng đành miễn cưỡng lắng nghe.</p><p id="46">“Sư phụ ta từng nói, sự ngột ngạt của một căn phòng kín sẽ lắng đọng thành lớp trầm tích chôn vùi mọi nguồn cảm hứng sáng tạo. Chẳng phải việc nghiên cứu của cô đã đi vào bế tắc một thời gian rồi sao?”</p><p id="47">“......”</p><p id="48">Với đôi mắt của Sophia, người gần như ngày nào cũng tìm đến, điều đó hẳn không thể qua mặt được.</p><p id="49">Bản phác thảo pháp trận mà Amelia đang dày công nghiên cứu đã dậm chân tại chỗ suốt mấy tháng trời.</p><p id="50">Nàng thiếu đi một manh mối mang tính quyết định.</p><p id="51">Đây là thời điểm cần phải sáng tạo ra một công thức mới, chứ không chỉ đơn thuần là thay đổi những biến số được áp dụng.</p><p id="52">“Thấy chưa. Ấy là vì ngày nào cô cũng ở trong cùng một công phòng, nhìn cùng một quang cảnh và làm cùng một việc. Đầu ra luôn tỷ lệ thuận với đầu vào. Thỉnh thoảng thay đổi không khí cũng tốt mà?”</p><p id="53">“Còn cô thì ngày nào cũng chỉ thay đổi không khí.”</p><p id="54">Sophia tiếp tục nói như thể chẳng nghe thấy lời của Amelia.</p><p id="55">“Phố xá cũng không đi~ Trừ lúc mua ma cụ, đến phòng trà cũng chẳng ghé~ Tới nhà tắm công cộng cũng chỉ tắm rồi về~ Suốt ngày chỉ có phòng nghiên cứu, ký túc xá, phòng nghiên cứu, ký túc xá, phòng nghiên cứu, ký túc xá. Cứ thế này thì làm sao nảy ra ý tưởng mới được! Điều cô cần lúc này không phải là cứ bám riết lấy vấn đề, mà là một trải nghiệm mới. Ta nói có đúng không nào.”</p><p id="56">Cách Sophia dụ dỗ Amelia quả thực rất khôn khéo và phù hợp.</p><p id="57">Nếu chỉ nói rằng chơi cùng nhau sẽ vui lắm, thì liệu một kẻ cuồng ma thuật ru rú trong phòng như Amelia có thèm nghe không?</p><p id="58">Nếu không phải vì linh thể của một phù thủy, Amelia hẳn đã bị chiếc ghế đè cho mông bẹp dí từ lâu rồi.</p><p id="59">Vì vậy, nàng ta mới khéo léo lồng vào lời khuyên “vì ma thuật”.</p><p id="60">Thực tế, Amelia dù vờ như để ngoài tai, nhưng vẫn không thể đuổi con quạ của Sophia đi được.</p><p id="61">“Vậy thì sao?”</p><p id="62">“Hôm nay hãy cùng bước lên những bậc thang của người lớn nào.”</p><p id="63">“Một trải nghiệm mới đâu nhất thiết phải là hành vi giao hoan, phải không?”</p><p id="64">Thật ra đây không phải là lần đầu tiên nàng nhận được lời đề nghị như vậy.</p><p id="65">Khác với một Amelia chính thống, Sophia là một phù thủy khá phóng khoáng.</p><p id="66">Lý do Amelia khinh miệt Sophia trong lần gặp đầu tiên cũng là vì cái thói kỳ quặc, hễ thấy hợp ý là không phân biệt nam nữ mà lên giường.</p><p id="67">Bây giờ, qua nhiều cuộc trò chuyện, nàng đã đi đến kết luận rằng Sophia không phải là một người phụ nữ quá tồi tệ, nhưng tách bạch khỏi chuyện đó, hành động của Sophia lúc nào cũng cố lôi kéo Amelia vào sở thích của mình quả thực phiền phức không gì tả xiết.</p><p id="68">“Không đâu. Về bản chất, giao cấu là quá trình nam nữ cùng nhau tạo ra một sinh mệnh mới. Đó chẳng phải là bản thân sự ‘sáng tạo’ sao? Dù chúng ta không thể sinh con vì Ấn ký, nhưng chính hành vi đó lại là nền tảng cao quý đã tạo ra hàng chục tỷ sinh mệnh trong suốt hàng triệu triệu năm qua.”</p><p id="69">Đến đoạn này, nàng bắt đầu cảm thấy chán ngán vì phải nghiêm túc lắng nghe những lời nhảm nhí như thế.</p><p id="70">Amelia, người hiếm hoi đang lắng nghe, bỗng quay đi như thể mất hứng.</p><p id="71">“Ta đã nghe đủ rồi, giờ thì đi đi.”</p><p id="72">“Ak... ak...”</p><p id="73">Amelia chẳng buồn để tâm, cầm lấy bút lần nữa.</p><p id="74">Có lẽ từ giờ trở đi, dù Sophia có nói gì, nàng cũng sẽ phớt lờ và tiếp tục viết nguệch ngoạc những công thức tính toán vô nghĩa.</p><p id="75">Để vuột mất con cá lớn hiếm hoi vừa cắn câu, Sophia quyết định dùng một chiến thuật khác.</p><p id="76">Nếu chiến thuật đầu tiên của Sophia là “liên kết với ma thuật”, thì chiến thuật thứ hai là “nhẹ nhàng khích vào lòng tự tôn của nàng”.</p><p id="77">“Tch, đành vậy. Ta nghĩ cô nên tự hào hơn về ngoại hình của mình.”</p><p id="78">“........”</p><p id="79">“Cô đủ xinh đẹp và quyến rũ. Dù thân hình không đầy đặn nữ tính như ta, nhưng chẳng có mấy người đàn ông có thể dửng dưng khi nhìn cô đâu?”</p><p id="80">“.........”</p><p id="81">“Chưa từng yêu đương, thậm chí còn ít khi trò chuyện với đàn ông nên có thể cô sẽ ngượng ngùng và sợ hãi. Nhưng bất cứ trải nghiệm đầu tiên nào cũng đều khó khăn cả.”</p><p id="82">“........”</p><p id="83">Sophia bắt đầu khéo léo khích tướng Amelia, người đang hoàn toàn phớt lờ nàng.</p><p id="84">Nàng tự ý diễn giải lý do Amelia không gặp gỡ đàn ông là “vì thiếu tự tin vào ngoại hình của mình” và “vì nhút nhát”.</p><p id="85">Đúng như dự đoán, nó đã có hiệu quả.</p><p id="86">Cặp chân mày của Amelia đang co giật thấy rõ.</p><p id="87">Điều quan trọng là sự cân bằng.</p><p id="88">Với một Amelia bướng bỉnh như tiền nhân nhà Marigold, tốt nhất là chỉ nên kích thích lòng hiếu thắng của nàng ở một mức độ vừa phải, không quá chạm đến lòng tự tôn.</p><p id="89">“Thực ra cô cũng có một nét trẻ con đáng yêu lắm đấy. Biết đâu nếu thể hiện ra, cô cũng sẽ được đàn ông yêu mến thì sao. Ngay cả ta là phụ nữ nhìn vào còn thấy cô dễ thương mà.”</p><p id="90">Đến đây, chỉ cần khéo léo lồng vào từ khóa “nét trẻ con”, Amelia sẽ chấp nhận cuộc chơi.</p><p id="91">Thật dễ đối phó.</p><p id="92">Amelia lại ném cây bút lông ngỗng xuống bàn, mắt trợn trừng.</p><p id="93">Theo cách của riêng mình, đó hẳn là một lời đe dọa, nhưng trông chỉ đáng yêu mà thôi.</p><p id="94">“Ai trẻ con cơ chứ?”</p><p id="95">“Ah! Xin lỗi. Nếu làm cô khó chịu thì ta xin lỗi nhé.”</p><p id="96">“Thứ ta học được từ Sư phụ không chỉ có ma thuật, mà còn là phong thái của một mệnh phụ, là lễ nghi của một quý tộc. Tất cả những điều đó đều có chiều sâu không thể nào so sánh được với hạng quý tộc nửa mùa như cô đâu, Avenuga.”</p><p id="97">Amelia tuyên bố một cách nghiêm nghị.</p><p id="98">Con quạ bay phần phật từ chiếc đèn bàn xuống, dụi má vào mu bàn tay Amelia để tỏ lòng xin lỗi.</p><p id="99">“Xin lỗi, đừng giận mà. Với tư cách là bạn bè, ta chỉ mong cô có thêm nhiều trải nghiệm thôi. Ta cũng muốn được thấy một Amelia trưởng thành hơn.”</p><p id="100">“Hầy....”</p><p id="101">Amelia thở dài rồi đứng dậy khỏi chỗ.</p><p id="102">Con quạ của Sophia vô cùng phấn khích, kêu quàng quạc và bay vòng quanh trên đầu Amelia.</p><p id="103">“Ta sẽ cho cô thấy cô đã lầm. Vậy nên từ nay về sau đừng làm phiền ta nữa.”</p><p id="104">“Eh? Ý cô là sao?”</p><p id="105">Trước một Sophia đang vờ như không biết, Amelia nói một lời.</p><p id="106">“Một lần thì thôi, cô nghĩ ta sẽ bị lừa bởi cùng một mánh khóe hết lần này đến lần khác sao? Ta biết thừa là cô cố tình chọc tức ta.”</p><p id="107">Nói vậy chứ trông nàng cũng có vẻ tức giận lắm...</p><p id="108">Lời đó, Sophia cẩn thận cất giấu trong lòng.</p><p id="109">“Ta không thể đồng tình rằng một hành vi thấp kém chỉ biết theo đuổi khoái lạc lại là nguồn cảm hứng cho sự sáng tạo. Ta cũng không có ý định làm chuyện đó. Ta đứng lên chỉ để chứng minh rằng lời của cô là sai.”</p><p id="110">“Ta đã nói gì nhỉ...?”</p><p id="111">“Cái phần cô nói ta không tự tin, và vì thế mà sợ hãi việc đối thoại với đàn ông. Điều đó sai rồi. Ta không làm là vì không cảm thấy cần thiết mà thôi.”</p><p id="112">Đàn ông là những sinh vật hạ đẳng không thể sử dụng ma thuật cao siêu.</p><p id="113">“Dẫn đường đến chỗ nô lệ đi.”</p><p id="114">Amelia buông xõa mái tóc đã buộc gọn, bắt đầu bước đi với dáng vẻ hiên ngang.</p><p id="115"><strong>2.</strong></p><p id="116">“Nhưng mà quyến rũ một tên nô lệ thì có hơi dễ dãi quá không? Một tên nô lệ thì làm sao dám từ chối mệnh lệnh của phù thủy chứ?”</p><p id="117">“Chẳng phải chỉ cần nhìn phản ứng là cô biết được hắn có miễn cưỡng hay không sao?”</p><p id="118">Theo sự dẫn lối của con quạ, Amelia đi qua hành lang sáng rực, rồi bước vào thư viện tranh tối tranh sáng.</p><p id="119">Đó là vì nàng nhận được thông báo rằng một trong những nô lệ mới được phân bổ hai ngày trước đang ở đây.</p><p id="120">Vừa mở cửa, hình ảnh một tên nô lệ đang mải mê sắp xếp thư viện đã hiện ra.</p><p id="121">Tên nô lệ đó sẽ đảm nhận vị trí quản lý tại Học viện Trinity với tư cách là nô lệ của tòa thị chính trong sáu năm tới.</p><p id="122">Nhân tiện thỉnh thoảng cũng sẽ được dùng làm trợ giảng, nhưng đó không phải là vấn đề quan trọng.</p><p id="123">Nhìn bộ dạng vẫn đang làm việc dù đã qua giờ làm từ lâu, trông y có vẻ vẫn chưa thích nghi được.</p><p id="124">Hoặc là, một gã đàn ông có chút ngốc nghếch.</p><p id="125">“Người quản lý Shin Siwoo.”</p><p id="126">“Vâng! Thưa phù thủy!”</p><p id="127">RẦM</p><p id="128">Cùng với tiếng đáp lời dõng dạc, tên nô lệ ngã lăn từ trên thang xuống.</p><p id="129">Y đứng dậy từ trong đống bụi, với vẻ mặt cứng đờ chạy đến và đứng nghiêm trước mặt Amelia.</p><p id="130">Chỉ cần cho Sophia đậu trên vai thấy mình có thể quyến rũ một gã đàn ông bằng một lời, nàng ta sẽ chấp nhận và biến mất.</p><p id="131">Khi đó, nàng sẽ có thể tập trung vào nghiên cứu một thời gian mà không bị ai làm phiền.</p><p id="132">Thực ra, nhìn dáng vẻ của y đang ngây ngất ngắm nhìn khuôn mặt mình, có lẽ việc kiểm chứng như vậy cũng chẳng cần thiết.</p><p id="133">“Khi công việc kết thúc, hãy đến phòng ngủ của ta.”</p><p id="134">Chẳng phải y đã say mê lắm rồi sao?</p><p id="135">Vả lại, Amelia chưa bao giờ cảm thấy bất mãn với ngoại hình của mình.</p><p id="136">Cả mái tóc vàng mềm mại tựa như được dệt từ những thỏi vàng óng ánh, lẫn đôi mắt xanh trong như chứa đựng cả bầu trời.</p><p id="137">Tất cả đều được Sư phụ khen là rất đẹp.</p><p id="138">Chỉ có vậy thôi sao?</p><p id="139">Khí chất và lễ nghi đã được thấm nhuần vào cơ thể qua quá trình giáo dục lâu dài.</p><p id="140">Cả thần thái mà một phù thủy tất nhiên phải có.</p><p id="141">Nàng tự tin rằng mình sở hữu một sức hấp dẫn không thể so sánh được với một phù thủy rởm đời như Sophia.</p><p id="142">“Vậy nhé...”</p><p id="143">Cứ nhìn phản ứng kia thì cũng chẳng cần nghe câu trả lời.</p><p id="144">Nàng định cứ thế này quay lưng và đi về ký túc xá.</p><p id="145">Gã đàn ông ngây ngô này sẽ ôm ấp đủ loại tưởng tượng dâm tà mà đến phòng ngủ, nhưng rồi sẽ chẳng thể làm được gì cả.</p><p id="146">Nàng không phải là một người phụ nữ trác táng đến mức lên giường với người đàn ông mới gặp lần đầu, công dụng của y chỉ cần đủ để chứng minh sức hấp dẫn của nàng với Sophia là được.</p><p id="147">“Tôi xin lỗi!”</p><p id="148">Và rồi, lời nói của người đàn ông vang lên ngoài dự kiến.</p><p id="149">Y cúi gập người, đầu gần như chạm đất, và hét lên lời xin lỗi.</p><p id="150">“Quack! Quack! Quack!”</p><p id="151">Trước tình huống không thể ngờ tới, con quạ trên vai Amelia vỗ cánh loạn xạ và phá lên cười.</p><p id="152">Gương mặt nàng nóng bừng, lan một màu đỏ ửng.</p><p id="153">Amelia, người chưa từng mảy may tưởng tượng sẽ bị một tên nô lệ từ chối, cảm thấy đầu óc mình hoàn toàn trống rỗng.</p>

                    <p style="display: none">Hãy bình luận để ủng hộ người đăng nhé!</p>
                    
                    <!-- <div class="flex justify-center mt-10 mb-7 space-x-3">
                        <a
                            href="https://hako.vn/discord"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #7289da; text-decoration: initial; color: white !important;">
                            <svg
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                xmlns="http://www.w3.org/2000/svg"
                                fill-rule="evenodd"
                                clip-rule="evenodd"
                                viewbox="0 0 24 24">
                                <path
                                d="M19.54 0c1.356 0 2.46 1.104 2.46 2.472v21.528l-2.58-2.28-1.452-1.344-1.536-1.428.636 2.22h-13.608c-1.356 0-2.46-1.104-2.46-2.472v-16.224c0-1.368 1.104-2.472 2.46-2.472h16.08zm-4.632 15.672c2.652-.084 3.672-1.824 3.672-1.824 0-3.864-1.728-6.996-1.728-6.996-1.728-1.296-3.372-1.26-3.372-1.26l-.168.192c2.04.624 2.988 1.524 2.988 1.524-1.248-.684-2.472-1.02-3.612-1.152-.864-.096-1.692-.072-2.424.024l-.204.024c-.42.036-1.44.192-2.724.756-.444.204-.708.348-.708.348s.996-.948 3.156-1.572l-.12-.144s-1.644-.036-3.372 1.26c0 0-1.728 3.132-1.728 6.996 0 0 1.008 1.74 3.66 1.824 0 0 .444-.54.804-.996-1.524-.456-2.1-1.416-2.1-1.416l.336.204.048.036.047.027.014.006.047.027c.3.168.6.3.876.408.492.192 1.08.384 1.764.516.9.168 1.956.228 3.108.012.564-.096 1.14-.264 1.74-.516.42-.156.888-.384 1.38-.708 0 0-.6.984-2.172 1.428.36.456.792.972.792.972zm-5.58-5.604c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332.012-.732-.54-1.332-1.224-1.332zm4.38 0c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332 0-.732-.54-1.332-1.224-1.332z" />
                            </svg>
                            Discord
                        </a>
                        <a
                            href="https://fb.com/hako.page"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #1877f2; text-decoration: initial; color: white !important;">
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                viewBox="0 0 24 24">
                                <path
                                d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z" />
                            </svg>
                            Facebook
                        </a>
                    </div> -->

                                        <a href="/truyen/12377" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/12377/f162c340-e615-453e-96f2-ea60f39f3592.jpg?t=1756572253" class="d-none d-md-block" style="width: 970px; height: auto">
                    </a>
                    <a href="/truyen/12377" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/12377/7b4a9212-81a5-436f-bb19-1f0ea545eb5c.jpg?t=1756572253" class="d-md-none" style="width: 100%; height: auto">
                    </a>
                    
                                    </div>

                <div style="text-align: center; margin: 20px auto 10px auto;">
                                                        </div>
                
                <section class="rd-basic_icon row">
                    <a href="/truyen/24548-thanh-pho-phu-thuy/c290607-21-thi-tran-bien-gioi-6" class="dark:text-black col text-center "><i class="fas fa-backward"></i></a>
                    <a href="/truyen/24548-thanh-pho-phu-thuy" class="dark:text-black col text-center"><i class="fas fa-home"></i></a>
                    <a href="/truyen/24548-thanh-pho-phu-thuy/c290870-23-amelia-marigold-2" class="dark:text-black col text-center "><i class="fas fa-forward"></i></a>
                </section>
                
                <!--the code style is important to keep this comment section be out of the effect of user reading's setting-->
            </div>
            <div class="col-12 col-lg-10 offset-lg-1" aria-hidden="true">
                <section id="chapter-comments" class="basic-section dark:bg-[#1f1f1f] dark:text-white dark:border dark:border-[#1f1f1f]">
                    <header class="sect-header tab-list dark:bg-[#2a2a2a] dark:border-[#2a2a2a]"> 
                        <span class="sect-title tab-title" data-tab-index="1">Bình luận <span class="comments-count">(3)</span></span>
                    </header>
                    <main id="fbcmt_root" class="sect-body">
                        <span style="padding: 10px; display: inline-block;">Báo cáo bình luận không phù hợp ở <a href="/thao-luan/619-bao-cao-binh-luan" style="color: blue">đây</a></span>
                        <div id="tab-content-1" class="tab-content clear">
                            <section class="ln-comment">
    <header>
        <h3 class="text-lg font-bold dark:text-white">3 Bình luận </h3>
        <!-- <i id="refresh_comment" class="fas fa-refresh" aria-hidden="true" style="margin-left: 10px; font-size: 18px"></i></h3> -->
            </header>

    <main class="ln-comment-body">
                    <div class="ln-comment_sign-in long-text">
                Bạn phải <a href="/login">đăng nhập</a> hoặc <a href="/register">tạo tài khoản</a> để bình luận.
            </div>
                
        
        
        <div class="ln-comment-group">
    <div id="ln-comment-3165272"
    class="ln-comment-item mt-3 clear"
    data-comment="3165272" 
    data-parent="3165272" 
    data-type="chapter" 
    data-typeid="290862">
    <div class="flex gap-1 max-w-full">
        <div class="w-[50px]">
            <div class="mx-1 my-1">
                <img src="https://i.hako.vn/ln/users/avatars/u186599-039aa7e6-2cac-48e4-a279-91dcf1a5086e.jpg" class="w-full rounded-full" />
            </div>
        </div>
        <div
            class="w-full min-w-0 rounded-md bg-gray-100 ps-1 pe-0 pb-1 pt-0 dark:!bg-zinc-800 ">
            <div class="flex min-w-0 flex-col px-2">
                <div class="flex align-top justify-between">
                    <div class="flex flex-wrap gap-x-2 gap-y-1 align-middle pt-1">
    <div class="self-center">
        <a class="font-bold leading-6 md:leading-7 ln-username " href="/thanh-vien/186599">thanhtrungg</a>
    </div>
                                    </div>
                                        
                </div>
                                                    <div class="ln-comment-content long-text">
                        Tfnc
                    </div>
                    <div class="comment_see_more expand none">Xem thêm</div>
                    <div class="flex gap-2 align-bottom text-[13px] visible-toolkit">
                        <a href="/truyen/24548-thanh-pho-phu-thuy/c290862-22-amelia-marigold-1?comment_id=3165272#ln-comment-3165272"
                            class="text-slate-500">
                            <time class="timeago" title="15-01-2026 23:23:19"
                                datetime="2026-01-15T23:23:19+07:00">
                                15-01-2026 23:23:19
                            </time>
                        </a>
                        <a
                            class="self-center visible-toolkit-item do-like cursor-pointer">
                            <i class="fas fa-thumbs-up me-1"></i>
                            <span class="likecount font-semibold"></span>
                        </a>
                                            </div>
                            </div>
        </div>
    </div>
</div>

    </div>
<div class="ln-comment-group">
    <div id="ln-comment-3165269"
    class="ln-comment-item mt-3 clear"
    data-comment="3165269" 
    data-parent="3165269" 
    data-type="chapter" 
    data-typeid="290862">
    <div class="flex gap-1 max-w-full">
        <div class="w-[50px]">
            <div class="mx-1 my-1">
                <img src="https://i.docln.net/lightnovel/users/ua147424-264c24b7-a4f8-4824-85f3-21be18b06471.jpg" class="w-full rounded-full" />
            </div>
        </div>
        <div
            class="w-full min-w-0 rounded-md bg-gray-100 ps-1 pe-0 pb-1 pt-0 dark:!bg-zinc-800 ">
            <div class="flex min-w-0 flex-col px-2">
                <div class="flex align-top justify-between">
                    <div class="flex flex-wrap gap-x-2 gap-y-1 align-middle pt-1">
    <div class="self-center">
        <a class="font-bold leading-6 md:leading-7 ln-username " href="/thanh-vien/147424">NguyenPhanTeBao</a>
    </div>
                                    </div>
                                        
                </div>
                                                    <div class="ln-comment-content long-text">
                        LiKe!<br>
Chẹp, thấy cũng tội mà tsun thì thôi
                    </div>
                    <div class="comment_see_more expand none">Xem thêm</div>
                    <div class="flex gap-2 align-bottom text-[13px] visible-toolkit">
                        <a href="/truyen/24548-thanh-pho-phu-thuy/c290862-22-amelia-marigold-1?comment_id=3165269#ln-comment-3165269"
                            class="text-slate-500">
                            <time class="timeago" title="15-01-2026 23:19:30"
                                datetime="2026-01-15T23:19:30+07:00">
                                15-01-2026 23:19:30
                            </time>
                        </a>
                        <a
                            class="self-center visible-toolkit-item do-like cursor-pointer">
                            <i class="fas fa-thumbs-up me-1"></i>
                            <span class="likecount font-semibold"></span>
                        </a>
                                            </div>
                            </div>
        </div>
    </div>
</div>

    </div>
<div class="ln-comment-group">
    <div id="ln-comment-3165223"
    class="ln-comment-item mt-3 clear"
    data-comment="3165223" 
    data-parent="3165223" 
    data-type="chapter" 
    data-typeid="290862">
    <div class="flex gap-1 max-w-full">
        <div class="w-[50px]">
            <div class="mx-1 my-1">
                <img src="https://i.hako.vn/ln/users/avatars/u217516-71ad82f9-2b7c-4215-84af-f56ebdcf28eb.jpg" class="w-full rounded-full" />
            </div>
        </div>
        <div
            class="w-full min-w-0 rounded-md bg-gray-100 ps-1 pe-0 pb-1 pt-0 dark:!bg-zinc-800 ">
            <div class="flex min-w-0 flex-col px-2">
                <div class="flex align-top justify-between">
                    <div class="flex flex-wrap gap-x-2 gap-y-1 align-middle pt-1">
    <div class="self-center">
        <a class="font-bold leading-6 md:leading-7 ln-username " href="/thanh-vien/217516">T Đ Anh</a>
    </div>
                                    </div>
                                        
                </div>
                                                    <div class="ln-comment-content long-text">
                        Tfnc.
                    </div>
                    <div class="comment_see_more expand none">Xem thêm</div>
                    <div class="flex gap-2 align-bottom text-[13px] visible-toolkit">
                        <a href="/truyen/24548-thanh-pho-phu-thuy/c290862-22-amelia-marigold-1?comment_id=3165223#ln-comment-3165223"
                            class="text-slate-500">
                            <time class="timeago" title="15-01-2026 22:53:10"
                                datetime="2026-01-15T22:53:10+07:00">
                                15-01-2026 22:53:10
                            </time>
                        </a>
                        <a
                            class="self-center visible-toolkit-item do-like cursor-pointer">
                            <i class="fas fa-thumbs-up me-1"></i>
                            <span class="likecount font-semibold"></span>
                        </a>
                                            </div>
                            </div>
        </div>
    </div>
</div>

    </div>

<div class="ln-comment-page">
</div>    </main>

    <script>
        var token = 'RYt3gQiv6TWmz022x2UAxMvLTv9p27tV8uPnFZPT';
        var comment_type = 'chapter';
        var comment_typeid = '290862';
    </script>

    </section>


                        </div>
                    </main>
                </section>
            </div> 
        </div>
    </div>
</main>

<script>
    token = 'RYt3gQiv6TWmz022x2UAxMvLTv9p27tV8uPnFZPT';
        
    function turnoffall() {
        $(".rdtoggle").removeClass("on");
        $(".rdtoggle_body").removeClass("animation fade-in-left-big fade-in-down");
        $("html").removeClass("overflow-hiden");
    }
    
    function rdtoggle(classicon, effect) {
        if ($(classicon).hasClass("on")) {
            turnoffall();
        } else {
            turnoffall();
            $(classicon).addClass("on");
            $("html").addClass("overflow-hiden");
            $(classicon + " .rdtoggle_body").addClass("animation " + effect);
        } 
    };
    
    $("#rd-setting_icon").on('click', function() {
        rdtoggle("#setting", "fade-in-down");                   
    });

    $("#rd-tts_icon").on('click', function() {
        rdtoggle("#tts-panel", "fade-in-down");
    });
        
    $("#rd-info_icon").on('click', function() {
        rdtoggle("#chapters", "fade-in-left-big");              
    });
        
    $("#rd-bookmark_icon").on('click', function() {
        rdtoggle("#bookmarks", "fade-in-left-big");                     
    });
        
    $(".black-click").on('click', function() {
        turnoffall();
        $("#rd-side_icon").hide();
        $("#bookmark_top").removeClass("on");
    });
        
    var bgcolor    = Cookies.get('color') || (Cookies.get('night_mode') ? 6 : 4);
    var fontfamily = Cookies.get('fontfamily') || '';
    var fontsize   = Cookies.get('font') || 18; 
    var margin     = Cookies.get('margin') || 0;
    var textAlign  = Cookies.get('textAlign') || 'text-justify';
        
    function setcolor(alter = true) {
        var switcher = $(".set-color .set-input span").eq(bgcolor);
        switcher.addClass("current");

        if (alter) {
            for (var i = 0; i < $(".set-color .set-input span").length; i++) {
                $("#mainpart").removeClass('style-' + i);
                $("#mainpart").removeClass('dark');
            }
            $("#mainpart").addClass('style-' + bgcolor);

            // Manually hardcoded to dark
            if (bgcolor >= 6) {
                $("#mainpart").addClass('dark');
            }
        }
    }

    // This creates unsmooth experience so we only use it for select box
    function setfontfamily() {
        $('.set-font-family select option').filter(function () {
            return fontfamily.split(',')[0].indexOf($(this).text()) != -1 ;
        }).attr('selected', true);
    }
        
    function setfontstyle(alter = true) {
        $(".set-font input.set-slide_input").val(fontsize + "px"); 

        if (alter) {
            $("div#chapter-content").css("font-size", fontsize + "px");

            var lineheight = +fontsize + 10;
            $("#chapter-content").css("line-height", lineheight + "px");
        }
    }
        
    function setmargin() {
        $(".set-margin input.set-slide_input").val(margin + "px"); 
        $("#chapter-content").css({
            'padding-left': margin + "px",
            'padding-right': margin + "px"
        });
    }

    function setTextAlign(alter = true) {
        var switcher = $(".set-text-align .set-input span[data-align='" + textAlign + "']");
        switcher.addClass("current");

        if (alter) {
            $(".set-text-align .set-input span").each(function () {
                $("#chapter-content").removeClass($(this).attr('data-align'));
            });

            $("#chapter-content").addClass(textAlign);
        }
    }
    
    setcolor(false);
    setfontfamily();
    setfontstyle(false);
    setmargin();
    setTextAlign(true);
    
    //1px = 0.0625rem;
    //16px = 1rem (default);
    
    $(".set-color .set-input span").click(function(){
        bgcolor = $(this).data("id");
        $(".set-color .set-input span").removeClass("current");
        setcolor();            
        Cookies.set('color', bgcolor, { expires: 365 });
    });

    $('.set-font-family select').on('change', function () {
        fontfamily = "'" + $('option:selected', this).text() + "', " + '\'Times New Roman\', Georgia, serif';
        
        $('div#chapter-content').css('font-family', fontfamily);

        Cookies.set('fontfamily', fontfamily, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-smaller").click(function () {
        fontsize = fontsize - 2;
        if (fontsize < 0) fontsize = 0;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-bigger").click(function () {
        fontsize = +fontsize + 2;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-smaller").click(function () {
        margin = margin - 20;
        if (margin < 0) margin = 0;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-bigger").click(function () {
        margin = +margin + 20;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    }); 

    $(".set-text-align .set-input span").click(function(){
        textAlign = $(this).data("align");
        $(".set-text-align .set-input span").removeClass("current");
        setTextAlign();        
        Cookies.set('textAlign', textAlign, { expires: 365 });
    });
        
    $("#bookmarks_list li").each(function(){
        var linepr = $(this).data("line");
        var preview = $(".reading-content p#" + linepr).text();

        var shortText = preview.trim().substring(0, 30) + "...";
        $(this).find(".pos_bookmark small").text(shortText);
    });

    $('div#chapter-content').html(
        $('div#chapter-content').html().replace(
            /\[note(\d+)\]/gi, 
            '<span id="anchor-note$1" class="note-icon none-print inline note-tooltip" data-tooltip-content="#note$1 .note-content" data-note-id="note$1"><i class="fas fa-sticky-note"></i></span><a id="anchor-note$1" class="inline-print none" href="#note$1">[note]</a>'
        )
    )
    
    tippy('.note-tooltip', {
        delay: 50,
        maxWidth: 240,
        interactive: true,
        content(ref) {
            const selector = ref.getAttribute('data-tooltip-content');
            const template = document.querySelector(selector);
            return template ? template.innerHTML : 'Đặt sai ID của note';
        }
    });
        
    isLoggedIn = 0;
    series_id = parseInt('24548');
    chapter_id = parseInt('290862');

    readingObject = {
        series_id: series_id,
        series_title: 'Thành Phố Phù Thủy',
        series_url: $('i.fa-home').first().parent().attr('href'),
        series_cover: $('.rd_sidebar-header a.img').css('background-image'),
        chapter_title: $('ul.sub-chap_list li.current a').text().trim(),
        chapter_url: $('ul.sub-chap_list li.current a').attr('href'),
        book_title: $('ul#chap_list > li.current a').text(),
        book_url: $('ul#chap_list > li.current a').attr('href'),
        read_time: +new Date() / 1000 | 0,
    };

// TTS Manager - Enhanced Web Speech API (Vietnamese). Chunked queue for long texts, no delays/interrupts.
const synth = window.speechSynthesis;
let voices = [];
let voicesLoaded = false;
let ttsRate = parseFloat(localStorage.getItem('tts-rate')) || 1;
let ttsPitch = parseFloat(localStorage.getItem('tts-pitch')) || 1;
let ttsState = 'idle'; // idle, speaking, paused, loading
let currentChunk = 0;
let totalChunks = 0;
let processingIndex = 0;
let paragraphs = [];
const BUFFER_SIZE = 5;

// --- Background Persistence (Wake Lock + Silent Audio) ---
let wakeLock = null;
const silentAudio = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTSVNFAAAAPAAADEVuY29kZWQgd2l0aCBMYW1lMy4xMDBhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUA==');
silentAudio.loop = true;

async function enableConnection() {
    // 1. Start Silent Audio Loop (tricks browser into thinking we are a music player)
    try {
        await silentAudio.play();
    } catch (err) {
        console.warn('Silent Audio Play Failed (likely no interaction):', err);
    }

    // 2. Request Screen Wake Lock (prevents screen from sleeping automatically)
    if ('wakeLock' in navigator) {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (err) {
            console.warn('Wake Lock Request Failed:', err);
        }
    }
}

function disableConnection() {
    // 1. Stop Silent Audio
    try {
        silentAudio.pause();
        silentAudio.currentTime = 0;
    } catch (e) {}

    // 2. Release Wake Lock
    if (wakeLock) {
        try {
            wakeLock.release();
            wakeLock = null;
        } catch (e) {}
    }
}

// Re-acquire Wake Lock if visibility changes and we are speaking
document.addEventListener('visibilitychange', async () => {
    if (wakeLock !== null && document.visibilityState === 'visible' && ttsState === 'speaking') {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (e) {}
    }
});
// ---------------------------------------------------------

let ttsVoiceIdx = localStorage.getItem('tts-voice') || '0';

function populateVoices() {
    voices = synth.getVoices().filter(v => v.lang.startsWith('vi'));
    voicesLoaded = true;
    let $select = $('#tts-voice-select');
    $select.empty();

    if (voices.length === 0) {
        $select.append('<option value="-1">Không có giọng Việt (cài Chrome/Edge)</option>');
        return;
    }

    voices.forEach((voice, idx) => {
        $select.append(`<option value="${idx}">${voice.name} (${voice.lang}) ${voice.default ? '(mặc định)' : ''}</option>`);
    });

    let idx = Math.max(0, Math.min(parseInt(ttsVoiceIdx), voices.length - 1));
    $select.val(idx);
}

function updateTTSUI(progress = '') {
    let $icon = $('#rd-tts_icon i');
    $icon.removeClass('fa-volume-up fa-volume-mute fa-spinner fa-spin');
    let $playBtn = $('#tts-play-btn'), $pauseBtn = $('#tts-pause-btn'), $stopBtn = $('#tts-stop-btn');
    $playBtn.prop('disabled', ttsState === 'speaking' || ttsState === 'loading'); // Enable on idle/paused
    $pauseBtn.prop('disabled', ttsState === 'idle');
    $stopBtn.prop('disabled', ttsState === 'idle');
    // Always remove old progress
    $('#tts-progress').remove();

    if (progress && totalChunks > 0) {
        $playBtn.after(`<span id="tts-progress" class="text-xs block text-center mt-1">${progress}</span>`);
    }

    if (ttsState === 'idle') {
        // Check resume preview
        const resumeData = loadResumeState();
        let currentParagraphs = $('#chapter-content p').map(function() {
            return $(this).text().trim();
        }).get().filter(p => p.trim().length > 0);

        if (resumeData && resumeData.total === currentParagraphs.length) {
            $playBtn.text(`Tiếp tục (${resumeData.index + 1}/${resumeData.total})`);
        } else {
            $playBtn.text('Phát');
        }

        $icon.addClass('fa-volume-up');
    } else if (ttsState === 'speaking' || ttsState === 'loading') {
        $icon.addClass('fa-volume-up fa-spinner fa-spin');
    } else if (ttsState === 'paused') {
        $icon.addClass('fa-volume-mute');
    }
}

$('#tts-play-btn').off('click').on('click', function() {
    // Always restart/resume from storage
    enableConnection(); // Start keep-alive
    synth.cancel();
    ttsState = 'idle';
    // queuedUtterances = []; // Removed global queue
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();

    if (!voicesLoaded || voices.length === 0) {
        ttsState = 'loading';
        updateTTSUI();
        setTimeout(() => {
            if (!voicesLoaded) {
                alert('Giọng nói chưa tải. Thử lại.');
                ttsState = 'idle';
                updateTTSUI();
                return;
            }
            playTTS();
        }, 500);
        return;
    }

    playTTS();
});

function createUtterance(item) {
    let u = new SpeechSynthesisUtterance(item.text);
    u.lang = 'vi-VN';
    u.rate = parseFloat($('#tts-rate').val()) || 1;
    u.pitch = parseFloat($('#tts-pitch').val()) || 1;
    let voiceIdx = parseInt($('#tts-voice-select').val());

    if (voiceIdx >= 0 && voices[voiceIdx]) {
        u.voice = voices[voiceIdx];
    }

    u.onstart = () => {
        currentChunk++;
        saveResumeState();
        updateTTSUI(`${currentChunk}/${totalChunks}`);
        
        // Highlight logic
        $('.current-reading').removeClass('current-reading');
        if (item.el) {
            $(item.el).addClass('current-reading');
            item.el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        feedQueue(); // Ensure buffer is maintained
    };
    u.onerror = (event) => {
        console.error('TTS Error:', event.error, event);

        if (event.error !== 'interrupted') {
             // alert(`Lỗi TTS: ${event.error}. Bỏ qua đoạn.`);
             console.warn('TTS Error skipping chunk', event.error);
        }

        saveResumeState(); // Save on error
        feedQueue();
    };
    u.onend = () => {
        saveResumeState();

        if (currentChunk >= totalChunks) {
            clearResumeState();
            $('.current-reading').removeClass('current-reading'); // Cleanup
            
            // Auto-Next Logic
            let $nextBtn = $('.rd-basic_icon a').last();
            if ($nextBtn.length && !$nextBtn.hasClass('disabled')) {
                localStorage.setItem('tts-autoplay', 'true');
                window.location.href = $nextBtn.attr('href');
                return;
            }

            ttsState = 'idle';
            disableConnection(); // Cleanup
            currentChunk = 0;
            totalChunks = 0;
            processingIndex = 0;
            updateTTSUI();
        } else {
            feedQueue();
        }
    };
    u.onpause = () => { saveResumeState(); };
    return u;
}

function getStorageData() {
    try {
        return JSON.parse(localStorage.getItem('tts-resume-data')) || {};
    } catch {
        return {};
    }
}

function setStorageData(data) {
    localStorage.setItem('tts-resume-data', JSON.stringify(data));
}

function saveResumeState() {
    if (totalChunks > 0) {
        const data = getStorageData();
        data[chapter_id] = {
            index: currentChunk,
            total: totalChunks,
            timestamp: Date.now()
        };
        // Optional: Clean up old entries (older than 7 days?) to prevent infinite growth, 
        // but for now we just save.
        setStorageData(data);
    }
}

function clearResumeState() {
    const data = getStorageData();

    if (data[chapter_id]) {
        delete data[chapter_id];
        setStorageData(data);
    }
}

function loadResumeState() {
    const data = getStorageData();
    const saved = data[chapter_id];
    
    if (!saved) return null;
    
    if (Date.now() - saved.timestamp > 3600000 * 24 * 7) { // 7 days
        clearResumeState();
        return null;
    }

    return saved;
}

function initTTS() {
    populateVoices();
    $('#tts-rate').val(ttsRate);
    $('#tts-rate-value').text(ttsRate);
    $('#tts-pitch').val(ttsPitch);
    $('#tts-pitch-value').text(ttsPitch);
    updateTTSUI();
    
    if (localStorage.getItem('tts-autoplay') === 'true') {
        localStorage.removeItem('tts-autoplay');
        $(window).on('load', function() {
             setTimeout(() => {
                 $('#tts-play-btn').click(); 
             }, 500); 
        });
    }
}

function getParagraphs() {
    return $('#chapter-content p').map(function() {
        let text = $(this).text().trim();
        
        // If paragraph contains an image, replace with "Hình ảnh"
        if ($(this).find('img').length > 0) {
            text = 'Hình ảnh';
        }
        
        if (text.length > 0) {
            return { text: text, el: this };
        }
    }).get();
}

function feedQueue() {
    if (ttsState !== 'speaking') return;
    
    // Maintain buffer
    while (processingIndex < totalChunks && processingIndex < currentChunk + BUFFER_SIZE) {
        let u = createUtterance(paragraphs[processingIndex]);
        synth.speak(u);
        processingIndex++;
    }
}

function playTTS() {
    paragraphs = getParagraphs();
    if (paragraphs.length === 0) {
        alert('Không có nội dung để đọc.');
        ttsState = 'idle';
        disableConnection(); // Cleanup
        updateTTSUI();
        return;
    }
    
    const resumeData = loadResumeState();
    if (resumeData && resumeData.total === paragraphs.length) {
        currentChunk = resumeData.index;
        totalChunks = resumeData.total;
        // processingIndex needs to match what we are about to play
        // Current chunk is what finished, so we start processing from currentChunk?
        // Wait, currentChunk is "index of just finished" in some contexts?
        // No, in loadResume, index is currentChunk.
        // If saved index is 5. means 0..4 played.
        // We start playing from 5 (index).
        // So processingIndex = currentChunk.
        processingIndex = currentChunk;
    } else {
        clearResumeState();
        currentChunk = 0;
        totalChunks = paragraphs.length;
        processingIndex = 0;
    }
    
    synth.cancel();
    ttsState = 'speaking';
    
    feedQueue();
    updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
}

$('#tts-rate').on('input', function() {
    $('#tts-rate-value').text(this.value);
    localStorage.setItem('tts-rate', this.value);
});

$('#tts-pitch').on('input', function() {
    $('#tts-pitch-value').text(this.value);
    localStorage.setItem('tts-pitch', this.value);
});

$('#tts-voice-select').on('change', function() {
    localStorage.setItem('tts-voice', this.value);
});

$('#tts-pause-btn').off('click').on('click', function() {
    if (ttsState === 'speaking') {
        synth.pause();
        ttsState = 'paused';
        disableConnection(); // Pause keep-alive
        updateTTSUI();
        saveResumeState();
    } else if (ttsState === 'paused') {
        enableConnection(); // Resume keep-alive
        synth.resume();
        ttsState = 'speaking';
        updateTTSUI();
    }
});

$('#tts-stop-btn').off('click').on('click', function() {
    synth.cancel();
    // clearResumeState(); // Stop doesn't necessarily clear resume, usually just pause? 
    // But UI says "Stop". Let's clear resume state to consistent with old behavior 
    // or maybe optional? Old behavior cleared it.
    clearResumeState();
    
    disableConnection(); // Stop keep-alive
    $('.current-reading').removeClass('current-reading'); // Cleanup
    ttsState = 'idle';
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();
});

// Visibility handler removed - TTS continues on tab switch

// Long-press to start TTS from selected paragraph (500ms hold)
let longPressTimer = null;
let longPressTarget = null;

// $('#chapter-content p').on('touchstart mousedown', function(e) {
//     longPressTarget = this;
//     longPressTimer = setTimeout(() => {
//         const allParagraphs = getParagraphs();
//         const startIndex = allParagraphs.findIndex(p => p.el === longPressTarget);

//         if (startIndex === -1) return;

//         clearResumeState();
//         synth.cancel();
        
//         paragraphs = allParagraphs;
//         currentChunk = startIndex;
//         totalChunks = paragraphs.length;
//         processingIndex = startIndex;
//         ttsState = 'speaking';
        
//         enableConnection();
//         feedQueue();
//         updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
//     }, 500);
// }).on('touchend touchmove mouseup mouseleave', function() {
//     clearTimeout(longPressTimer);
//     longPressTimer = null;
// });

synth.onvoiceschanged = populateVoices;
initTTS();
</script>

    <div id="mature_modal" class="modal">
    <div class="modal-content animation fade-in-down">
        <div class="modal-header">
            <span class="fs-3" style="color: white">Cảnh báo nội dung</span>
        </div>
        <div class="modal-body">
            <span>Truyện bạn muốn xem có chứa nội dung nhạy cảm, phù hợp với lứa tuổi 18 trở lên. Hãy cân nhắc trước khi tiếp tục.</span>
        </div>
        <div class="modal-footer">
            <button class="button button-red btn_confirm" id="mature_confirm" style="margin-top: 10px;">Tôi hiểu và đồng ý tiếp tục</button>
            <a class="button button-white" class="btn_exit" href="/" style="margin-left: 10px; margin-top: 10px;">Quay lại</a>
        </div>
    </div>
</div>

    
    <script src="/scripts/service-manager.js?r=4"></script>

    <script src="/scripts/app.js?id=a5a24eca66adcfc75cc0b2f62e2611db"></script>
    <script src="https://docln.net/vendor/livewire/livewire.min.js?id=df3a17f2"   data-csrf="RYt3gQiv6TWmz022x2UAxMvLTv9p27tV8uPnFZPT" data-update-uri="/livewire/update" data-navigate-once="true"></script>

    
    <script src="https://confidecross.com/d5/6b/4b/d56b4bd6c3d2c1e161c4ab3c78c27670.js" async></script>

        
            <footer id="footer">
    <div class="container">
        <!--<span><a href="">Hako.re</a></span>-->
        <span class="right">Liên hệ: <a href="mailto:contact@hako.vn" target="_blank" style="color: #5fff46">contact@hako.vn</a></span>

        <span>© 2016 - 2026 Cổng Light Novel - Đọc Light Novel</span>
    </div>
</footer>    
    <div x-data x-show="$store.toast.on" @click="$store.toast.hide()" class="bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fixed w-3/4 md:w-1/2 z-20 inset-x-0 bottom-10 mx-auto" role="alert" style="display: none">
    <div class="flex">
        <div class="py-1"><svg class="fill-current h-6 w-6 text-teal-500 mr-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"/></svg></div>
        <div>
            <p class="font-bold capitalize">Chú ý</p>
            <p class="text-sm" x-text="$store.toast.message"></p>
        </div>
    </div>
</div></body>
</html>
