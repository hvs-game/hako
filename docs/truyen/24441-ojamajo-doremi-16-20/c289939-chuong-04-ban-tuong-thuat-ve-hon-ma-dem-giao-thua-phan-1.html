<!DOCTYPE html>
<html lang="vi" class="light">
<head>
    <meta charset="utf-8">
    
    <title>Đọc Ojamajo Doremi 16-20 - Chương 04: Bản tường thuật về hồn ma đêm Giao thừa - phần 1 - Cổng Light Novel - Đọc Light Novel</title>

    <meta name="description" content="Bộ tiểu thuyết Light Novel này là &quot;phần tiếp theo&quot; của Ojamajo Doremi ,Lấy bối cảnh 3 năm sau các sự kiện của Dokkan , Ojamajo đã trưởng thành và hiện đang học cấp 3.">
    <meta name="theme-color" content="#000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="xrsumIcJJy4biR01ndrzmdFJXPTZjPByPTOg925x">
    <meta name="logged-in" content="0">
    <meta property="fb:app_id" content="1864643850436909">

    <link rel="canonical" href="https://docln.net/truyen/24441-ojamajo-doremi-16-20/c289939-chuong-04-ban-tuong-thuat-ve-hon-ma-dem-giao-thua-phan-1">
    <meta property="og:image" content="https://i.hako.vn/ln/series/covers/s24441-47680fc7-cf81-4221-b9bb-42a39e944152.jpg">


<style type="text/css">@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek-ext/wght/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/devanagari/wght/normal.woff2);unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek/wght/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek-ext/400/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek/400/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}</style>
    <link rel="preload" href="/fonts/OpenSans-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/fonts/OpenSans-SemiBold.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preconnect" href="https://www.google-analytics.com">

    <link rel="shortcut icon" href="/img/favicon.png?v=3">
    <link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon.png?v=3">
    <link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png?v=3">
    <link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png?v=3">

    <link rel="stylesheet" href="/css/interface.css?id=300c3109a58d319c9bb94c8585835c77">
    <link rel="stylesheet" href="/css/tailwind.css?id=9128bdee617e5eb876ffd418ed3597bf">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css" integrity="sha256-BtbhCIbtfeVWGsqxk1vOHEYXS6qcvQvLMZqjtpWUEx8=" crossorigin="anonymous" />
            
    
    <script src="/scripts/plugins.js?id=b612d946b32459430eed3066ed15adf2"></script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-34864968-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
      gtag('config', 'UA-34864968-3');
    </script>
</head>

<body>
	
    <div x-data="{ open: Cookies.get('globalwarning2') === undefined ? true : false }">
    <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4" x-show="open" style="display: none">
        <div class="flex">
            <div class="shrink-0">
                <button x-on:click="open = false; Cookies.set('globalwarning2', false, { expires: 0.5 })" type="button" class="inline-flex rounded-md bg-yellow-50 p-1.5 text-yellow-500 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-600 focus:ring-offset-2 focus:ring-offset-yellow-50">
                    <span class="sr-only">Dismiss</span>
                    <svg class="size-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
                    <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z" />
                    </svg>
                </button>
            </div>
            <div class="ml-3 font-bold">
                <p class="text-sm text-yellow-700">
                Nếu không thể <a class="font-medium text-blue-700" href="/thao-luan/2898-ten-mien-da-bi-chan">truy cập trang web</a> xin vui lòng sử dụng DNS 
                <a class="font-medium text-blue-700" href="https://www.google.com/search?q=c%C3%A1ch+c%C3%A0i+dns+1.1.1.1" target="_blank">1.1.1.1</a> hoặc <a class="font-medium text-blue-700" href="https://docln.sbs" target="_blank">docln.sbs</a>
                
                </p>
                <p>
                    <p class="text-sm text-orange-700">Hiện đang đứt cáp Internet APG, kết nối có thể chậm hoặc rất chậm. Dùng VPN không chắc có hiệu quả.</p>
                </p>
            </div>

        </div>
    </div>
</div>



	<style>
    body {
        background: inherit;
    }

    #footer {
        display: none;
    }
    
    .current-reading {
        background-color: rgba(189, 224, 254, 0.3);
        border-left: 5px solid #007bff;
        padding-left: 10px;
        transition: background-color 0.3s ease;
    }
</style>


<main id="mainpart" class="reading-page style-4">
    <section id="rd-side_icon" class="none force-block-l" aria-hidden="true">
                <a class="rd_sd-button_item rd_top-left" href="/truyen/24441-ojamajo-doremi-16-20/c289601-chuong-03-phep-mau-giang-sinh-phan-1"><i class="fas fa-backward"></i></a>
        
        <a class="rd_sd-button_item" href="/truyen/24441-ojamajo-doremi-16-20"><i class="fas fa-home"></i></a>     
        <a id="rd-setting_icon" data-affect="#" class="rd_sd-button_item"><i class="fas fa-font"></i></a>
        <a id="rd-tts_icon" class="rd_sd-button_item"><i class="fas fa-volume-up"></i></a>
        <a id="rd-info_icon" data-affect="#rd_sidebar.chapters" class="rd_sd-button_item"><i class="fas fa-info"></i></a>
        <a id="rd-bookmark_icon" data-affect="#rd_sidebar.bookmarks" class="rd_sd-button_item"><i class="fas fa-bookmark"></i></a>

        
         
        <a class="rd_sd-button_item rd_top-right disabled"><i class="fas fa-forward"></i></a>
            </section>    
    
    <section id="chapters" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <header class="rd_sidebar-header clear">
                <a class="img" href="/truyen/24441-ojamajo-doremi-16-20/c289939-chuong-04-ban-tuong-thuat-ve-hon-ma-dem-giao-thua-phan-1" style="background: url('https://i.hako.vn/ln/series/covers/s24441-47680fc7-cf81-4221-b9bb-42a39e944152.jpg') no-repeat"></a> 
                <div class="rd_sidebar-name">                    
                    <h5><a href="/truyen/24441-ojamajo-doremi-16-20">Ojamajo Doremi 16-20</a></h5>
                    <small><i class="fas fa-pen"></i>Midori Kuriyama, Yumi Kageyama</small>
                    <small><i class="fas fa-paint-brush"></i>Yoshihiko Umakoshi</small>                
                </div>
            </header>

            <ul id="chap_list" class="unstyled">
                                                            <li class=""><a href="/truyen/24441-ojamajo-doremi-16-20/c280897-chuong-01-mua-xuan-no-ro">Ojamajo Doremi 16</a></li>
                                        
                                                            <li class="current"><a href="/truyen/24441-ojamajo-doremi-16-20/t35327-ojamajo-doremi-16-naive">Ojamajo Doremi 16 ~ Naive</a></li>
                        <ul class="sub-chap_list unstyled">
                                                        <li >
                                <a href="/truyen/24441-ojamajo-doremi-16-20/c287723-chuong-01-mua-thu-cua-moi-nguoi">
                                                                            <i class="fas fa-picture-o" aria-hidden="true" title="Có chứa ảnh"></i>
                                                                        Chương 01: Mùa thu của mỗi người - phần 1
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24441-ojamajo-doremi-16-20/c287770-chuong-01-mua-thu-cua-moi-nguoi-phan-2">
                                                                        Chương 01: Mùa thu của mỗi người - phần 2
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24441-ojamajo-doremi-16-20/c288934-chuong-01-mua-thu-cua-moi-nguoi-phan-3">
                                                                            <i class="fas fa-picture-o" aria-hidden="true" title="Có chứa ảnh"></i>
                                                                        Chương 01: Mùa thu của mỗi người - phần 3
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24441-ojamajo-doremi-16-20/c289175-chuong-01-mua-thu-cua-moi-nguoi-phan-4">
                                                                            <i class="fas fa-picture-o" aria-hidden="true" title="Có chứa ảnh"></i>
                                                                        Chương 01: Mùa thu của mỗi người - phần 4
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24441-ojamajo-doremi-16-20/c289231-chuong-02-workshop-girl">
                                                                            <i class="fas fa-picture-o" aria-hidden="true" title="Có chứa ảnh"></i>
                                                                        Chương 02: Workshop Girl
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24441-ojamajo-doremi-16-20/c289584-chuong-03-phep-mau-giang-sinh">
                                                                            <i class="fas fa-picture-o" aria-hidden="true" title="Có chứa ảnh"></i>
                                                                        Chương 03: Phép màu giáng sinh - phần 1
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24441-ojamajo-doremi-16-20/c289601-chuong-03-phep-mau-giang-sinh-phan-1">
                                                                        Chương 03: Phép màu giáng sinh - phần 2
                                </a>
                            </li>
                                                        <li  class="current" >
                                <a href="/truyen/24441-ojamajo-doremi-16-20/c289939-chuong-04-ban-tuong-thuat-ve-hon-ma-dem-giao-thua-phan-1">
                                                                        Chương 04: Bản tường thuật về hồn ma đêm Giao thừa - phần 1
                                </a>
                            </li>
                                                    </ul>
                                        
                                        
            </ul>
        </main>
        <div class="black-click"></div>
    </section>
    
    <section id="bookmarks" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <div class="rd_sidebar-header">
                <h2 class="rd_s-name"><i class="fas fa-bookmark"></i><a href="/bookmark" style="color: white;"> Bookmarks</a></h2>
            </div>
            <ul id="bookmarks_list" class="unstyled">
                                            <li>Bạn phải đăng nhập để sử dụng bookmark</li>
                                        </ul>
        </main>
        <div class="black-click"></div>
    </section>

    <section id="setting" class="rdtoggle" aria-hidden="true">
        <section class="re_set-in basic-section clear rdtoggle_body">
        <header class="sect-header"><span class="sect-title">Tùy chỉnh</span></header>
            <main class="sect-body">
                <div class="set-list set-color clear">
                    <label class="font-bold">Màu nền</label>
                    <div class="set-input clear justify-center">
                        <span data-color="#ffffff" data-id="0" style="background-color: #ffffff"></span>
                        <span data-color="#e6f0e6" data-id="1" style="background-color: #e6f0e6"></span>
                        <span data-color="#e3f5fa" data-id="2" style="background-color: #e3f5fa"></span>
                        <span data-color="#f6f4ec" data-id="3" style="background-color: #f6f4ec"></span>
                        <span data-color="#eae4d3" data-id="4" style="background-color: #eae4d3"></span>
                        <span data-color="#f5e9ef" data-id="5" style="background-color: #f5e9ef"></span>
                        <span data-color="#222222" data-id="6" style="background-color: #222222"></span>
                        <span data-color="#000000" data-id="7" style="background-color: #000000"></span>
                    </div>
                </div>
                <div class="set-list set-font-family clear">
                    <label class="font-bold">Font chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <select>
                            <option>Times New Roman</option>
                            <option>Merriweather</option>
                            <option>Lora</option>
                            <option>Roboto</option>
                            <option>Noto Sans</option>
                            <option>Nunito</option>
                        </select>
                    </div>
                </div>
                <div class="set-list set-font clear">
                    <label class="font-bold">Kích cỡ chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="16px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-margin clear">
                    <label class="font-bold">Bản lề</label>
                    <div class="set-slide set-input justify-center">
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="20px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-text-align clear">
                    <label class="font-bold">Kiểu căn chỉnh</label>
                    <div class="set-input clear justify-center font-medium text-2xl flex flex-row gap-10">
                        <span data-align="text-left" class="p-1"><i class="fas fa-align-left"></i></span>
                        <span data-align="text-center" class="p-1"><i class="fas fa-align-center"></i></span>
                        <span data-align="text-right" class="p-1"><i class="fas fa-align-right"></i></span>
                        <span data-align="text-justify" class="p-1"><i class="fas fa-align-justify"></i></span>
                    </div>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>

    <section id="tts-panel" class="rdtoggle" aria-hidden="true">
        <section class="tts-settings basic-section clear rdtoggle_body">
            <header class="sect-header"><span class="sect-title">Text-to-Speech</span></header>
            <main class="sect-body">
                <div class="set-list clear" style="color: red; font-size: 14px; margin-bottom: 20px">
                    Đây là chức năng đang thử nghiệm, chi tiết xem tại <a href="/thao-luan/3305-chuc-nang-doc" style="color: blue">Link</a>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Giọng đọc</label>
                    <select id="tts-voice-select" class="w-full p-2 border rounded bg-white dark:bg-gray-800 text-sm dark:border-gray-600"></select>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Tốc độ</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-rate" min="0.1" max="3" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-rate-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Độ cao (Pitch)</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-pitch" min="0" max="2" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-pitch-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="flex gap-2 pt-4">
                    <button id="tts-play-btn" class="flex-1 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Phát</button>
                    <button id="tts-pause-btn" class="flex-1 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Tạm dừng</button>
                    <button id="tts-stop-btn" class="flex-1 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Dừng</button>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>
    
    <div class="container">
        <div class="row">
            <div class="reading-content col-12 col-lg-10 offset-lg-1" style="word-wrap: break-word;">
                <div id="bookmark_top" class="block d-lg-none"><i class="fas fa-bookmark"></i></div>
                <span class="save_bookmark" style="position: absolute; top: 9999px; display: none"><i class="fas fa-bookmark"></i></span>
                
                
                
                <div class="title-top" style="padding-top: 20px">
                    <h2 class="title-item text-xl font-bold" align="center">Ojamajo Doremi 16 ~ Naive</h2>
                    <h4 class="title-item text-base font-bold" align="center">Chương 04: Bản tường thuật về hồn ma đêm Giao thừa - phần 1</h4>
                    <h6 class="title-item font-bold" align="center" aria-hidden="true">
                        <a href="https://docln.net/truyen/24441-ojamajo-doremi-16-20/c289939-chuong-04-ban-tuong-thuat-ve-hon-ma-dem-giao-thua-phan-1#chapter-comments" style="text-decoration: underline">0 Bình luận</a> -
                        Độ dài: 3,286 từ - Cập nhật: 
                        <time class="topic-time timeago" title="13-01-2026 22:46:43" datetime="2026-01-13T22:46:43+07:00"></time>                    </h6>
                </div>

                <div style="text-align: center; margin: 20px auto -20px auto;">
                                                            
                </div>

                <div id="chapter-content" class="long-text no-select text-justify">
                    <p style="display: none">Chương 04: Bản tường thuật về hồn ma đêm Giao thừa - phần 1</p>
                    <p id="1">——</p><p id="2">(Chào buổi sáng. Dạo này trời lạnh quá nhỉ?)</p><p id="3">Đừng lo, tôi hoàn toàn khỏe mạnh. Tôi chỉ muốn chào buổi sáng một cách đàng hoàng thôi.</p><p id="4">Ngoài ra, trong nhà cũng có một học sinh đang học hành chăm chỉ để chuẩn bị cho kỳ thi tuyển sinh, nên dạo này cả nhà đều cư xử rất đúng mực.</p><p id="5">Hả? Năm ngoái tôi cũng từng rơi vào tình huống tương tự mà? Nhưng tôi không nhớ lúc đó mọi người đều cư xử tế nhị như vậy. Chẳng phải như vậy hơi thiên vị sao?</p><p id="6">Thôi kệ vậy. Kỳ thi tuyển sinh vào học viện nữ sinh Karen sẽ diễn ra vào tháng Hai tới, và em gái tôi, Pop, đang học hành rất chăm chỉ. Tôi nhớ hồi đó kỳ thi của tôi là vào tháng Ba. Khoảng cách một tháng đó có phải là lý do giải thích sự khác biệt về động lực học tập của chúng tôi không? Ý tôi là, tôi không nghĩ là năm ngoái mình lười biếng đến thế, nhưng rõ ràng sự quyết tâm của Pop bây giờ còn mạnh mẽ hơn tôi lúc đó nhiều.</p><p id="7">Pop đã học hành rất chăm chỉ, và các giáo viên của em ấy nói rằng cơ hội đỗ cao. Tôi tự hỏi liệu em ấy có giống tôi, khá yếu trong các kỳ thi cuối kỳ không. Nhưng, xét theo tính cách của em ấy, tôi thực sự không nghĩ vậy.</p><p id="8">~~~~~</p><p id="9">Tôi mở cửa sổ, để luồng gió lạnh ùa vào phòng. Những cái cây trong vườn sau nhà đã rụng gần hết lá, và vì sương giá đọng trên cành, mỗi buổi sáng chúng lại lấp lánh như được phủ một lớp pha lê. Dạo này trời lạnh thật, nhưng xem ra hôm nay sẽ là một ngày nắng đẹp.</p><p id="10">Giáng Sinh đã trôi qua trong một chuỗi bận rộn, và kỳ nghỉ đông cũng chính thức bắt đầu. Thế nhưng lượng báo cáo và bài tập được giao nhiều đến mức khiến khối lượng bài vở hồi còn học cấp hai bỗng trở nên… nhẹ nhàng như trò trẻ con. Đúng là làm tụt hẳn tinh thần.</p><p id="11">Thôi thì cũng sắp đến năm mới rồi.</p><p id="12">Công việc dạo này khá nhẹ nhàng vì cửa hàng sẽ nghỉ vào ngày mùng Một, nhưng tôi vẫn cố gắng làm thật chăm chỉ để kiếm tiền thưởng cuối năm. Nếu không kiếm được ít nhất là tiền thưởng tương đương một tháng rưỡi lương, tôi sẽ cảm thấy mình quá thua kém Pop mất. Vì vậy tôi nhất định phải cố gắng hơn nữa.</p><p id="13">Dù trong nhà có người đang chuẩn bị thi tuyển sinh, các khâu chuẩn bị cho ngày Tết vẫn diễn ra như thường lệ. Tôi bận rộn với việc tổng vệ sinh, cả ở nhà lẫn tại MAHO-do.</p><p id="14">Còn mọi người thì đón năm mới thế nào, bạn hỏi tôi?</p><p id="15">Momo-chan đã sang Thượng Hải để thăm bố. Onpu-chan cũng đang trong kỳ nghỉ đông, nhưng vì bận quay phim ngoại cảnh và học tiếng Anh nên gần như chẳng có thời gian nghỉ ngơi.</p><p id="16">Gia đình Hazuki-chan thì tổ chức tiệc cuối năm, mà bố cậu ấy lại là đạo diễn nổi tiếng, nên chắc sẽ có rất nhiều khách. Còn Ai-chan thì giống tôi, đón năm mới khá đơn giản, nhưng ngày nào cậu ấy cũng ép bản thân tập luyện không ngơi nghỉ.</p><p id="17">——</p><p id="18">“Này, chuẩn bị đi viếng đền thờ thôi.”</p><p id="19">Đó là ngày đầu năm mới, và mọi việc diễn ra bình thường. Chúng tôi đã ăn no nê những món ăn quen thuộc của ngày Tết, và khi vừa ngồi thoải mái trên ghế sofa thì giọng bố vang lên, gọi cả nhà dậy để đi lễ đầu năm.</p><p id="20">“Không phải mọi năm mình hay đi buổi chiều sao? Cho bọn con nằm dài thêm chút nữa đi,” tôi đáp, mắt dán chặt vào màn hình TV trong khi nhắn tin cho bạn bè trên điện thoại.</p><p id="21">Pop ngồi cạnh tôi, xem chương trình hài trên TV và thỉnh thoảng lại cười. Chúng tôi đã hoàn thành những việc nhà được giao trong ngày, và điều này không có gì lạ so với thói quen đón năm mới hàng năm của chúng tôi.</p><p id="22">“Mẹ rửa bát xong là đi ngay đấy, nên chuẩn bị đi nhé. Pop, con nhớ mặc ấm vào kẻo bị cảm lạnh,” mẹ gọi từ trong bếp.</p><p id="23">“Vâng,” Pop đáp khi đứng dậy. Tôi không còn lựa chọn nào khác ngoài việc đi theo em ấy. Nói thật, tại sao năm nay lại đi viếng đền sớm thế này? Nếu tôi không quá mải mê theo dõi buổi hòa nhạc đếm ngược của thần tượng trên TV, tôi đã cố gắng tranh luận và trì thêm một chút rồi.</p><p id="24">Bước vào phòng, tôi mở tủ quần áo và lấy chiếc áo khoác mới mà bố mẹ đã tặng tôi hôm Giáng sinh.</p><p id="25">Thật lạ khi nhận được một món quà thiết thực như thế này thay vì đồ chơi, và điều đó khiến tôi cảm thấy mình như một người lớn. Giá mà tôi có thể cư xử như một người lớn thì tốt biết mấy.</p><p id="26">~~~~~</p><p id="27">“Chúng ta đi đâu vậy? Đến ngôi đền nổi tiếng thờ Thần Trí Tuệ ạ?” Pop hỏi.</p><p id="28">Mới chỉ 9 giờ sáng, tôi đã khoác chiếc áo khoác mới, sẵn sàng cho chuyến đi dài đến ngôi đền mà bố tôi đã nhắc đến.</p><p id="29">“Không, chúng ta sẽ đến một ngôi đền gần đây. Chỉ mất mười lăm phút đi bộ thôi,” mẹ nói với chúng tôi.</p><p id="30">“Hả?! Thế không phải là đi cầu cho con thi đỗ sao?” Pop phụng phịu, rõ ràng là không hài lòng. </p><p id="31">“Lúc đầu bố cũng nghĩ vậy,” bố đáp khi chúng tôi tiếp tục đi. “Đúng vậy; chúng ta có thể đến ngôi đền xa xôi đó, nhưng chẳng phải việc tỏ lòng kính trọng với vị thần bảo hộ thị trấn của chúng ta, nơi Học viện Nữ sinh Karen tọa lạc, quan trọng hơn sao?”</p><p id="32">“Khu này ít khi mình đi qua, nhưng ngôi đền này đẹp lắm,” mẹ nói thêm.</p><p id="33">Đúng vậy; tôi hiếm khi đến khu vực này của thành phố. Những ngôi nhà và căn hộ xung quanh trông rất mới, và đường sá cũng rộng rãi. Thành phố Misora trước đây toàn là trang trại và đất hoang, nhưng khu vực này dường như mới được phát triển thành khu dân cư gần đây.</p><p id="34">“Sau này chắc khu này sẽ không còn nhiều đất trống nữa. Dù bên kia đường có công viên, nhưng ban ngày xe cộ khá đông, nên ngôi đền này trở thành nơi vui chơi của bọn trẻ sống quanh đây.”</p><p id="35">Chúng tôi đã đến đền thờ, và quan sát kỹ nơi này. Tòa nhà chính được bao quanh bởi những cây cao, nhưng vẫn mang lại cảm giác thoáng đãng, rộng rãi. Nơi đó thực sự là đẹp, với rất nhiều cây xanh xung quanh. Và mặc dù là ngày đầu năm mới, nhưng dường như không có nhiều người ở đấy.</p><p id="36">~~~~~</p><p id="37">“Ngôi đền này đã tồn tại hơn hai thế kỷ, từ thời Edo, trông coi thành phố Misora. Cũng giống như các con, hồi nhỏ bố không thực sự quan tâm đến đền chùa, chỉ tham gia các hoạt động mà không hiểu biết gì nhiều,” bố kể với chúng tôi.</p><p id="38">“Nơi này thực sự tuyệt vời để đi dạo vào mùa hè. Cây cối che bóng mát rất tốt,” mẹ tôi nói thêm.</p><p id="39">Có vẻ như bố mẹ đã đến ngôi đền này rất nhiều lần rồi. Tôi tự hỏi có phải vì họ đã đến độ tuổi bắt đầu cầu nguyện cho sức khỏe không. Hay là vì bố đang phải đối mặt với hội chứng rối loạn chuyển hóa?</p><p id="40">Theo gương cha mẹ, chúng tôi rửa tay và súc miệng ở suối nước bên ngoài khu đền thờ, rồi tiến đến bàn thờ. Chúng tôi bỏ vài đồng xu vào hòm trên bàn thờ, rồi xếp hàng để cầu nguyện. Đó là lần đầu tiên tôi cảm nhận được bầu không khí trang nghiêm đến vậy bao trùm lên nghi lễ thường nhật này.</p><p id="41">“Ồ, ở đây cũng có những tấm bảng ema nữa đấy. Pop, con đi viết một tấm đi.”</p><p id="42">Bức tường treo đầy những tấm bảng gỗ cầu nguyện của những người đến trước, phần lớn trông còn rất mới. Chúng tôi đi đến quầy gần cổng đền, nơi bày bán bùa hộ mệnh và ema. Mẹ mua một tấm rồi đưa cho Pop. </p><p id="43">Trong lúc tôi nhìn qua những tấm ema được trưng bày, Pop bắt đầu viết điều ước của mình.</p><p id="44">“Xin cho con thi đỗ vào Học viện Nữ sinh Karen.</p><p id="45">Harukaze Pop”</p><p id="46">Chữ viết của em ấy đã tiến bộ rất nhiều. Không còn là nét chữ trẻ con nữa, mà đã mang dáng dấp của một thiếu nữ chín chắn.</p><p id="47">Tôi chợt nhận ra rằng, đến tận bây giờ, tôi vẫn luôn xem em gái mình như một đứa trẻ. Tôi cũng nhớ lại cảm giác tức giận của bản thân hồi còn học cấp hai, khi bố mẹ đối xử với tôi giống hệt như cách họ đang đối xử với Pop — khi đó em ấy vẫn còn học tiểu học.</p><p id="48">Những tấm ema treo ở đây mang đủ loại điều ước khác nhau. Có tấm cầu tình duyên, có tấm cầu công danh, cũng có những điều ước mong sớm khỏi bệnh hay chấn thương. Tôi thầm hy vọng rằng tất cả những mong ước ấy đều sẽ trở thành hiện thực.</p><p id="49">Hay là tôi cũng nên viết một tấm, để cầu cho việc thi đỗ đại học của mình? Nhưng nghĩ lại, có lẽ tôi vẫn cần phải tự nỗ lực trước đã. Nếu không, đến cả các vị thần cũng chẳng thể giúp tôi được.</p><p id="50">——</p><p id="51">Công việc ở MAHO-do bắt đầu lại vào chiều mùng 2 tháng Giêng. Hazuki-chan, Ai-chan và tôi được giao nhiệm vụ chuẩn bị những túi quà may mắn cho ngày hôm sau, trong khi Momo-chan đi thử công thức làm bánh mới của cậu ấy.</p><p id="52">“Chúc mừng năm mới mọi người!” Tôi vui vẻ gọi to khi bước qua cửa.</p><p id="53">“Chúc mừng năm mới, Doremi-chan. Momo-chan và Ai-chan, năm nay cũng mong được các cậu giúp đỡ,” Hazuki-chan lịch sự đáp lại.</p><p id="54">“Chúc mừng năm mới! Món ăn đầu tiên của năm nay sẽ là bánh tart xoài và dâu tây!” Momo-chan hào hứng nói.</p><p id="55">“Chúc mừng năm mới. Cảm ơn Majorika và Lala đã chăm sóc bọn con trong năm qua,” Ai-chan gửi lời chúc.</p><p id="56">Chúng tôi chỉ xa nhau vài ngày, nhưng những lời chúc mừng năm mới này khiến tôi cảm thấy như thể đã lâu lắm rồi chúng tôi mới gặp nhau.</p><p id="57">“Onpu sẽ ghé qua vào tối mai,” Majorika nói khi bước vào phòng, Lala đi theo sau với một bộ ấm trà và đồ gói quà trên tay.</p><p id="58">“Vậy thì mình bắt đầu giờ uống trà trước nhé? Momo-chan đến sớm để chuẩn bị mấy thứ này đấy,” Lala nói, rồi bày lên bàn một chiếc giỏ đầy kẹo. Mỗi viên kẹo đều được gói riêng trong những túi nhỏ xíu.</p><p id="59">“Cái gì đây? Trông dễ thương quá,” Ai-chan nhận xét khi cầm một cái lên để xem xét kỹ hơn.</p><p id="60">“Ừm, cái này hình con thỏ à?” Tôi hỏi, khi nhìn một viên kẹo nhỏ bằng ngón tay cái mà tôi vừa nhặt lên. Chắc hẳn đây là đồ trang trí cho những chiếc bánh chúng ta sẽ bán ngày mai. Tôi nhặt thêm một viên nữa. “Cái này hình con chó à?”</p><p id="61">“Không phải! Đó là một con cáo đỏ!” Momo-chan sửa lại lời tôi.</p><p id="62">Những viên kẹo này thực sự phản ánh tính cách của Momo-chan.</p><p id="63">Sau khi uống trà xong, chúng tôi bắt tay vào làm bánh cho ngày mai.</p><p id="64">~~~~~</p><p id="65">Chuyện xảy ra vào ngày hôm sau.</p><p id="66">“Xin lỗi, tớ không nghĩ ra được món gì hay hơn.”</p><p id="67">“Đừng nói vậy. Cảm ơn cậu, Onpu-chan! Tớ tin là Pop sẽ rất vui,” tôi nói.</p><p id="68">Trong chuyến quay phim ngoại cảnh, Onpu-chan đã đến một ngôi đền gần đó để mua bùa hộ mệnh cho Pop.</p><p id="69">“Còn đây là quà của tớ,” Ai-chan nói khi lấy ra ba chiếc bút chì ngắn từ trong cặp. Mỗi chiếc đều có số được in gọn gàng ở bên cạnh.</p><p id="70">“Nhìn nè, mỗi mặt của thân bút có in các số 1, 2, 3 và 4. Mỗi con số còn được bao quanh bởi hình tương ứng nữa. Số 3 là hình tam giác, còn số 4 là hình vuông, thấy không? Mấy cây bút này sẽ rất hữu ích cho em ấy trong lúc thi,” Ai-chan giải thích.</p><p id="71">Đúng là Ai-chan. Cậu ấy luôn có những cách sáng tạo nhất để làm cho kỳ thi bớt căng thẳng.</p><p id="72">“Đây là quà của tớ cho Pop-chan,” Hazuki-chan nói rồi đưa cho tôi một chiếc hộp nhỏ. “Đó là huy hiệu của cấp hai Học viện Nữ sinh Karen. Tớ nghe nói nó là bùa may mắn, nên nhớ nói Pop-chan mang theo khi đi thi nhé.”</p><p id="73">Pop chắc chắn sẽ rất vui khi nhận được món quà như vậy từ Hazuki-chan, người có thể trở thành đàn chị của con bé tại Học viện Nữ sinh Karen.</p><p id="74">"Sau khi thi đậu, em ấy cũng sẽ có thể đeo nó," Ai-chan nhận xét.</p><p id="75">“Tớ cũng có quà nè—!” Momo-chan reo lên khi mang đến vài chiếc bánh tart mới nướng.</p><p id="76">Lần này, bánh tart chủ yếu được làm từ cốt bánh bông lan và kem trứng, với những lát dâu tây được xếp chồng lên nhau và phủ một lớp kem tươi, sao cho màu đỏ của trái cây hầu như không nhìn thấy được. Một mẻ khác thì thay dâu tây bằng một lát xoài dày. Giờ thì chúng ta chỉ cần trang trí thêm phần trên bằng những viên kẹo hình động vật nữa thôi.</p><p id="77">Chúng tôi trang trí bánh dâu bằng kẹo hình thỏ, còn bánh xoài thì dùng kẹo hình cáo đỏ. Khi mấy con thú rừng nhỏ xíu được đặt lên, những chiếc bánh trông như mang cả không khí mùa xuân vào vậy.</p><p id="78">Cuối cùng, dù chúng tôi đã nướng cả một mẻ bánh, nhưng tất cả bánh tart đều bán hết sạch vào buổi chiều.</p><p id="79">“Tớ phân vân không biết nên để lại cái nào cho Pop-chan, nên cuối cùng chọn bánh xoài vàng để chúc em ấy thi đỗ,” Momo-chan nói, rồi đưa cho tôi chiếc bánh đặc biệt mà cậu ấy đã để riêng. Chiếc bánh này được phủ đầy những lát xoài dày, nhìn thôi cũng đủ khiến người ta vui lên rồi. </p><p id="80">“Momo-chan, sao đằng kia lại có thêm một cái bánh tart nữa vậy?”</p><p id="81">Tôi để ý thấy một chiếc bánh dâu tây khác trên bàn bên cạnh và tò mò không hiểu sao nó lại không được bày bán.</p><p id="82">“À, Shinshuu-kun gọi cho tớ từ sáng, nhờ giữ lại cho cậu ấy. Chắc cậu ấy sắp đến lấy rồi,” Momo-chan giải thích, vừa cho bánh vào hộp vừa gói lại. Ngay đúng lúc Momo-chan vừa gói xong thì có tiếng gõ cửa vang lên. </p><p id="83">“Xin lỗi. Tớ không biết là các cậu đã đóng cửa,” Shinshuu-kun xin lỗi.</p><p id="84">“Không sao đâu, dù sao thì tớ cũng vừa mới gói xong bánh,” Momo-chan trấn an anh.</p><p id="85">Shinshuu-kun là bạn cùng lớp tiểu học của chúng tôi, và gia đình cậu ấy quản lý ngôi chùa trong thành phố. Tuy nhiên, mãi gần đây chúng tôi mới biết cậu ấy rất thích đồ ngọt.</p><p id="86">“À, Harukaze-san. Tớ cũng đang tìm cậu đấy,” Shinshuu-kun nói, rồi đưa cho tôi một chiếc túi giấy trắng. “Tớ nghe nói em gái cậu năm nay thi vào cấp hai, nên đây là bùa hộ mệnh của chùa nhà tớ.” </p><p id="87">“Cảm ơn,” tôi nói. Tôi tự hỏi Shinshuu-kun biết chuyện này bằng cách nào. Có lẽ tôi đã kể cho cậu ấy nghe lần trước khi chúng tôi gặp nhau. Hoặc có thể là vì cậu ấy sống trong một ngôi chùa, và tin tức sẽ dễ dàng đến tai cậu ấy với số lượng lớn tín đồ đến thăm nhà cậu ấy mỗi ngày.</p><p id="88">“Có lẽ em ấy đã có bùa từ đền rồi, nhưng bùa của chùa tôi cũng linh nghiệm lắm. Tuy vậy, không có bùa nào thay thế được nỗ lực và ý chí của bản thân đâu,” Shinshuu-kun nói với vẻ điềm tĩnh.</p><p id="89">~~~~~</p><p id="90">Chúng tôi đang trò chuyện vui vẻ thì chủ đề về việc đi viếng đền thờ vào dịp năm mới được nhắc đến. Tôi kể với mọi người rằng tôi chưa từng biết đến ngôi đền đó, dù nó chỉ cách nhà tôi mười lăm phút đi bộ.</p><p id="91">“Nơi đây có rất nhiều cây cối, nhưng vẫn khá sáng sủa và dễ chịu. Pop cũng đã viết ema ở đó nữa.”</p><p id="92">Tôi nghĩ đó là một chủ đề thú vị, vậy mà mọi người đều im lặng. Thậm chí, Ai-chan và Shinshuu-kun còn có vẻ mặt rất kỳ lạ.</p><p id="93">“C-có chuyện gì vậy? Có vấn đề gì à?” Tôi hỏi khi kéo Ai-chan. “Ai-chan, cậu có biết gì về nơi đó không? Nó là cái gì vậy? Có ma ám hay sao?”</p><p id="94">“Không sao đâu, Harukaze-san, không có gì phải lo cả,” Shinshuu-kun vội vàng trấn an tôi.</p><p id="95">“Nhưng bọn tớ đã cầu cho Pop ở đó rồi! Bố mẹ tớ còn nói đó là nơi rất tốt nữa! Không—” tôi bắt đầu hoảng loạn. </p><p id="96">“Shinshuu-kun đã bảo cậu đừng lo rồi mà,” Ai-chan đáp lại, vẻ mặt bối rối.</p><p id="97">Đúng lúc đó, Onpu-chan bước vào phá vỡ bầu không khí.</p><p id="98">“Đúng vậy, gần đây ở đó đã xảy ra chuyện gì đó, phải không? Shinshuu-kun, cậu có biết gì không?”</p><p id="99">Quả nhiên, Onpu-chan luôn là người điềm tĩnh và đáng tin cậy.</p><p id="100">“Ý cậu là mấy thứ gai nhọn đó à? Hay là cái nghi lễ thờ cúng trăm lần lễ bái?” Momo-chan chen vào.</p><p id="101">Momo-chan, cậu đang nói linh tinh cái gì vậy?</p><p id="102">“Thật ra tớ cũng nghe vài tin đồn. Nó không xa khuôn viên Học viện Nữ sinh Karen lắm, mấy người bạn của tớ đi ngang qua đó trong kỳ nghỉ đông có kể vài câu chuyện đáng sợ,” Hazuki-chan thì thầm, người run lên như một chú sóc con. </p><p id="103">“Nhưng thực ra chẳng có gì đáng sợ cả. Chỉ là một số người đã nghe thấy giọng nói của trẻ con ở đó thôi…”</p><p id="104">“Chẳng lẽ là án mạng? Ý tớ là hôm đó vắng lắm, dù là mùng Một Tết!”</p><p id="105">Aaa— Pop, mau chạy đi—</p><p id="106">“Bình tĩnh nào, Doremi-chan. Shinshuu-kun, kể cho chúng tớ nghe thêm đi,” Onpu-chan yêu cầu, và hoàn toàn phớt lờ sự hoảng loạn của tôi.</p><p id="107">“Thật ra, tớ đang định đến xem thử chỗ đó. Chúng ta cùng đi nhé?” Shinshuu-kun hỏi.</p><p id="108">Sau khi Shinshuu-kun mang bánh về nhà, cậu ấy đã hẹn gặp chúng tôi ở đền thờ. Vì hầu hết bánh trong cửa hàng đã bán hết, chúng tôi nhanh chóng dọn dẹp cửa hàng và chuẩn bị nguyên liệu cho ngày mai.</p><p id="109">Rồi tôi mang chiếc bánh tart dành cho Pop về nhà. Tôi chắc rằng nếu mẹ không bắt tôi hứa là đến tối, khi cả gia đình cùng ăn, tôi sẽ không được đụng vào chiếc bánh đó, thì vì lo lắng tôi đã ăn sạch nó.</p>

                    <p style="display: none">Hãy bình luận để ủng hộ người đăng nhé!</p>
                    
                    <!-- <div class="flex justify-center mt-10 mb-7 space-x-3">
                        <a
                            href="https://hako.vn/discord"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #7289da; text-decoration: initial; color: white !important;">
                            <svg
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                xmlns="http://www.w3.org/2000/svg"
                                fill-rule="evenodd"
                                clip-rule="evenodd"
                                viewbox="0 0 24 24">
                                <path
                                d="M19.54 0c1.356 0 2.46 1.104 2.46 2.472v21.528l-2.58-2.28-1.452-1.344-1.536-1.428.636 2.22h-13.608c-1.356 0-2.46-1.104-2.46-2.472v-16.224c0-1.368 1.104-2.472 2.46-2.472h16.08zm-4.632 15.672c2.652-.084 3.672-1.824 3.672-1.824 0-3.864-1.728-6.996-1.728-6.996-1.728-1.296-3.372-1.26-3.372-1.26l-.168.192c2.04.624 2.988 1.524 2.988 1.524-1.248-.684-2.472-1.02-3.612-1.152-.864-.096-1.692-.072-2.424.024l-.204.024c-.42.036-1.44.192-2.724.756-.444.204-.708.348-.708.348s.996-.948 3.156-1.572l-.12-.144s-1.644-.036-3.372 1.26c0 0-1.728 3.132-1.728 6.996 0 0 1.008 1.74 3.66 1.824 0 0 .444-.54.804-.996-1.524-.456-2.1-1.416-2.1-1.416l.336.204.048.036.047.027.014.006.047.027c.3.168.6.3.876.408.492.192 1.08.384 1.764.516.9.168 1.956.228 3.108.012.564-.096 1.14-.264 1.74-.516.42-.156.888-.384 1.38-.708 0 0-.6.984-2.172 1.428.36.456.792.972.792.972zm-5.58-5.604c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332.012-.732-.54-1.332-1.224-1.332zm4.38 0c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332 0-.732-.54-1.332-1.224-1.332z" />
                            </svg>
                            Discord
                        </a>
                        <a
                            href="https://fb.com/hako.page"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #1877f2; text-decoration: initial; color: white !important;">
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                viewBox="0 0 24 24">
                                <path
                                d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z" />
                            </svg>
                            Facebook
                        </a>
                    </div> -->

                                        <a href="/truyen/16221" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/16221/29902cc6-afcf-446e-8fff-62b938eb8f8d.jpg?t=1747982730" class="d-none d-md-block" style="width: 970px; height: auto">
                    </a>
                    <a href="/truyen/16221" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/16221/88df77ba-e124-4669-9aee-bf8635c395da.jpg?t=1747982730" class="d-md-none" style="width: 100%; height: auto">
                    </a>
                    
                                    </div>

                <div style="text-align: center; margin: 20px auto 10px auto;">
                                                        </div>
                
                <section class="rd-basic_icon row">
                    <a href="/truyen/24441-ojamajo-doremi-16-20/c289601-chuong-03-phep-mau-giang-sinh-phan-1" class="dark:text-black col text-center "><i class="fas fa-backward"></i></a>
                    <a href="/truyen/24441-ojamajo-doremi-16-20" class="dark:text-black col text-center"><i class="fas fa-home"></i></a>
                    <a href="/truyen/24441-ojamajo-doremi-16-20" class="dark:text-black col text-center  disabled "><i class="fas fa-forward"></i></a>
                </section>
                
                <!--the code style is important to keep this comment section be out of the effect of user reading's setting-->
            </div>
            <div class="col-12 col-lg-10 offset-lg-1" aria-hidden="true">
                <section id="chapter-comments" class="basic-section dark:bg-[#1f1f1f] dark:text-white dark:border dark:border-[#1f1f1f]">
                    <header class="sect-header tab-list dark:bg-[#2a2a2a] dark:border-[#2a2a2a]"> 
                        <span class="sect-title tab-title" data-tab-index="1">Bình luận <span class="comments-count">(0)</span></span>
                    </header>
                    <main id="fbcmt_root" class="sect-body">
                        <span style="padding: 10px; display: inline-block;">Báo cáo bình luận không phù hợp ở <a href="/thao-luan/619-bao-cao-binh-luan" style="color: blue">đây</a></span>
                        <div id="tab-content-1" class="tab-content clear">
                            <section class="ln-comment">
    <header>
        <h3 class="text-lg font-bold dark:text-white">0 Bình luận </h3>
        <!-- <i id="refresh_comment" class="fas fa-refresh" aria-hidden="true" style="margin-left: 10px; font-size: 18px"></i></h3> -->
            </header>

    <main class="ln-comment-body">
                    <div class="ln-comment_sign-in long-text">
                Bạn phải <a href="/login">đăng nhập</a> hoặc <a href="/register">tạo tài khoản</a> để bình luận.
            </div>
                
        
        
        <div class="ln-comment-page">
</div>    </main>

    <script>
        var token = 'xrsumIcJJy4biR01ndrzmdFJXPTZjPByPTOg925x';
        var comment_type = 'chapter';
        var comment_typeid = '289939';
    </script>

    </section>


                        </div>
                    </main>
                </section>
            </div> 
        </div>
    </div>
</main>

<script>
    token = 'xrsumIcJJy4biR01ndrzmdFJXPTZjPByPTOg925x';
        
    function turnoffall() {
        $(".rdtoggle").removeClass("on");
        $(".rdtoggle_body").removeClass("animation fade-in-left-big fade-in-down");
        $("html").removeClass("overflow-hiden");
    }
    
    function rdtoggle(classicon, effect) {
        if ($(classicon).hasClass("on")) {
            turnoffall();
        } else {
            turnoffall();
            $(classicon).addClass("on");
            $("html").addClass("overflow-hiden");
            $(classicon + " .rdtoggle_body").addClass("animation " + effect);
        } 
    };
    
    $("#rd-setting_icon").on('click', function() {
        rdtoggle("#setting", "fade-in-down");                   
    });

    $("#rd-tts_icon").on('click', function() {
        rdtoggle("#tts-panel", "fade-in-down");
    });
        
    $("#rd-info_icon").on('click', function() {
        rdtoggle("#chapters", "fade-in-left-big");              
    });
        
    $("#rd-bookmark_icon").on('click', function() {
        rdtoggle("#bookmarks", "fade-in-left-big");                     
    });
        
    $(".black-click").on('click', function() {
        turnoffall();
        $("#rd-side_icon").hide();
        $("#bookmark_top").removeClass("on");
    });
        
    var bgcolor    = Cookies.get('color') || (Cookies.get('night_mode') ? 6 : 4);
    var fontfamily = Cookies.get('fontfamily') || '';
    var fontsize   = Cookies.get('font') || 18; 
    var margin     = Cookies.get('margin') || 0;
    var textAlign  = Cookies.get('textAlign') || 'text-justify';
        
    function setcolor(alter = true) {
        var switcher = $(".set-color .set-input span").eq(bgcolor);
        switcher.addClass("current");

        if (alter) {
            for (var i = 0; i < $(".set-color .set-input span").length; i++) {
                $("#mainpart").removeClass('style-' + i);
                $("#mainpart").removeClass('dark');
            }
            $("#mainpart").addClass('style-' + bgcolor);

            // Manually hardcoded to dark
            if (bgcolor >= 6) {
                $("#mainpart").addClass('dark');
            }
        }
    }

    // This creates unsmooth experience so we only use it for select box
    function setfontfamily() {
        $('.set-font-family select option').filter(function () {
            return fontfamily.split(',')[0].indexOf($(this).text()) != -1 ;
        }).attr('selected', true);
    }
        
    function setfontstyle(alter = true) {
        $(".set-font input.set-slide_input").val(fontsize + "px"); 

        if (alter) {
            $("div#chapter-content").css("font-size", fontsize + "px");

            var lineheight = +fontsize + 10;
            $("#chapter-content").css("line-height", lineheight + "px");
        }
    }
        
    function setmargin() {
        $(".set-margin input.set-slide_input").val(margin + "px"); 
        $("#chapter-content").css({
            'padding-left': margin + "px",
            'padding-right': margin + "px"
        });
    }

    function setTextAlign(alter = true) {
        var switcher = $(".set-text-align .set-input span[data-align='" + textAlign + "']");
        switcher.addClass("current");

        if (alter) {
            $(".set-text-align .set-input span").each(function () {
                $("#chapter-content").removeClass($(this).attr('data-align'));
            });

            $("#chapter-content").addClass(textAlign);
        }
    }
    
    setcolor(false);
    setfontfamily();
    setfontstyle(false);
    setmargin();
    setTextAlign(true);
    
    //1px = 0.0625rem;
    //16px = 1rem (default);
    
    $(".set-color .set-input span").click(function(){
        bgcolor = $(this).data("id");
        $(".set-color .set-input span").removeClass("current");
        setcolor();            
        Cookies.set('color', bgcolor, { expires: 365 });
    });

    $('.set-font-family select').on('change', function () {
        fontfamily = "'" + $('option:selected', this).text() + "', " + '\'Times New Roman\', Georgia, serif';
        
        $('div#chapter-content').css('font-family', fontfamily);

        Cookies.set('fontfamily', fontfamily, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-smaller").click(function () {
        fontsize = fontsize - 2;
        if (fontsize < 0) fontsize = 0;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-bigger").click(function () {
        fontsize = +fontsize + 2;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-smaller").click(function () {
        margin = margin - 20;
        if (margin < 0) margin = 0;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-bigger").click(function () {
        margin = +margin + 20;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    }); 

    $(".set-text-align .set-input span").click(function(){
        textAlign = $(this).data("align");
        $(".set-text-align .set-input span").removeClass("current");
        setTextAlign();        
        Cookies.set('textAlign', textAlign, { expires: 365 });
    });
        
    $("#bookmarks_list li").each(function(){
        var linepr = $(this).data("line");
        var preview = $(".reading-content p#" + linepr).text();

        var shortText = preview.trim().substring(0, 30) + "...";
        $(this).find(".pos_bookmark small").text(shortText);
    });

    $('div#chapter-content').html(
        $('div#chapter-content').html().replace(
            /\[note(\d+)\]/gi, 
            '<span id="anchor-note$1" class="note-icon none-print inline note-tooltip" data-tooltip-content="#note$1 .note-content" data-note-id="note$1"><i class="fas fa-sticky-note"></i></span><a id="anchor-note$1" class="inline-print none" href="#note$1">[note]</a>'
        )
    )
    
    tippy('.note-tooltip', {
        delay: 50,
        maxWidth: 240,
        interactive: true,
        content(ref) {
            const selector = ref.getAttribute('data-tooltip-content');
            const template = document.querySelector(selector);
            return template ? template.innerHTML : 'Đặt sai ID của note';
        }
    });
        
    isLoggedIn = 0;
    series_id = parseInt('24441');
    chapter_id = parseInt('289939');

    readingObject = {
        series_id: series_id,
        series_title: 'Ojamajo Doremi 16-20',
        series_url: $('i.fa-home').first().parent().attr('href'),
        series_cover: $('.rd_sidebar-header a.img').css('background-image'),
        chapter_title: $('ul.sub-chap_list li.current a').text().trim(),
        chapter_url: $('ul.sub-chap_list li.current a').attr('href'),
        book_title: $('ul#chap_list > li.current a').text(),
        book_url: $('ul#chap_list > li.current a').attr('href'),
        read_time: +new Date() / 1000 | 0,
    };

// TTS Manager - Enhanced Web Speech API (Vietnamese). Chunked queue for long texts, no delays/interrupts.
const synth = window.speechSynthesis;
let voices = [];
let voicesLoaded = false;
let ttsRate = parseFloat(localStorage.getItem('tts-rate')) || 1;
let ttsPitch = parseFloat(localStorage.getItem('tts-pitch')) || 1;
let ttsState = 'idle'; // idle, speaking, paused, loading
let currentChunk = 0;
let totalChunks = 0;
let processingIndex = 0;
let paragraphs = [];
const BUFFER_SIZE = 5;

// --- Background Persistence (Wake Lock + Silent Audio) ---
let wakeLock = null;
const silentAudio = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTSVNFAAAAPAAADEVuY29kZWQgd2l0aCBMYW1lMy4xMDBhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUA==');
silentAudio.loop = true;

async function enableConnection() {
    // 1. Start Silent Audio Loop (tricks browser into thinking we are a music player)
    try {
        await silentAudio.play();
    } catch (err) {
        console.warn('Silent Audio Play Failed (likely no interaction):', err);
    }

    // 2. Request Screen Wake Lock (prevents screen from sleeping automatically)
    if ('wakeLock' in navigator) {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (err) {
            console.warn('Wake Lock Request Failed:', err);
        }
    }
}

function disableConnection() {
    // 1. Stop Silent Audio
    try {
        silentAudio.pause();
        silentAudio.currentTime = 0;
    } catch (e) {}

    // 2. Release Wake Lock
    if (wakeLock) {
        try {
            wakeLock.release();
            wakeLock = null;
        } catch (e) {}
    }
}

// Re-acquire Wake Lock if visibility changes and we are speaking
document.addEventListener('visibilitychange', async () => {
    if (wakeLock !== null && document.visibilityState === 'visible' && ttsState === 'speaking') {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (e) {}
    }
});
// ---------------------------------------------------------

let ttsVoiceIdx = localStorage.getItem('tts-voice') || '0';

function populateVoices() {
    voices = synth.getVoices().filter(v => v.lang.startsWith('vi'));
    voicesLoaded = true;
    let $select = $('#tts-voice-select');
    $select.empty();

    if (voices.length === 0) {
        $select.append('<option value="-1">Không có giọng Việt (cài Chrome/Edge)</option>');
        return;
    }

    voices.forEach((voice, idx) => {
        $select.append(`<option value="${idx}">${voice.name} (${voice.lang}) ${voice.default ? '(mặc định)' : ''}</option>`);
    });

    let idx = Math.max(0, Math.min(parseInt(ttsVoiceIdx), voices.length - 1));
    $select.val(idx);
}

function updateTTSUI(progress = '') {
    let $icon = $('#rd-tts_icon i');
    $icon.removeClass('fa-volume-up fa-volume-mute fa-spinner fa-spin');
    let $playBtn = $('#tts-play-btn'), $pauseBtn = $('#tts-pause-btn'), $stopBtn = $('#tts-stop-btn');
    $playBtn.prop('disabled', ttsState === 'speaking' || ttsState === 'loading'); // Enable on idle/paused
    $pauseBtn.prop('disabled', ttsState === 'idle');
    $stopBtn.prop('disabled', ttsState === 'idle');
    // Always remove old progress
    $('#tts-progress').remove();

    if (progress && totalChunks > 0) {
        $playBtn.after(`<span id="tts-progress" class="text-xs block text-center mt-1">${progress}</span>`);
    }

    if (ttsState === 'idle') {
        // Check resume preview
        const resumeData = loadResumeState();
        let currentParagraphs = $('#chapter-content p').map(function() {
            return $(this).text().trim();
        }).get().filter(p => p.trim().length > 0);

        if (resumeData && resumeData.total === currentParagraphs.length) {
            $playBtn.text(`Tiếp tục (${resumeData.index + 1}/${resumeData.total})`);
        } else {
            $playBtn.text('Phát');
        }

        $icon.addClass('fa-volume-up');
    } else if (ttsState === 'speaking' || ttsState === 'loading') {
        $icon.addClass('fa-volume-up fa-spinner fa-spin');
    } else if (ttsState === 'paused') {
        $icon.addClass('fa-volume-mute');
    }
}

$('#tts-play-btn').off('click').on('click', function() {
    // Always restart/resume from storage
    enableConnection(); // Start keep-alive
    synth.cancel();
    ttsState = 'idle';
    // queuedUtterances = []; // Removed global queue
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();

    if (!voicesLoaded || voices.length === 0) {
        ttsState = 'loading';
        updateTTSUI();
        setTimeout(() => {
            if (!voicesLoaded) {
                alert('Giọng nói chưa tải. Thử lại.');
                ttsState = 'idle';
                updateTTSUI();
                return;
            }
            playTTS();
        }, 500);
        return;
    }

    playTTS();
});

function createUtterance(item) {
    let u = new SpeechSynthesisUtterance(item.text);
    u.lang = 'vi-VN';
    u.rate = parseFloat($('#tts-rate').val()) || 1;
    u.pitch = parseFloat($('#tts-pitch').val()) || 1;
    let voiceIdx = parseInt($('#tts-voice-select').val());

    if (voiceIdx >= 0 && voices[voiceIdx]) {
        u.voice = voices[voiceIdx];
    }

    u.onstart = () => {
        currentChunk++;
        saveResumeState();
        updateTTSUI(`${currentChunk}/${totalChunks}`);
        
        // Highlight logic
        $('.current-reading').removeClass('current-reading');
        if (item.el) {
            $(item.el).addClass('current-reading');
            item.el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        feedQueue(); // Ensure buffer is maintained
    };
    u.onerror = (event) => {
        console.error('TTS Error:', event.error, event);

        if (event.error !== 'interrupted') {
             // alert(`Lỗi TTS: ${event.error}. Bỏ qua đoạn.`);
             console.warn('TTS Error skipping chunk', event.error);
        }

        saveResumeState(); // Save on error
        feedQueue();
    };
    u.onend = () => {
        saveResumeState();

        if (currentChunk >= totalChunks) {
            clearResumeState();
            $('.current-reading').removeClass('current-reading'); // Cleanup
            
            // Auto-Next Logic
            let $nextBtn = $('.rd-basic_icon a').last();
            if ($nextBtn.length && !$nextBtn.hasClass('disabled')) {
                localStorage.setItem('tts-autoplay', 'true');
                window.location.href = $nextBtn.attr('href');
                return;
            }

            ttsState = 'idle';
            disableConnection(); // Cleanup
            currentChunk = 0;
            totalChunks = 0;
            processingIndex = 0;
            updateTTSUI();
        } else {
            feedQueue();
        }
    };
    u.onpause = () => { saveResumeState(); };
    return u;
}

function getStorageData() {
    try {
        return JSON.parse(localStorage.getItem('tts-resume-data')) || {};
    } catch {
        return {};
    }
}

function setStorageData(data) {
    localStorage.setItem('tts-resume-data', JSON.stringify(data));
}

function saveResumeState() {
    if (totalChunks > 0) {
        const data = getStorageData();
        data[chapter_id] = {
            index: currentChunk,
            total: totalChunks,
            timestamp: Date.now()
        };
        // Optional: Clean up old entries (older than 7 days?) to prevent infinite growth, 
        // but for now we just save.
        setStorageData(data);
    }
}

function clearResumeState() {
    const data = getStorageData();

    if (data[chapter_id]) {
        delete data[chapter_id];
        setStorageData(data);
    }
}

function loadResumeState() {
    const data = getStorageData();
    const saved = data[chapter_id];
    
    if (!saved) return null;
    
    if (Date.now() - saved.timestamp > 3600000 * 24 * 7) { // 7 days
        clearResumeState();
        return null;
    }

    return saved;
}

function initTTS() {
    populateVoices();
    $('#tts-rate').val(ttsRate);
    $('#tts-rate-value').text(ttsRate);
    $('#tts-pitch').val(ttsPitch);
    $('#tts-pitch-value').text(ttsPitch);
    updateTTSUI();
    
    if (localStorage.getItem('tts-autoplay') === 'true') {
        localStorage.removeItem('tts-autoplay');
        $(window).on('load', function() {
             setTimeout(() => {
                 $('#tts-play-btn').click(); 
             }, 500); 
        });
    }
}

function getParagraphs() {
    return $('#chapter-content p').map(function() {
        const text = $(this).text().trim();
        if (text.length > 0) {
            return { text: text, el: this };
        }
    }).get();
}

function feedQueue() {
    if (ttsState !== 'speaking') return;
    
    // Maintain buffer
    while (processingIndex < totalChunks && processingIndex < currentChunk + BUFFER_SIZE) {
        let u = createUtterance(paragraphs[processingIndex]);
        synth.speak(u);
        processingIndex++;
    }
}

function playTTS() {
    paragraphs = getParagraphs();
    if (paragraphs.length === 0) {
        alert('Không có nội dung để đọc.');
        ttsState = 'idle';
        disableConnection(); // Cleanup
        updateTTSUI();
        return;
    }
    
    const resumeData = loadResumeState();
    if (resumeData && resumeData.total === paragraphs.length) {
        currentChunk = resumeData.index;
        totalChunks = resumeData.total;
        // processingIndex needs to match what we are about to play
        // Current chunk is what finished, so we start processing from currentChunk?
        // Wait, currentChunk is "index of just finished" in some contexts?
        // No, in loadResume, index is currentChunk.
        // If saved index is 5. means 0..4 played.
        // We start playing from 5 (index).
        // So processingIndex = currentChunk.
        processingIndex = currentChunk;
    } else {
        clearResumeState();
        currentChunk = 0;
        totalChunks = paragraphs.length;
        processingIndex = 0;
    }
    
    synth.cancel();
    ttsState = 'speaking';
    
    feedQueue();
    updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
}

$('#tts-rate').on('input', function() {
    $('#tts-rate-value').text(this.value);
    localStorage.setItem('tts-rate', this.value);
});

$('#tts-pitch').on('input', function() {
    $('#tts-pitch-value').text(this.value);
    localStorage.setItem('tts-pitch', this.value);
});

$('#tts-voice-select').on('change', function() {
    localStorage.setItem('tts-voice', this.value);
});

$('#tts-pause-btn').off('click').on('click', function() {
    if (ttsState === 'speaking') {
        synth.pause();
        ttsState = 'paused';
        disableConnection(); // Pause keep-alive
        updateTTSUI();
        saveResumeState();
    } else if (ttsState === 'paused') {
        enableConnection(); // Resume keep-alive
        synth.resume();
        ttsState = 'speaking';
        updateTTSUI();
    }
});

$('#tts-stop-btn').off('click').on('click', function() {
    synth.cancel();
    // clearResumeState(); // Stop doesn't necessarily clear resume, usually just pause? 
    // But UI says "Stop". Let's clear resume state to consistent with old behavior 
    // or maybe optional? Old behavior cleared it.
    clearResumeState();
    
    disableConnection(); // Stop keep-alive
    $('.current-reading').removeClass('current-reading'); // Cleanup
    ttsState = 'idle';
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();
});

// Visibility handler removed - TTS continues on tab switch

synth.onvoiceschanged = populateVoices;
initTTS();
</script>



    
    <script src="/scripts/service-manager.js?r=4"></script>

    <script src="/scripts/app.js?id=a5a24eca66adcfc75cc0b2f62e2611db"></script>
    <script src="https://docln.net/vendor/livewire/livewire.min.js?id=df3a17f2"   data-csrf="xrsumIcJJy4biR01ndrzmdFJXPTZjPByPTOg925x" data-update-uri="/livewire/update" data-navigate-once="true"></script>

    
    <script src="https://confidecross.com/d5/6b/4b/d56b4bd6c3d2c1e161c4ab3c78c27670.js" async></script>

        
            <footer id="footer">
    <div class="container">
        <!--<span><a href="">Hako.re</a></span>-->
        <span class="right">Liên hệ: <a href="mailto:contact@hako.vn" target="_blank" style="color: #5fff46">contact@hako.vn</a></span>

        <span>© 2016 - 2026 Cổng Light Novel - Đọc Light Novel</span>
    </div>
</footer>    
    <div x-data x-show="$store.toast.on" @click="$store.toast.hide()" class="bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fixed w-3/4 md:w-1/2 z-20 inset-x-0 bottom-10 mx-auto" role="alert" style="display: none">
    <div class="flex">
        <div class="py-1"><svg class="fill-current h-6 w-6 text-teal-500 mr-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"/></svg></div>
        <div>
            <p class="font-bold capitalize">Chú ý</p>
            <p class="text-sm" x-text="$store.toast.message"></p>
        </div>
    </div>
</div></body>
</html>
