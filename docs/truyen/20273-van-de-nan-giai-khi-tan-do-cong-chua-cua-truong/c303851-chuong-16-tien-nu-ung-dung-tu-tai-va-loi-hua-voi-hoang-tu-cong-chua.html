<!DOCTYPE html>
<html lang="vi" class="light">
<head>
    <meta charset="utf-8">
    
    <title>Đọc Vấn Đề Nan Giải Khi Tán Đổ Công Chúa Của Trường - Chương 16 - Tiên nữ ung dung tự tại và lời hứa với Hoàng tử Công chúa - Cổng Light Novel - Đọc Light Novel</title>

    <meta name="description" content="Kanbara Yuuma đã từng từ bỏ tình yêu sau một mối tình đầu đắng cay trong quá khứ và thu mình vào thế giới riêng. Vào ngày cuối cùng của kỳ nghỉ hè năm hai cao trung khi đang mải mê xem livestream của thần tượng yêu thích thì em...">
    <meta name="theme-color" content="#000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="rI7UVEKGv1GOTO3rKV17fWSsmx7HMUV72Nv26T1t">
    <meta name="logged-in" content="0">
    <meta property="fb:app_id" content="1864643850436909">

    <link rel="canonical" href="https://docln.net/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303851-chuong-16-tien-nu-ung-dung-tu-tai-va-loi-hua-voi-hoang-tu-cong-chua">
    <meta property="og:image" content="https://i.hako.vn/ln/series/covers/s20273-037d0ae2-0b53-4b61-89eb-a78aa2954833.jpg">


<style type="text/css">@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/devanagari/wght/normal.woff2);unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek-ext/wght/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek/wght/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek/400/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek-ext/400/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}</style>
    <link rel="preload" href="/fonts/OpenSans-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/fonts/OpenSans-SemiBold.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preconnect" href="https://www.google-analytics.com">

    <link rel="shortcut icon" href="/img/favicon.png?v=3">
    <link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon.png?v=3">
    <link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png?v=3">
    <link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png?v=3">

    <link rel="stylesheet" href="/css/interface.css?id=300c3109a58d319c9bb94c8585835c77">
    <link rel="stylesheet" href="/css/tailwind.css?id=1778859ff87d0737e2b75c38e2919ee9">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css" integrity="sha256-BtbhCIbtfeVWGsqxk1vOHEYXS6qcvQvLMZqjtpWUEx8=" crossorigin="anonymous" />
            
    
    <script src="/scripts/plugins.js?id=b612d946b32459430eed3066ed15adf2"></script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-34864968-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
      gtag('config', 'UA-34864968-3');
    </script>
</head>

<body>
	
    <div x-data="{ open: Cookies.get('globalwarning2') === undefined ? true : false }">
    <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4" x-show="open" style="display: none">
        <div class="flex">
            <div class="shrink-0">
                <button x-on:click="open = false; Cookies.set('globalwarning2', false, { expires: 0.5 })" type="button" class="inline-flex rounded-md bg-yellow-50 p-1.5 text-yellow-500 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-600 focus:ring-offset-2 focus:ring-offset-yellow-50">
                    <span class="sr-only">Dismiss</span>
                    <svg class="size-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
                    <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z" />
                    </svg>
                </button>
            </div>
            <div class="ml-3 font-bold">
                <p class="text-sm text-yellow-700">
                Nếu không thể <a class="font-medium text-blue-700" href="/thao-luan/2898-ten-mien-da-bi-chan">truy cập trang web</a> xin vui lòng sử dụng DNS 
                <a class="font-medium text-blue-700" href="https://www.google.com/search?q=c%C3%A1ch+c%C3%A0i+dns+1.1.1.1" target="_blank">1.1.1.1</a> hoặc <a class="font-medium text-blue-700" href="https://docln.sbs" target="_blank">docln.sbs</a>
                
                </p>
                <p>
                    <p class="text-sm text-orange-700">Hiện đang đứt cáp Internet APG, kết nối có thể chậm hoặc rất chậm. Dùng VPN không chắc có hiệu quả.</p>
                </p>
            </div>

        </div>
    </div>
</div>



	<style>
    body {
        background: inherit;
    }

    #footer {
        display: none;
    }
    
    .current-reading {
        background-color: rgba(189, 224, 254, 0.3);
        border-left: 5px solid #007bff;
        padding-left: 10px;
        transition: background-color 0.3s ease;
    }
</style>


<main id="mainpart" class="reading-page style-4">
    <section id="rd-side_icon" class="none force-block-l" aria-hidden="true">
                <a class="rd_sd-button_item rd_top-left" href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303835-chuong-15-don-chi-mang"><i class="fas fa-backward"></i></a>
        
        <a class="rd_sd-button_item" href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong"><i class="fas fa-home"></i></a>     
        <a id="rd-setting_icon" data-affect="#" class="rd_sd-button_item"><i class="fas fa-font"></i></a>
        <a id="rd-tts_icon" class="rd_sd-button_item"><i class="fas fa-volume-up"></i></a>
        <a id="rd-info_icon" data-affect="#rd_sidebar.chapters" class="rd_sd-button_item"><i class="fas fa-info"></i></a>
        <a id="rd-bookmark_icon" data-affect="#rd_sidebar.bookmarks" class="rd_sd-button_item"><i class="fas fa-bookmark"></i></a>

        
         
        <a class="rd_sd-button_item rd_top-right disabled"><i class="fas fa-forward"></i></a>
            </section>    
    
    <section id="chapters" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <header class="rd_sidebar-header clear">
                <a class="img" href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303851-chuong-16-tien-nu-ung-dung-tu-tai-va-loi-hua-voi-hoang-tu-cong-chua" style="background: url('https://i.hako.vn/ln/series/covers/s20273-037d0ae2-0b53-4b61-89eb-a78aa2954833.jpg') no-repeat"></a> 
                <div class="rd_sidebar-name">                    
                    <h5><a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong">Vấn Đề Nan Giải Khi Tán Đ...</a></h5>
                    <small><i class="fas fa-pen"></i>Kawaisan</small>
                    <small><i class="fas fa-paint-brush"></i>Unasaka</small>                
                </div>
            </header>

            <ul id="chap_list" class="unstyled">
                                                            <li class=""><a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c153107-minh-hoa">Vol 1</a></li>
                                        
                                                            <li class="current"><a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/t28152-vol-2">Vol 2</a></li>
                        <ul class="sub-chap_list unstyled">
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c161820-minh-hoa">
                                                                            <i class="fas fa-picture-o" aria-hidden="true" title="Có chứa ảnh"></i>
                                                                        Minh họa
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303686-chuong-1-hop-chien-luoc">
                                                                        Chương 1 - Họp chiến lược
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303691-chuong-2-ban-thuo-nho-la-nu-chinh-thua-cuoc">
                                                                        Chương 2 - Bạn thuở nhỏ là nữ chính thua cuộc?
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303695-chuong-3-ban-thuo-nho-la-nu-chinh-thang-cuoc">
                                                                        Chương 3 - Bạn thuở nhỏ là nữ chính thắng cuộc?
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303707-chuong-4-tien-nu-u-sau-va-hoang-tu">
                                                                        Chương 4 - Tiên nữ u sầu và Hoàng tử
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303709-chuong-5-hoang-tu-phat-dien-va-tien-nu-cau-kinh">
                                                                        Chương 5 - Hoàng tử phát điên và Tiên nữ cáu kỉnh
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303716-ngoai-truyen-su-nghiem-tuc-cua-tien-nu">
                                                                            <i class="fas fa-picture-o" aria-hidden="true" title="Có chứa ảnh"></i>
                                                                        Ngoại truyện - Sự nghiêm túc của tiên nữ
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303720-chuong-6-cuoc-hop-chien-luoc-khan-cap">
                                                                        Chương 6 - Cuộc họp chiến lược khẩn cấp
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303722-chuong-7-dai-hoi-the-thao-phan-dau">
                                                                        Chương 7 - Đại hội thể thao (Phần đầu)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303729-chuong-8-dai-hoi-the-thao-phan-cuoi">
                                                                        Chương 8 - Đại hội thể thao (Phần cuối)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303731-chuong-9-de-xuat-cua-cong-chua">
                                                                            <i class="fas fa-picture-o" aria-hidden="true" title="Có chứa ảnh"></i>
                                                                        Chương 9 - Đề xuất của công chúa
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303735-chuong-10-su-sac-ben-cua-thanh-nu-va-loi-canh-cao-tu-nu-hoang">
                                                                        Chương 10 - Sự sắc bén của thánh nữ và lời cảnh cáo từ nữ hoàng
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303787-chuong-11-nu-than-luon-tuoi-cuoi-va-hoang-tu-cong-chua-lai-to-ra-ky-la">
                                                                        Chương 11 - Nữ thần luôn tươi cười và Hoàng tử Công chúa lại tỏ ra kỳ lạ
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303795-ngoai-truyen-hoang-tu-cong-chua-dan-mat-kien-nhan">
                                                                        Ngoại truyện - Hoàng tử Công chúa dần mất kiên nhẫn
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303800-chuong-12-buoi-hen-ho-doi-phan-dau">
                                                                            <i class="fas fa-picture-o" aria-hidden="true" title="Có chứa ảnh"></i>
                                                                        Chương 12 - Buổi hẹn hò đôi (Phần đầu)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303803-chuong-13-buoi-hen-ho-doi-phan-cuoi">
                                                                        Chương 13 - Buổi hẹn hò đôi (Phần cuối)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303808-ngoai-truyen-quyet-dinh-cua-nu-than">
                                                                        Ngoại truyện - Quyết định của Nữ thần
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303825-chuong-14-thanh-nu-va-buoi-hen-ho">
                                                                        Chương 14 - Thánh nữ và buổi hẹn hò
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303835-chuong-15-don-chi-mang">
                                                                            <i class="fas fa-picture-o" aria-hidden="true" title="Có chứa ảnh"></i>
                                                                        Chương 15 - Đòn chí mạng
                                </a>
                            </li>
                                                        <li  class="current" >
                                <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303851-chuong-16-tien-nu-ung-dung-tu-tai-va-loi-hua-voi-hoang-tu-cong-chua">
                                                                        Chương 16 - Tiên nữ ung dung tự tại và lời hứa với Hoàng tử Công chúa
                                </a>
                            </li>
                                                    </ul>
                                        
                                        
            </ul>
        </main>
        <div class="black-click"></div>
    </section>
    
    <section id="bookmarks" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <div class="rd_sidebar-header">
                <h2 class="rd_s-name"><i class="fas fa-bookmark"></i><a href="/bookmark" style="color: white;"> Bookmarks</a></h2>
            </div>
            <ul id="bookmarks_list" class="unstyled">
                                            <li>Bạn phải đăng nhập để sử dụng bookmark</li>
                                        </ul>
        </main>
        <div class="black-click"></div>
    </section>

    <section id="setting" class="rdtoggle" aria-hidden="true">
        <section class="re_set-in basic-section clear rdtoggle_body">
        <header class="sect-header"><span class="sect-title">Tùy chỉnh</span></header>
            <main class="sect-body">
                <div class="set-list set-color clear">
                    <label class="font-bold">Màu nền</label>
                    <div class="set-input clear justify-center">
                        <span data-color="#ffffff" data-id="0" style="background-color: #ffffff"></span>
                        <span data-color="#e6f0e6" data-id="1" style="background-color: #e6f0e6"></span>
                        <span data-color="#e3f5fa" data-id="2" style="background-color: #e3f5fa"></span>
                        <span data-color="#f6f4ec" data-id="3" style="background-color: #f6f4ec"></span>
                        <span data-color="#eae4d3" data-id="4" style="background-color: #eae4d3"></span>
                        <span data-color="#f5e9ef" data-id="5" style="background-color: #f5e9ef"></span>
                        <span data-color="#222222" data-id="6" style="background-color: #222222"></span>
                        <span data-color="#000000" data-id="7" style="background-color: #000000"></span>
                    </div>
                </div>
                <div class="set-list set-font-family clear">
                    <label class="font-bold">Font chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <select>
                            <option>Times New Roman</option>
                            <option>Merriweather</option>
                            <option>Lora</option>
                            <option>Roboto</option>
                            <option>Noto Sans</option>
                            <option>Nunito</option>
                        </select>
                    </div>
                </div>
                <div class="set-list set-font clear">
                    <label class="font-bold">Kích cỡ chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="16px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-margin clear">
                    <label class="font-bold">Bản lề</label>
                    <div class="set-slide set-input justify-center">
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="20px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-text-align clear">
                    <label class="font-bold">Kiểu căn chỉnh</label>
                    <div class="set-input clear justify-center font-medium text-2xl flex flex-row gap-10">
                        <span data-align="text-left" class="p-1"><i class="fas fa-align-left"></i></span>
                        <span data-align="text-center" class="p-1"><i class="fas fa-align-center"></i></span>
                        <span data-align="text-right" class="p-1"><i class="fas fa-align-right"></i></span>
                        <span data-align="text-justify" class="p-1"><i class="fas fa-align-justify"></i></span>
                    </div>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>

    <section id="tts-panel" class="rdtoggle" aria-hidden="true">
        <section class="tts-settings basic-section clear rdtoggle_body">
            <header class="sect-header"><span class="sect-title">Text-to-Speech</span></header>
            <main class="sect-body">
                <div class="set-list clear" style="color: red; font-size: 14px; margin-bottom: 20px">
                    Đây là chức năng đang thử nghiệm, chi tiết xem tại <a href="/thao-luan/3305-chuc-nang-doc" style="color: blue">Link</a>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Giọng đọc</label>
                    <select id="tts-voice-select" class="w-full p-2 border rounded bg-white dark:bg-gray-800 text-sm dark:border-gray-600"></select>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Tốc độ</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-rate" min="0.1" max="3" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-rate-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Độ cao (Pitch)</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-pitch" min="0" max="2" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-pitch-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="flex gap-2 pt-4">
                    <button id="tts-play-btn" class="flex-1 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Phát</button>
                    <button id="tts-pause-btn" class="flex-1 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Tạm dừng</button>
                    <button id="tts-stop-btn" class="flex-1 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Dừng</button>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>
    
    <div class="container">
        <div class="row">
            <div class="reading-content col-12 col-lg-10 offset-lg-1" style="word-wrap: break-word;">
                <div id="bookmark_top" class="block d-lg-none"><i class="fas fa-bookmark"></i></div>
                <span class="save_bookmark" style="position: absolute; top: 9999px; display: none"><i class="fas fa-bookmark"></i></span>
                
                
                
                <div class="title-top" style="padding-top: 20px">
                    <h2 class="title-item text-xl font-bold" align="center">Vol 2</h2>
                    <h4 class="title-item text-base font-bold" align="center">Chương 16 - Tiên nữ ung dung tự tại và lời hứa với Hoàng tử Công chúa</h4>
                    <h6 class="title-item font-bold" align="center" aria-hidden="true">
                        <a href="https://docln.net/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303851-chuong-16-tien-nu-ung-dung-tu-tai-va-loi-hua-voi-hoang-tu-cong-chua#chapter-comments" style="text-decoration: underline">1 Bình luận</a> -
                        Độ dài: 1,854 từ - Cập nhật: 
                        <time class="topic-time timeago" title="04-02-2026 19:28:07" datetime="2026-02-04T19:28:07+07:00"></time>                    </h6>
                </div>

                <div style="text-align: center; margin: 20px auto -20px auto;">
                                                        </div>

                <div class="pt-6 mb-6 mx-auto max-w-4xl" x-data="{ open: Cookies.get('affiliation_popup_closed2') === undefined }" x-cloak>
                    <div id="affiliation-popup" x-show="open" style="display: none" class="bg-slate-900 rounded-xl overflow-hidden shadow-lg border !border-slate-800">
                        <div class="p-4 flex flex-col md:flex-row items-center gap-4">
                            <button x-on:click="open = false; Cookies.set('affiliation_popup_closed2', 'true', { expires: 0.5 })" class="text-gray-400 hover:text-white transition-colors p-2" aria-label="Close">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                            
                            <div class="flex-shrink-0">
                                <img src="https://i2.hako.vip/vault/992471336465223711.webp" alt="Pepe" class="w-16 h-16 rounded-md object-cover">
                            </div>

                            <div class="flex-grow text-center md:text-left">
                                <p class="text-white text-sm md:text-base font-medium">
                                    Click vào link khi MUA <span class="text-orange-500 font-bold uppercase">BẤT KỲ THỨ GÌ</span> trên <span class="text-orange-500 font-bold">Shopee</span> để hỗ trợ HAKO. Có thể được tặng mã Free ship khi mua.
                                </p>
                            </div>

                            <div class="flex flex-col sm:flex-row gap-3 w-full md:w-auto flex-shrink-0">
                                <a href="https://s.shopee.vn/4q9eci0DM3" target="_blank" class="flex-1 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white font-bold py-2 px-6 rounded shadow-md transition-all text-center whitespace-nowrap" rel="noopener noreferrer">
                                    Shopee
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="chapter-content" class="long-text no-select text-justify">
                    <p style="display: none">Chương 16 - Tiên nữ ung dung tự tại và lời hứa với Hoàng tử Công chúa</p>
                    <p id="1">Giờ thì… tôi phải làm sao đây.</p><p id="2">Về đến nhà, tôi ngồi trong phòng mình mà bứt rứt không yên.</p><p id="3">Sau khi chạm mặt Kazama, buổi hẹn hò vẫn tiếp tục, nhưng rõ ràng là Tsukihi có gì đó rất lạ. Trông như thể tâm trí cô ấy không ở đây. Bề ngoài thì vẫn cố tỏ ra vui vẻ, nhưng tôi nhìn là biết ngay đó chỉ là diễn.</p><p id="4">Nhưng hơn cả Tsukihi, chính tôi mới là người đánh mất sự bình tĩnh.</p><p id="5">Lần đầu tiên trong đời tôi được tỏ tình.</p><p id="6">Chỉ riêng điều đó thôi cũng đủ khiến tôi rối loạn hết mức, vậy mà đối phương lại còn là một mỹ nữ thuộc hàng top. Kazama nói rằng chỉ cần tôi để ý đến cô ấy là được, nhưng sau lời tỏ tình đó, trong đầu tôi chỉ toàn là Kazama.</p><p id="7">Tự nói ra thì hơi ngượng, nhưng tôi là kiểu người rất dễ đổ. Thời cấp hai chỉ cần được đối xử tử tế một chút là đã thích rồi. Đến bây giờ, bản chất đó vẫn không thay đổi. Ngay cả khi đang hẹn hò, trong đầu tôi cũng đã bị hình bóng của Kazama nhuộm kín.</p><p id="8">Kết quả là tôi chỉ đi mua sắm theo đúng kế hoạch với Tsukihi rồi chia tay. Không có tiến triển gì đặc biệt.</p><p id="9">Trong trạng thái lơ lửng đó, tôi về nhà, đứng đờ ra một lúc. Đến khi hoàn hồn, tôi liền sang phòng Ayane định phàn nàn cho ra lẽ.</p><p id="10">Nhưng con nhỏ đó nhất quyết không chịu ra khỏi phòng.</p><p id="11">Tôi vừa định xông vào thì nó gọi bố mẹ cầu cứu, nên tôi đành ngậm bồ hòn quay về phòng mình. Và thế là dẫn đến tình trạng hiện tại.</p><p id="12">「…Chắc chắn là có giao dịch ngầm rồi」</p><p id="13">Chuyện đó thì tôi biết.</p><p id="14">Nhưng việc nó nói cả chuyện “chinh phục công chúa” ra thì đúng là quá bất ngờ. Bị lộ chuyện đó thì đối với Ayane cũng là cực kỳ bất lợi mới đúng. Vậy mà tại sao nó lại nói ra chứ?</p><p id="15">Không hiểu được ý đồ.</p><p id="16">Tôi nghĩ về cô em gái ngu ngốc đó vài phút rồi bỏ cuộc. Lãng phí thời gian. Tư duy của nó tôi không tài nào đoán nổi. Quan trọng hơn là chuyện trước mắt.</p><p id="17">「Là thật sao…?」</p><p id="18">Lời tỏ tình của Kazama… có phải là thật không?</p><p id="19">Đến giờ tôi vẫn còn chút nghi ngờ, liệu đó có phải chỉ là phần kéo dài của trò chơi “làm người khác yêu mình” hay không. Thậm chí tôi còn nghĩ đến khả năng là trò chơi khăm.</p><p id="20">Nhưng nếu chỉ là trò đó thì tự mình đi tỏ tình chẳng có ý nghĩa gì. Không hợp lý.</p><p id="21">Hơn nữa, tỏ tình giả cũng chẳng có lợi gì cho cô ấy. Dù có bị tổn thương lòng tự trọng đi nữa, Kazama cũng không ngu đến mức đó. Chưa kể, cô ấy biết tôi đang làm chuyện hèn hạ gọi là “chinh phục công chúa”. Nếu chỉ là trả thù chuyện cũ thì vạch trần hết là xong rồi.</p><p id="22">...Nếu nghĩ vậy thì, chuyện cô ấy thích tôi là thật sao.</p><p id="23">Như vậy, cái trò “chinh phục công chúa” này đã kết thúc. Chính xác hơn thì, nó đã trở thành thứ có thể kết thúc bất cứ lúc nào.</p><p id="24">Lẽ ra tôi phải vui mới đúng, nhưng lại không hề.</p><p id="25">Những lời Kazama nói vẫn văng vẳng trong đầu tôi.</p><p id="26">『Dù nói là để tự vệ thì cũng tàn nhẫn quá. Hình như có người đã nghiêm túc thật rồi đấy, cậu đúng là tạo nghiệp cho bản thân mà. Cậu có từng nghĩ nếu lỡ dụ được nhiều người thì sẽ thế nào không?』</p><p id="27">Cô ấy nói đúng.</p><p id="28">Dù việc “chinh phục công chúa” có kết thúc, thì cuộc sống của tôi đâu có kết thúc theo nó.</p><p id="29">Tôi đã không nghĩ đến điều đó. Bao lần tôi cố nghĩ tới khả năng ấy, rồi lại trốn tránh. Luôn tự nhủ “rồi sẽ có cách” và kéo dài sang sau.</p><p id="30">Sau khi chinh phục công chúa, thứ chờ đợi tôi không phải là cuộc sống hikikomori như trước.</p><p id="31">Nếu thất bại, sẽ là địa ngục. Những bài donate dài dòng đáng xấu hổ sẽ bị phơi bày, bị cười nhạo một cuộc sống địa ngục. Ngày ngày vang lên những tiếng cười khúc khích sau lưng.</p><p id="32">Nếu thành công, sẽ là cuộc sống cùng công chúa mà tôi đã tán tỉnh thành công. Cụ thể thì là nắm tay đi dạo, cùng ăn trưa, chạm vào cơ thể của nhau… kiểu kiểu như vậy.</p><p id="33">Rõ ràng là chuyện hiển nhiên, vậy mà cho đến giờ tôi chưa từng nghĩ đến “sau đó”.</p><p id="34">Nhờ những lời Kazama ném thẳng vào mặt, cuối cùng tôi mới chịu đối diện với nó.</p><p id="35">Đúng là tệ hại thật.</p><p id="36">Sau đó, tôi cứ thế bứt rứt trong phòng suốt. Đến khi nhận ra thì đã sang ngày mới, và cuối cùng tôi chỉ ngủ được khi trời gần sáng.</p><p id="37">「Chào buổi sáng, Kanbara-kun」</p><p id="38">Ngày hôm sau, vừa đến trường thì Kazama đã mở lời với tôi.</p><p id="39">Tôi lại một lần nữa nhìn thẳng vào gương mặt cô ấy.</p><p id="40">Đường nét khuôn mặt cân đối, nụ cười hé lộ chiếc răng khểnh thoáng thấy điểm cuốn hút đặc trưng. Mái tóc xoăn nhẹ bồng bềnh mang cảm giác “yuru-fuwa” càng làm tăng ấn tượng như một tiên nữ.</p><p id="41">Một cô gái ở đẳng cấp này… lại thích tôi sao?</p><p id="42">「Ch-chào buổi sáng!」</p><p id="43">Vì quá cuống nên giọng tôi bị vỡ.</p><p id="44">Thấy tôi rõ ràng đang hoảng loạn, Kazama khúc khích cười. Đúng là thảm hại thật.</p><p id="45">「Tớ mong đến lễ hội văn hoá ghê đó」</p><p id="46">「Hả」</p><p id="47">Câu nói mang ý trêu chọc ấy khiến tim tôi đập thót lên.</p><p id="48">Lễ hội văn hoá của học viện Himegasaki được tổ chức vào tháng 11 hằng năm. Năm nay dự kiến diễn ra vào cuối tuần giữa tháng.</p><p id="49">Không sao, vẫn còn thời gian.</p><p id="50">「Nhìn biểu cảm của cậu như vậy là tớ đã lọt vào tầm ngắm của cậu rồi nhỉ」</p><p id="51">「…Không hẳn là trọn vẹn. Nhưng nhờ cậu mà tớ thiếu ngủ luôn」</p><p id="52">「Vậy là tốt rồi. Nếu cậu vẫn không để ý tới tớ thì chắc tớ sẽ sốc vì thấy mình không có sức hút mà nằm ăn vạ ở đây mất」</p><p id="53">Không biết cô ấy nói nghiêm túc tới mức nào.</p><p id="54">Chẳng đời nào mà cô ấy không có sức hút cả. Nhiều bạn bè, giao tiếp tốt, đáng yêu hoàn toàn đối lập với tôi.</p><p id="55">Rất nhiều thằng con trai bị Kazama mê hoặc, rất nhiều cô gái muốn có mối quan hệ với cô ấy. Nhìn kiểu gì cũng là một khối “hấp dẫn” di động.</p><p id="56">「Tớ sẽ cố gắng hết sức để chinh phục cậu trước lễ hội văn hoá nhé」</p><p id="57">Giới hạn là lễ hội văn hoá.</p><p id="58">Lý do Kazama chọn mốc này thì quá rõ ràng.</p><p id="59">Sau lễ hội văn hoá là sự kiện được mong đợi nhất là Tổng tuyển cử Himegasaki. Dù nói là sự kiện thì thực chất đây là hoạt động không chính thức.</p><p id="60">Việc bỏ phiếu bắt đầu từ ngày hôm sau của lễ hội văn hoá, rồi sau kỳ thi cuối kỳ, ban báo chí sẽ công bố kết quả.</p><p id="61">Việc lấy lễ hội làm hạn chót chắc là đề xuất của Ayane người có liên kết với Kazama. Quả thật, nếu không phân định trắng đen tầm lễ hội thì sau đó sẽ rất khó xử.</p><p id="62">“Sau đó” ở đây là việc tung tin.</p><p id="63">Công khai chuyện hẹn hò khắp nơi, chủ động hạ thấp danh tiếng. Chỉ khi làm được điều đó thì Ayane mới có thể lên ngôi “công chúa”.</p><p id="64">「Thế rốt cuộc cậu đã nói chuyện với Ayane như thế nào vậy?」</p><p id="65">Khi tôi hỏi, Kazama nghiêng đầu.</p><p id="66">「Cậu chưa nghe trực tiếp từ em ấy à?」</p><p id="67">「Tối qua tớ bị lơ luôn」</p><p id="68">「Vậy thì tiếc thật nhỉ」</p><p id="69">「Cậu không thể kể cho tớ nghe sao?」</p><p id="70">「Tớ chỉ nói chuyện một cách rất chân thành thôi」</p><p id="71">“Chân thành” á? Con nhỏ em gái xấu tính đó mà chỉ cần vậy là tiết lộ cả chuyện “chinh phục công chúa” sao? Không đời nào. Chắc chắn là có gì đó.</p><p id="72">Trong lúc tôi còn đang suy nghĩ thì cùng với tiếng bước chân, một người nào đó bước vào lớp.</p><p id="73">「Chào buổi sáng, Kanbara-kun」</p><p id="74">Là Shiranui.</p><p id="75">「…Chào buổi sáng」</p><p id="76">「Vào thẳng vấn đề luôn nhé, buổi hẹn hò của cậu với Tsukihi thế nào?」</p><p id="77">Lại nữa à. Có cần quan tâm tới nội dung buổi hẹn hò đến vậy không? Chuyện này đâu liên quan gì tới cô ấy đâu chứ.</p><p id="78">「Xin lỗi, nhưng tớ không nhớ rõ lắm」</p><p id="79">「Không nhớ rõ? Ý cậu là sao?」</p><p id="80">Vì lời tỏ tình quá sốc nên ký ức về buổi hẹn hò đã trở nên mờ nhạt.</p><p id="81">Nhắc đến tỏ tình… không biết Yamada thì sao rồi nhỉ?</p><p id="82">Tôi liếc nhìn về phía chỗ của Yamada, nhưng cậu ta vẫn chưa đến lớp. Bình thường đến sớm lắm, lạ thật.</p><p id="83">「Fufufu, tức là tình hình đã thay đổi rồi đó, Shiranui-san」</p><p id="84">Lúc này, Kazama đã xen vào.</p><p id="85">「…Yukina?」</p><p id="86">「Bây giờ trong đầu Kanbara-kun chỉ toàn là tớ thôi mà. Như thế thì cũng đành chịu thôi」</p><p id="87">「Ý cậu là sao?」</p><p id="88">Kazama đáp lại với nụ cười đầy thỏa mãn.</p><p id="89">「Vì tớ đã tỏ tình rồi đó」</p><p id="90">「Cái gì…」</p><p id="91">Shiranui rõ ràng hoảng hốt.</p><p id="92">「Ể, tỏ tình… ý là tỏ tình thật sao?」</p><p id="93">「Ừ đúng rồi đó. Thích thì phải tỏ tình chứ」</p><p id="94">「…」</p><p id="95">「Không nói ra cảm xúc thì đâu thể trở thành người yêu của nhau. Tớ chỉ thẳng thắn truyền đạt cảm xúc của mình thôi. Có gì lạ sao?」</p><p id="96">Cô ấy nói nhẹ tênh thật.</p><p id="97">Xét cho cùng thì cũng rất bình thường. Vì thích nên tỏ tình. Chẳng cần lý luận gì cả chỉ làm điều hiển nhiên mà thôi.</p><p id="98">Nhưng người nghe sát bên như tôi thì lại thấy hơi ngượng.</p><p id="99">「V-vậy… câu trả lời của Kanbara-kun thì sao?」</p><p id="100">「Giờ thì tớ vẫn đang chờ câu trả lời. Tớ định nghe nó vào lễ hội văn hoá đó」</p><p id="101">「Lễ hội văn hoá?」</p><p id="102">「Ừm. Bảo chọn ngay thì khó quá đúng không. Với lại nếu giữ nguyên trạng thái hôm qua thì tớ thấy mình chẳng có cửa thắng đâu」</p><p id="103">Shiranui đang hoảng loạn trước diễn biến bất ngờ, nhưng rồi hít một hơi thật sâu để lấy lại bình tĩnh.</p><p id="104">「Thật ngoài dự đoán. Người nổ phát súng đầu tiên lại là Yukina sao. Thế thì tớ cũng không thể chần chừ được nữa. Được rồi, tớ quyết tâm rồi」</p><p id="105">Nói xong, Shiranui quay sang phía tôi.</p><p id="106">「Kanbara-kun, buổi livestream của Fushicho Feni hôm nay cậu nhất định phải xem trực tiếp nhé」</p><p id="107">「Ơ, à, ừm」</p><p id="108">「Hứa đó. Vậy nhé」</p><p id="109">Nói xong câu đó, Shiranui bước nhanh về chỗ ngồi của mình.</p><p id="110">…Khoan đã, hôm nay làm gì có lịch livestream nhỉ?</p>

                    <p style="display: none">Hãy bình luận để ủng hộ người đăng nhé!</p>
                    
                    <!-- <div class="flex justify-center mt-10 mb-7 space-x-3">
                        <a
                            href="https://hako.vn/discord"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #7289da; text-decoration: initial; color: white !important;">
                            <svg
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                xmlns="http://www.w3.org/2000/svg"
                                fill-rule="evenodd"
                                clip-rule="evenodd"
                                viewbox="0 0 24 24">
                                <path
                                d="M19.54 0c1.356 0 2.46 1.104 2.46 2.472v21.528l-2.58-2.28-1.452-1.344-1.536-1.428.636 2.22h-13.608c-1.356 0-2.46-1.104-2.46-2.472v-16.224c0-1.368 1.104-2.472 2.46-2.472h16.08zm-4.632 15.672c2.652-.084 3.672-1.824 3.672-1.824 0-3.864-1.728-6.996-1.728-6.996-1.728-1.296-3.372-1.26-3.372-1.26l-.168.192c2.04.624 2.988 1.524 2.988 1.524-1.248-.684-2.472-1.02-3.612-1.152-.864-.096-1.692-.072-2.424.024l-.204.024c-.42.036-1.44.192-2.724.756-.444.204-.708.348-.708.348s.996-.948 3.156-1.572l-.12-.144s-1.644-.036-3.372 1.26c0 0-1.728 3.132-1.728 6.996 0 0 1.008 1.74 3.66 1.824 0 0 .444-.54.804-.996-1.524-.456-2.1-1.416-2.1-1.416l.336.204.048.036.047.027.014.006.047.027c.3.168.6.3.876.408.492.192 1.08.384 1.764.516.9.168 1.956.228 3.108.012.564-.096 1.14-.264 1.74-.516.42-.156.888-.384 1.38-.708 0 0-.6.984-2.172 1.428.36.456.792.972.792.972zm-5.58-5.604c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332.012-.732-.54-1.332-1.224-1.332zm4.38 0c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332 0-.732-.54-1.332-1.224-1.332z" />
                            </svg>
                            Discord
                        </a>
                        <a
                            href="https://fb.com/hako.page"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #1877f2; text-decoration: initial; color: white !important;">
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                viewBox="0 0 24 24">
                                <path
                                d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z" />
                            </svg>
                            Facebook
                        </a>
                    </div> -->

                                        <a href="/truyen/8476" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/8476/3269685b-c0ef-4013-a7d6-74104f39a24c.jpg?t=1739894654" class="d-none d-md-block" style="width: 970px; height: auto">
                    </a>
                    <a href="/truyen/8476" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/8476/bf1184be-cf52-429e-8acb-0d29fb4eea33.jpg?t=1739894654" class="d-md-none" style="width: 100%; height: auto">
                    </a>
                    
                                    </div>

                <div style="text-align: center; margin: 20px auto 10px auto;">
                                                        </div>
                
                <section class="rd-basic_icon row">
                    <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303835-chuong-15-don-chi-mang" class="dark:text-black col text-center "><i class="fas fa-backward"></i></a>
                    <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong" class="dark:text-black col text-center"><i class="fas fa-home"></i></a>
                    <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong" class="dark:text-black col text-center  disabled "><i class="fas fa-forward"></i></a>
                </section>
                
                <!--the code style is important to keep this comment section be out of the effect of user reading's setting-->
            </div>
            <div class="col-12 col-lg-10 offset-lg-1" aria-hidden="true">
                <section id="chapter-comments" class="basic-section dark:bg-[#1f1f1f] dark:text-white dark:border dark:border-[#1f1f1f]">
                    <header class="sect-header tab-list dark:bg-[#2a2a2a] dark:border-[#2a2a2a]"> 
                        <span class="sect-title tab-title" data-tab-index="1">Bình luận <span class="comments-count">(1)</span></span>
                    </header>
                    <main id="fbcmt_root" class="sect-body">
                        <span style="padding: 10px; display: inline-block;">Báo cáo bình luận không phù hợp ở <a href="/thao-luan/619-bao-cao-binh-luan" style="color: blue">đây</a></span>
                        <div id="tab-content-1" class="tab-content clear">
                            <section class="ln-comment">
    <header>
        <h3 class="text-lg font-bold dark:text-white">1 Bình luận </h3>
        <!-- <i id="refresh_comment" class="fas fa-refresh" aria-hidden="true" style="margin-left: 10px; font-size: 18px"></i></h3> -->
            </header>

    <main class="ln-comment-body">
                    <div class="ln-comment_sign-in long-text">
                Bạn phải <a href="/login">đăng nhập</a> hoặc <a href="/register">tạo tài khoản</a> để bình luận.
            </div>
                
        
        
        <div class="ln-comment-group">
    <div id="ln-comment-3191446"
    class="ln-comment-item mt-3 clear"
    data-comment="3191446" 
    data-parent="3191446" 
    data-type="chapter" 
    data-typeid="303851">
    <div class="flex gap-1 max-w-full">
        <div class="w-[50px]">
            <div class="mx-1 my-1">
                <img src="https://docln.net/img/noava.png" class="w-full rounded-full" />
            </div>
        </div>
        <div
            class="w-full min-w-0 rounded-md bg-gray-100 ps-1 pe-0 pb-1 pt-0 dark:!bg-zinc-800 ">
            <div class="flex min-w-0 flex-col px-2">
                <div class="flex align-top justify-between">
                    <div class="flex flex-wrap gap-x-2 gap-y-1 align-middle pt-1">
    <div class="self-center">
        <a class="font-bold leading-6 md:leading-7 ln-username " href="/thanh-vien/153884">Uuuuuuuu</a>
    </div>
                                    </div>
                                        
                </div>
                                                    <div class="ln-comment-content long-text">
                        Ông nghỉ ngơi đủ không đấy,nhiều thế này thì hơi sợ
                    </div>
                    <div class="comment_see_more expand none">Xem thêm</div>
                    <div class="flex gap-2 align-bottom text-[13px] visible-toolkit">
                        <a href="/truyen/20273-van-de-nan-giai-khi-tan-do-cong-chua-cua-truong/c303851-chuong-16-tien-nu-ung-dung-tu-tai-va-loi-hua-voi-hoang-tu-cong-chua?comment_id=3191446#ln-comment-3191446"
                            class="text-slate-500">
                            <time class="timeago" title="04-02-2026 19:35:47"
                                datetime="2026-02-04T19:35:47+07:00">
                                04-02-2026 19:35:47
                            </time>
                        </a>
                        <a
                            class="self-center visible-toolkit-item do-like cursor-pointer">
                            <i class="fas fa-thumbs-up me-1"></i>
                            <span class="likecount font-semibold"></span>
                        </a>
                                            </div>
                            </div>
        </div>
    </div>
</div>

    </div>

<div class="ln-comment-page">
</div>    </main>

    <script>
        var token = 'rI7UVEKGv1GOTO3rKV17fWSsmx7HMUV72Nv26T1t';
        var comment_type = 'chapter';
        var comment_typeid = '303851';
    </script>

    </section>


                        </div>
                    </main>
                </section>
            </div> 
        </div>
    </div>
</main>

<script>
    token = 'rI7UVEKGv1GOTO3rKV17fWSsmx7HMUV72Nv26T1t';
        
    function turnoffall() {
        $(".rdtoggle").removeClass("on");
        $(".rdtoggle_body").removeClass("animation fade-in-left-big fade-in-down");
        $("html").removeClass("overflow-hiden");
    }
    
    function rdtoggle(classicon, effect) {
        if ($(classicon).hasClass("on")) {
            turnoffall();
        } else {
            turnoffall();
            $(classicon).addClass("on");
            $("html").addClass("overflow-hiden");
            $(classicon + " .rdtoggle_body").addClass("animation " + effect);
        } 
    };
    
    $("#rd-setting_icon").on('click', function() {
        rdtoggle("#setting", "fade-in-down");                   
    });

    $("#rd-tts_icon").on('click', function() {
        rdtoggle("#tts-panel", "fade-in-down");
    });
        
    $("#rd-info_icon").on('click', function() {
        rdtoggle("#chapters", "fade-in-left-big");              
    });
        
    $("#rd-bookmark_icon").on('click', function() {
        rdtoggle("#bookmarks", "fade-in-left-big");                     
    });
        
    $(".black-click").on('click', function() {
        turnoffall();
        $("#rd-side_icon").hide();
        $("#bookmark_top").removeClass("on");
    });
        
    var bgcolor    = Cookies.get('color') || (Cookies.get('night_mode') ? 6 : 4);
    var fontfamily = Cookies.get('fontfamily') || '';
    var fontsize   = Cookies.get('font') || 18; 
    var margin     = Cookies.get('margin') || 0;
    var textAlign  = Cookies.get('textAlign') || 'text-justify';
        
    function setcolor(alter = true) {
        var switcher = $(".set-color .set-input span").eq(bgcolor);
        switcher.addClass("current");

        if (alter) {
            for (var i = 0; i < $(".set-color .set-input span").length; i++) {
                $("#mainpart").removeClass('style-' + i);
                $("#mainpart").removeClass('dark');
            }
            $("#mainpart").addClass('style-' + bgcolor);

            // Manually hardcoded to dark
            if (bgcolor >= 6) {
                $("#mainpart").addClass('dark');
            }
        }
    }

    // This creates unsmooth experience so we only use it for select box
    function setfontfamily() {
        $('.set-font-family select option').filter(function () {
            return fontfamily.split(',')[0].indexOf($(this).text()) != -1 ;
        }).attr('selected', true);
    }
        
    function setfontstyle(alter = true) {
        $(".set-font input.set-slide_input").val(fontsize + "px"); 

        if (alter) {
            $("div#chapter-content").css("font-size", fontsize + "px");

            var lineheight = +fontsize + 10;
            $("#chapter-content").css("line-height", lineheight + "px");
        }
    }
        
    function setmargin() {
        $(".set-margin input.set-slide_input").val(margin + "px"); 
        $("#chapter-content").css({
            'padding-left': margin + "px",
            'padding-right': margin + "px"
        });
    }

    function setTextAlign(alter = true) {
        var switcher = $(".set-text-align .set-input span[data-align='" + textAlign + "']");
        switcher.addClass("current");

        if (alter) {
            $(".set-text-align .set-input span").each(function () {
                $("#chapter-content").removeClass($(this).attr('data-align'));
            });

            $("#chapter-content").addClass(textAlign);
        }
    }
    
    setcolor(false);
    setfontfamily();
    setfontstyle(false);
    setmargin();
    setTextAlign(true);
    
    //1px = 0.0625rem;
    //16px = 1rem (default);
    
    $(".set-color .set-input span").click(function(){
        bgcolor = $(this).data("id");
        $(".set-color .set-input span").removeClass("current");
        setcolor();            
        Cookies.set('color', bgcolor, { expires: 365 });
    });

    $('.set-font-family select').on('change', function () {
        fontfamily = "'" + $('option:selected', this).text() + "', " + '\'Times New Roman\', Georgia, serif';
        
        $('div#chapter-content').css('font-family', fontfamily);

        Cookies.set('fontfamily', fontfamily, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-smaller").click(function () {
        fontsize = fontsize - 2;
        if (fontsize < 0) fontsize = 0;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-bigger").click(function () {
        fontsize = +fontsize + 2;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-smaller").click(function () {
        margin = margin - 20;
        if (margin < 0) margin = 0;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-bigger").click(function () {
        margin = +margin + 20;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    }); 

    $(".set-text-align .set-input span").click(function(){
        textAlign = $(this).data("align");
        $(".set-text-align .set-input span").removeClass("current");
        setTextAlign();        
        Cookies.set('textAlign', textAlign, { expires: 365 });
    });
        
    $("#bookmarks_list li").each(function(){
        var linepr = $(this).data("line");
        var preview = $(".reading-content p#" + linepr).text();

        var shortText = preview.trim().substring(0, 30) + "...";
        $(this).find(".pos_bookmark small").text(shortText);
    });

    $('div#chapter-content').html(
        $('div#chapter-content').html().replace(
            /\[note(\d+)\]/gi, 
            '<span id="anchor-note$1" class="note-icon none-print inline note-tooltip" data-tooltip-content="#note$1 .note-content" data-note-id="note$1"><i class="fas fa-sticky-note"></i></span><a id="anchor-note$1" class="inline-print none" href="#note$1">[note]</a>'
        )
    )
    
    tippy('.note-tooltip', {
        delay: 50,
        maxWidth: 240,
        interactive: true,
        content(ref) {
            const selector = ref.getAttribute('data-tooltip-content');
            const template = document.querySelector(selector);
            return template ? template.innerHTML : 'Đặt sai ID của note';
        }
    });
        
    isLoggedIn = 0;
    series_id = parseInt('20273');
    chapter_id = parseInt('303851');

    readingObject = {
        series_id: series_id,
        series_title: 'Vấn Đề Nan Giải Khi Tán Đổ Công Chúa Của Trường',
        series_url: $('i.fa-home').first().parent().attr('href'),
        series_cover: $('.rd_sidebar-header a.img').css('background-image'),
        chapter_title: $('ul.sub-chap_list li.current a').text().trim(),
        chapter_url: $('ul.sub-chap_list li.current a').attr('href'),
        book_title: $('ul#chap_list > li.current a').text(),
        book_url: $('ul#chap_list > li.current a').attr('href'),
        read_time: +new Date() / 1000 | 0,
    };

// TTS Manager - Enhanced Web Speech API (Vietnamese). Chunked queue for long texts, no delays/interrupts.
const synth = window.speechSynthesis;
let voices = [];
let voicesLoaded = false;
let ttsRate = parseFloat(localStorage.getItem('tts-rate')) || 1;
let ttsPitch = parseFloat(localStorage.getItem('tts-pitch')) || 1;
let ttsState = 'idle'; // idle, speaking, paused, loading
let currentChunk = 0;
let totalChunks = 0;
let processingIndex = 0;
let paragraphs = [];
const BUFFER_SIZE = 5;

// --- Background Persistence (Wake Lock + Silent Audio) ---
let wakeLock = null;
const silentAudio = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTSVNFAAAAPAAADEVuY29kZWQgd2l0aCBMYW1lMy4xMDBhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUA==');
silentAudio.loop = true;

async function enableConnection() {
    // 1. Start Silent Audio Loop (tricks browser into thinking we are a music player)
    try {
        await silentAudio.play();
    } catch (err) {
        console.warn('Silent Audio Play Failed (likely no interaction):', err);
    }

    // 2. Request Screen Wake Lock (prevents screen from sleeping automatically)
    if ('wakeLock' in navigator) {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (err) {
            console.warn('Wake Lock Request Failed:', err);
        }
    }
}

function disableConnection() {
    // 1. Stop Silent Audio
    try {
        silentAudio.pause();
        silentAudio.currentTime = 0;
    } catch (e) {}

    // 2. Release Wake Lock
    if (wakeLock) {
        try {
            wakeLock.release();
            wakeLock = null;
        } catch (e) {}
    }
}

// Re-acquire Wake Lock if visibility changes and we are speaking
document.addEventListener('visibilitychange', async () => {
    if (wakeLock !== null && document.visibilityState === 'visible' && ttsState === 'speaking') {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (e) {}
    }
});
// ---------------------------------------------------------

let ttsVoiceIdx = localStorage.getItem('tts-voice') || '0';

function populateVoices() {
    voices = synth.getVoices().filter(v => v.lang.startsWith('vi'));
    voicesLoaded = true;
    let $select = $('#tts-voice-select');
    $select.empty();

    if (voices.length === 0) {
        $select.append('<option value="-1">Không có giọng Việt (cài Chrome/Edge)</option>');
        return;
    }

    voices.forEach((voice, idx) => {
        $select.append(`<option value="${idx}">${voice.name} (${voice.lang}) ${voice.default ? '(mặc định)' : ''}</option>`);
    });

    let idx = Math.max(0, Math.min(parseInt(ttsVoiceIdx), voices.length - 1));
    $select.val(idx);
}

function updateTTSUI(progress = '') {
    let $icon = $('#rd-tts_icon i');
    $icon.removeClass('fa-volume-up fa-volume-mute fa-spinner fa-spin');
    let $playBtn = $('#tts-play-btn'), $pauseBtn = $('#tts-pause-btn'), $stopBtn = $('#tts-stop-btn');
    $playBtn.prop('disabled', ttsState === 'speaking' || ttsState === 'loading'); // Enable on idle/paused
    $pauseBtn.prop('disabled', ttsState === 'idle');
    $stopBtn.prop('disabled', ttsState === 'idle');
    // Always remove old progress
    $('#tts-progress').remove();

    if (progress && totalChunks > 0) {
        $playBtn.after(`<span id="tts-progress" class="text-xs block text-center mt-1">${progress}</span>`);
    }

    if (ttsState === 'idle') {
        // Check resume preview
        const resumeData = loadResumeState();
        let currentParagraphs = $('#chapter-content p').map(function() {
            return $(this).text().trim();
        }).get().filter(p => p.trim().length > 0);

        if (resumeData && resumeData.total === currentParagraphs.length) {
            $playBtn.text(`Tiếp tục (${resumeData.index + 1}/${resumeData.total})`);
        } else {
            $playBtn.text('Phát');
        }

        $icon.addClass('fa-volume-up');
    } else if (ttsState === 'speaking' || ttsState === 'loading') {
        $icon.addClass('fa-volume-up fa-spinner fa-spin');
    } else if (ttsState === 'paused') {
        $icon.addClass('fa-volume-mute');
    }
}

$('#tts-play-btn').off('click').on('click', function() {
    // Always restart/resume from storage
    enableConnection(); // Start keep-alive
    synth.cancel();
    ttsState = 'idle';
    // queuedUtterances = []; // Removed global queue
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();

    if (!voicesLoaded || voices.length === 0) {
        ttsState = 'loading';
        updateTTSUI();
        setTimeout(() => {
            if (!voicesLoaded) {
                alert('Giọng nói chưa tải. Thử lại.');
                ttsState = 'idle';
                updateTTSUI();
                return;
            }
            playTTS();
        }, 500);
        return;
    }

    playTTS();
});

function createUtterance(item) {
    let u = new SpeechSynthesisUtterance(item.text);
    u.lang = 'vi-VN';
    u.rate = parseFloat($('#tts-rate').val()) || 1;
    u.pitch = parseFloat($('#tts-pitch').val()) || 1;
    let voiceIdx = parseInt($('#tts-voice-select').val());

    if (voiceIdx >= 0 && voices[voiceIdx]) {
        u.voice = voices[voiceIdx];
    }

    u.onstart = () => {
        currentChunk++;
        saveResumeState();
        updateTTSUI(`${currentChunk}/${totalChunks}`);
        
        // Highlight logic
        $('.current-reading').removeClass('current-reading');
        if (item.el) {
            $(item.el).addClass('current-reading');
            item.el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        feedQueue(); // Ensure buffer is maintained
    };
    u.onerror = (event) => {
        console.error('TTS Error:', event.error, event);

        if (event.error !== 'interrupted') {
             // alert(`Lỗi TTS: ${event.error}. Bỏ qua đoạn.`);
             console.warn('TTS Error skipping chunk', event.error);
        }

        saveResumeState(); // Save on error
        feedQueue();
    };
    u.onend = () => {
        saveResumeState();

        if (currentChunk >= totalChunks) {
            clearResumeState();
            $('.current-reading').removeClass('current-reading'); // Cleanup
            
            // Auto-Next Logic
            let $nextBtn = $('.rd-basic_icon a').last();
            if ($nextBtn.length && !$nextBtn.hasClass('disabled')) {
                localStorage.setItem('tts-autoplay', 'true');
                window.location.href = $nextBtn.attr('href');
                return;
            }

            ttsState = 'idle';
            disableConnection(); // Cleanup
            currentChunk = 0;
            totalChunks = 0;
            processingIndex = 0;
            updateTTSUI();
        } else {
            feedQueue();
        }
    };
    u.onpause = () => { saveResumeState(); };
    return u;
}

function getStorageData() {
    try {
        return JSON.parse(localStorage.getItem('tts-resume-data')) || {};
    } catch {
        return {};
    }
}

function setStorageData(data) {
    localStorage.setItem('tts-resume-data', JSON.stringify(data));
}

function saveResumeState() {
    if (totalChunks > 0) {
        const data = getStorageData();
        data[chapter_id] = {
            index: currentChunk,
            total: totalChunks,
            timestamp: Date.now()
        };
        // Optional: Clean up old entries (older than 7 days?) to prevent infinite growth, 
        // but for now we just save.
        setStorageData(data);
    }
}

function clearResumeState() {
    const data = getStorageData();

    if (data[chapter_id]) {
        delete data[chapter_id];
        setStorageData(data);
    }
}

function loadResumeState() {
    const data = getStorageData();
    const saved = data[chapter_id];
    
    if (!saved) return null;
    
    if (Date.now() - saved.timestamp > 3600000 * 24 * 7) { // 7 days
        clearResumeState();
        return null;
    }

    return saved;
}

function initTTS() {
    populateVoices();
    $('#tts-rate').val(ttsRate);
    $('#tts-rate-value').text(ttsRate);
    $('#tts-pitch').val(ttsPitch);
    $('#tts-pitch-value').text(ttsPitch);
    updateTTSUI();
    
    if (localStorage.getItem('tts-autoplay') === 'true') {
        localStorage.removeItem('tts-autoplay');
        $(window).on('load', function() {
             setTimeout(() => {
                 $('#tts-play-btn').click(); 
             }, 500); 
        });
    }
}

function getParagraphs() {
    return $('#chapter-content p').map(function() {
        let text = $(this).text().trim();
        
        // If paragraph contains an image, replace with "Hình ảnh"
        if ($(this).find('img').length > 0) {
            text = 'Hình ảnh';
        }
        
        if (text.length > 0) {
            return { text: text, el: this };
        }
    }).get();
}

function feedQueue() {
    if (ttsState !== 'speaking') return;
    
    // Maintain buffer
    while (processingIndex < totalChunks && processingIndex < currentChunk + BUFFER_SIZE) {
        let u = createUtterance(paragraphs[processingIndex]);
        synth.speak(u);
        processingIndex++;
    }
}

function playTTS() {
    paragraphs = getParagraphs();
    if (paragraphs.length === 0) {
        alert('Không có nội dung để đọc.');
        ttsState = 'idle';
        disableConnection(); // Cleanup
        updateTTSUI();
        return;
    }
    
    const resumeData = loadResumeState();
    if (resumeData && resumeData.total === paragraphs.length) {
        currentChunk = resumeData.index;
        totalChunks = resumeData.total;
        // processingIndex needs to match what we are about to play
        // Current chunk is what finished, so we start processing from currentChunk?
        // Wait, currentChunk is "index of just finished" in some contexts?
        // No, in loadResume, index is currentChunk.
        // If saved index is 5. means 0..4 played.
        // We start playing from 5 (index).
        // So processingIndex = currentChunk.
        processingIndex = currentChunk;
    } else {
        clearResumeState();
        currentChunk = 0;
        totalChunks = paragraphs.length;
        processingIndex = 0;
    }
    
    synth.cancel();
    ttsState = 'speaking';
    
    feedQueue();
    updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
}

$('#tts-rate').on('input', function() {
    $('#tts-rate-value').text(this.value);
    localStorage.setItem('tts-rate', this.value);
});

$('#tts-pitch').on('input', function() {
    $('#tts-pitch-value').text(this.value);
    localStorage.setItem('tts-pitch', this.value);
});

$('#tts-voice-select').on('change', function() {
    localStorage.setItem('tts-voice', this.value);
});

$('#tts-pause-btn').off('click').on('click', function() {
    if (ttsState === 'speaking') {
        synth.pause();
        ttsState = 'paused';
        disableConnection(); // Pause keep-alive
        updateTTSUI();
        saveResumeState();
    } else if (ttsState === 'paused') {
        enableConnection(); // Resume keep-alive
        synth.resume();
        ttsState = 'speaking';
        updateTTSUI();
    }
});

$('#tts-stop-btn').off('click').on('click', function() {
    synth.cancel();
    // clearResumeState(); // Stop doesn't necessarily clear resume, usually just pause? 
    // But UI says "Stop". Let's clear resume state to consistent with old behavior 
    // or maybe optional? Old behavior cleared it.
    clearResumeState();
    
    disableConnection(); // Stop keep-alive
    $('.current-reading').removeClass('current-reading'); // Cleanup
    ttsState = 'idle';
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();
});

// Visibility handler removed - TTS continues on tab switch

// Long-press to start TTS from selected paragraph (500ms hold)
let longPressTimer = null;
let longPressTarget = null;

// $('#chapter-content p').on('touchstart mousedown', function(e) {
//     longPressTarget = this;
//     longPressTimer = setTimeout(() => {
//         const allParagraphs = getParagraphs();
//         const startIndex = allParagraphs.findIndex(p => p.el === longPressTarget);

//         if (startIndex === -1) return;

//         clearResumeState();
//         synth.cancel();
        
//         paragraphs = allParagraphs;
//         currentChunk = startIndex;
//         totalChunks = paragraphs.length;
//         processingIndex = startIndex;
//         ttsState = 'speaking';
        
//         enableConnection();
//         feedQueue();
//         updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
//     }, 500);
// }).on('touchend touchmove mouseup mouseleave', function() {
//     clearTimeout(longPressTimer);
//     longPressTimer = null;
// });

synth.onvoiceschanged = populateVoices;
initTTS();


</script>





    
    <script src="/scripts/service-manager.js?r=4"></script>

    <script src="/scripts/app.js?id=a5a24eca66adcfc75cc0b2f62e2611db"></script>
    <script src="https://docln.net/vendor/livewire/livewire.min.js?id=df3a17f2"   data-csrf="rI7UVEKGv1GOTO3rKV17fWSsmx7HMUV72Nv26T1t" data-update-uri="/livewire/update" data-navigate-once="true"></script>

    
    <script src="https://confidecross.com/d5/6b/4b/d56b4bd6c3d2c1e161c4ab3c78c27670.js" async></script>

        
            <footer id="footer">
    <div class="container">
        <!--<span><a href="">Hako.re</a></span>-->
        <span class="right">Liên hệ: <a href="mailto:contact@hako.vn" target="_blank" style="color: #5fff46">contact@hako.vn</a></span>

        <span>© 2016 - 2026 Cổng Light Novel - Đọc Light Novel</span>
    </div>
</footer>    
    <div x-data x-show="$store.toast.on" @click="$store.toast.hide()" class="bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fixed w-3/4 md:w-1/2 z-20 inset-x-0 bottom-10 mx-auto" role="alert" style="display: none">
    <div class="flex">
        <div class="py-1"><svg class="fill-current h-6 w-6 text-teal-500 mr-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"/></svg></div>
        <div>
            <p class="font-bold capitalize">Chú ý</p>
            <p class="text-sm" x-text="$store.toast.message"></p>
        </div>
    </div>
</div><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c8a361d6d92f070',t:'MTc3MDIwODU2Mg=='};var a=document.createElement('script');a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
