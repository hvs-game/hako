<!DOCTYPE html>
<html lang="vi" class="light">
<head>
    <meta charset="utf-8">
    
    <title>Đọc Ta Đâu Phải Phù Thủy - Chương 14: Ba món quà - Cổng Light Novel - Đọc Light Novel</title>

    <meta name="description" content="Những ngọn thương trải khắp đồng hoang, dựng lên như rừng, đoàn kỵ sĩ vinh quang xếp hàng tiến bước, vô số lá cờ đen tung bay trong gió. “Tiến lên! Cho đến tận cùng của thế giới!” Mây giông tan rã, tinh quang rơi xuống, đoàn kỵ sĩ hắc...">
    <meta name="theme-color" content="#000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="BNjsgvQtJlvyPKTjwaFmuKjT4vfWowigb6Jgu6dp">
    <meta name="logged-in" content="0">
    <meta property="fb:app_id" content="1864643850436909">

    <link rel="canonical" href="https://docln.net/truyen/23638-ta-dau-phai-phu-thuy/c264941-chuong-14-ba-mon-qua">
    <meta property="og:image" content="https://i.hako.vn/ln/series/covers/s23638-67dcc16f-d94f-433d-8103-b00b7b271ddb.jpg">


<style type="text/css">@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek/wght/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek-ext/wght/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/devanagari/wght/normal.woff2);unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek/400/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek-ext/400/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}</style>
    <link rel="preload" href="/fonts/OpenSans-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/fonts/OpenSans-SemiBold.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preconnect" href="https://www.google-analytics.com">

    <link rel="shortcut icon" href="/img/favicon.png?v=3">
    <link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon.png?v=3">
    <link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png?v=3">
    <link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png?v=3">

    <link rel="stylesheet" href="/css/interface.css?id=300c3109a58d319c9bb94c8585835c77">
    <link rel="stylesheet" href="/css/tailwind.css?id=9128bdee617e5eb876ffd418ed3597bf">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css" integrity="sha256-BtbhCIbtfeVWGsqxk1vOHEYXS6qcvQvLMZqjtpWUEx8=" crossorigin="anonymous" />
            
    
    <script src="/scripts/plugins.js?id=b612d946b32459430eed3066ed15adf2"></script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-34864968-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
      gtag('config', 'UA-34864968-3');
    </script>
</head>

<body>
	
    <div x-data="{ open: Cookies.get('globalwarning2') === undefined ? true : false }">
    <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4" x-show="open" style="display: none">
        <div class="flex">
            <div class="shrink-0">
                <button x-on:click="open = false; Cookies.set('globalwarning2', false, { expires: 0.5 })" type="button" class="inline-flex rounded-md bg-yellow-50 p-1.5 text-yellow-500 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-600 focus:ring-offset-2 focus:ring-offset-yellow-50">
                    <span class="sr-only">Dismiss</span>
                    <svg class="size-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
                    <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z" />
                    </svg>
                </button>
            </div>
            <div class="ml-3 font-bold">
                <p class="text-sm text-yellow-700">
                Nếu không thể <a class="font-medium text-blue-700" href="/thao-luan/2898-ten-mien-da-bi-chan">truy cập trang web</a> xin vui lòng sử dụng DNS 
                <a class="font-medium text-blue-700" href="https://www.google.com/search?q=c%C3%A1ch+c%C3%A0i+dns+1.1.1.1" target="_blank">1.1.1.1</a> hoặc <a class="font-medium text-blue-700" href="https://docln.sbs" target="_blank">docln.sbs</a>
                
                </p>
                <p>
                    <p class="text-sm text-orange-700">Hiện đang đứt cáp Internet APG, kết nối có thể chậm hoặc rất chậm. Dùng VPN không chắc có hiệu quả.</p>
                </p>
            </div>

        </div>
    </div>
</div>



	<style>
    body {
        background: inherit;
    }

    #footer {
        display: none;
    }
    
    .current-reading {
        background-color: rgba(189, 224, 254, 0.3);
        border-left: 5px solid #007bff;
        padding-left: 10px;
        transition: background-color 0.3s ease;
    }
</style>


<main id="mainpart" class="reading-page style-4">
    <section id="rd-side_icon" class="none force-block-l" aria-hidden="true">
                <a class="rd_sd-button_item rd_top-left" href="/truyen/23638-ta-dau-phai-phu-thuy/c263547-chuong-13-doi-huyet-long"><i class="fas fa-backward"></i></a>
        
        <a class="rd_sd-button_item" href="/truyen/23638-ta-dau-phai-phu-thuy"><i class="fas fa-home"></i></a>     
        <a id="rd-setting_icon" data-affect="#" class="rd_sd-button_item"><i class="fas fa-font"></i></a>
        <a id="rd-tts_icon" class="rd_sd-button_item"><i class="fas fa-volume-up"></i></a>
        <a id="rd-info_icon" data-affect="#rd_sidebar.chapters" class="rd_sd-button_item"><i class="fas fa-info"></i></a>
        <a id="rd-bookmark_icon" data-affect="#rd_sidebar.bookmarks" class="rd_sd-button_item"><i class="fas fa-bookmark"></i></a>

        
                <a class="rd_sd-button_item rd_top-right" href="/truyen/23638-ta-dau-phai-phu-thuy/c267766-chuong-15-tam-biet"><i class="fas fa-forward"></i></a>
            </section>    
    
    <section id="chapters" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <header class="rd_sidebar-header clear">
                <a class="img" href="/truyen/23638-ta-dau-phai-phu-thuy/c264941-chuong-14-ba-mon-qua" style="background: url('https://i.hako.vn/ln/series/covers/s23638-67dcc16f-d94f-433d-8103-b00b7b271ddb.jpg') no-repeat"></a> 
                <div class="rd_sidebar-name">                    
                    <h5><a href="/truyen/23638-ta-dau-phai-phu-thuy">Ta Đâu Phải Phù Thủy</a></h5>
                    <small><i class="fas fa-pen"></i>青空乐章</small>
                    <small><i class="fas fa-paint-brush"></i></small>                
                </div>
            </header>

            <ul id="chap_list" class="unstyled">
                                                            <li class="current"><a href="/truyen/23638-ta-dau-phai-phu-thuy/t33682-vol-1-1-137">Dạ Tinh Tú (1-137)</a></li>
                        <ul class="sub-chap_list unstyled">
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c241233-chuong-1-niem-vui-cua-su-tai-sinh">
                                                                        Chương 1: Niềm vui của sự tái sinh
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c241486-chuong-2-the-gioi-sieu-pham">
                                                                        Chương 2: Thế giới siêu phàm
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c242947-chuong-3-di-san-cua-phu-thuy">
                                                                        Chương 3: Di sản của Phù thủy
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c244280-chuong-4-phu-thuy-canh-buom">
                                                                        Chương 4: Phù thủy Cánh bướm
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c245834-chuong-5-thieu-nien-bi-thuong">
                                                                        Chương 5: Thiếu niên bị thương
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c249815-chuong-6-tinh-hinh-hien-tai">
                                                                        Chương 6: Tình hình hiện tại
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c251457-chuong-7-cau-tra-loi-cuoi-cung">
                                                                        Chương 7: Câu trả lời cuối cùng
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c253619-chuong-8-rung-phong-do">
                                                                        Chương 8: Rừng phong đỏ
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c254858-chuong-9-thu-nghe-su-gio-am">
                                                                        Chương 9: Thụ Nghệ Sư Gió ấm
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c255648-chuong-10-ngoi-nha-nho-trong-rung">
                                                                        Chương 10: Ngôi nhà nhỏ trong rừng
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c258847-chuong-11-cau-thieu-nien-tro-ve">
                                                                        Chương 11: Cậu thiếu niên trở về
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c260885-chuong-12-giong-loai-moi">
                                                                        Chương 12: Giống loài mới
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c263547-chuong-13-doi-huyet-long">
                                                                        Chương 13: Dơi Huyết Long
                                </a>
                            </li>
                                                        <li  class="current" >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c264941-chuong-14-ba-mon-qua">
                                                                        Chương 14: Ba món quà
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c267766-chuong-15-tam-biet">
                                                                        Chương 15: Tạm biệt
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c270172-chuong-16-anh-sang-hoang-hon">
                                                                        Chương 16: Ánh sáng hoàng hôn
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c271100-chuong-17-lang-nui-tai-tho">
                                                                        Chương 17: Làng Núi Tai Thỏ
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c272754-chuong-18-ngan-hoan-cu-xa">
                                                                        Chương 18: Ngân Hoàn Cự Xà
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c273213-chuong-19-vi-cuu-tinh-toc-bac">
                                                                        Chương 19: Vị cứu tinh tóc bạc
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c273872-chuong-20-tram-sat-cu-xa">
                                                                        Chương 20: Trảm sát cự xà
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c277725-chuong-21-thu-phuc-nhan-tam">
                                                                        Chương 21: Thu phục nhân tâm
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c280102-chuong-22-phu-thuy-ao-anh">
                                                                        Chương 22: Phù thủy Ảo ảnh
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c280338-chuong-23-bua-toi-hu-ao">
                                                                        Chương 23: Bữa tối hư ảo
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/23638-ta-dau-phai-phu-thuy/c283027-chuong-24-tu-choi-lich-su">
                                                                        Chương 24: Từ chối lịch sự
                                </a>
                            </li>
                                                    </ul>
                                        
                                                            <li class=" disabled "><a href="/truyen/23638-ta-dau-phai-phu-thuy">Emenas (138 - 418)</a></li>
                                        
                                                            <li class=" disabled "><a href="/truyen/23638-ta-dau-phai-phu-thuy">Ánh Sao và Hoa Hồng (419 - 618)</a></li>
                                        
                                                            <li class=" disabled "><a href="/truyen/23638-ta-dau-phai-phu-thuy">Vùng đất Phương Đông (619 - 765)</a></li>
                                        
                                                            <li class=" disabled "><a href="/truyen/23638-ta-dau-phai-phu-thuy">Chiến tranh Hoa Hồng (766 - 1146)</a></li>
                                        
                                                            <li class=" disabled "><a href="/truyen/23638-ta-dau-phai-phu-thuy">Sự trở về của Rồng (1147 - 1270)</a></li>
                                        
                                                            <li class=""><a href="/truyen/23638-ta-dau-phai-phu-thuy/c267983-chuyen-hai-trinh-khong-ngay-tro-ve-1">Tiền truyện - Hành trình không trở về</a></li>
                                        
                                        
            </ul>
        </main>
        <div class="black-click"></div>
    </section>
    
    <section id="bookmarks" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <div class="rd_sidebar-header">
                <h2 class="rd_s-name"><i class="fas fa-bookmark"></i><a href="/bookmark" style="color: white;"> Bookmarks</a></h2>
            </div>
            <ul id="bookmarks_list" class="unstyled">
                                            <li>Bạn phải đăng nhập để sử dụng bookmark</li>
                                        </ul>
        </main>
        <div class="black-click"></div>
    </section>

    <section id="setting" class="rdtoggle" aria-hidden="true">
        <section class="re_set-in basic-section clear rdtoggle_body">
        <header class="sect-header"><span class="sect-title">Tùy chỉnh</span></header>
            <main class="sect-body">
                <div class="set-list set-color clear">
                    <label class="font-bold">Màu nền</label>
                    <div class="set-input clear justify-center">
                        <span data-color="#ffffff" data-id="0" style="background-color: #ffffff"></span>
                        <span data-color="#e6f0e6" data-id="1" style="background-color: #e6f0e6"></span>
                        <span data-color="#e3f5fa" data-id="2" style="background-color: #e3f5fa"></span>
                        <span data-color="#f6f4ec" data-id="3" style="background-color: #f6f4ec"></span>
                        <span data-color="#eae4d3" data-id="4" style="background-color: #eae4d3"></span>
                        <span data-color="#f5e9ef" data-id="5" style="background-color: #f5e9ef"></span>
                        <span data-color="#222222" data-id="6" style="background-color: #222222"></span>
                        <span data-color="#000000" data-id="7" style="background-color: #000000"></span>
                    </div>
                </div>
                <div class="set-list set-font-family clear">
                    <label class="font-bold">Font chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <select>
                            <option>Times New Roman</option>
                            <option>Merriweather</option>
                            <option>Lora</option>
                            <option>Roboto</option>
                            <option>Noto Sans</option>
                            <option>Nunito</option>
                        </select>
                    </div>
                </div>
                <div class="set-list set-font clear">
                    <label class="font-bold">Kích cỡ chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="16px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-margin clear">
                    <label class="font-bold">Bản lề</label>
                    <div class="set-slide set-input justify-center">
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="20px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-text-align clear">
                    <label class="font-bold">Kiểu căn chỉnh</label>
                    <div class="set-input clear justify-center font-medium text-2xl flex flex-row gap-10">
                        <span data-align="text-left" class="p-1"><i class="fas fa-align-left"></i></span>
                        <span data-align="text-center" class="p-1"><i class="fas fa-align-center"></i></span>
                        <span data-align="text-right" class="p-1"><i class="fas fa-align-right"></i></span>
                        <span data-align="text-justify" class="p-1"><i class="fas fa-align-justify"></i></span>
                    </div>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>

    <section id="tts-panel" class="rdtoggle" aria-hidden="true">
        <section class="tts-settings basic-section clear rdtoggle_body">
            <header class="sect-header"><span class="sect-title">Text-to-Speech</span></header>
            <main class="sect-body">
                <div class="set-list clear" style="color: red; font-size: 14px; margin-bottom: 20px">
                    Đây là chức năng đang thử nghiệm, chi tiết xem tại <a href="/thao-luan/3305-chuc-nang-doc" style="color: blue">Link</a>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Giọng đọc</label>
                    <select id="tts-voice-select" class="w-full p-2 border rounded bg-white dark:bg-gray-800 text-sm dark:border-gray-600"></select>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Tốc độ</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-rate" min="0.1" max="3" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-rate-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Độ cao (Pitch)</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-pitch" min="0" max="2" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-pitch-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="flex gap-2 pt-4">
                    <button id="tts-play-btn" class="flex-1 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Phát</button>
                    <button id="tts-pause-btn" class="flex-1 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Tạm dừng</button>
                    <button id="tts-stop-btn" class="flex-1 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Dừng</button>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>
    
    <div class="container">
        <div class="row">
            <div class="reading-content col-12 col-lg-10 offset-lg-1" style="word-wrap: break-word;">
                <div id="bookmark_top" class="block d-lg-none"><i class="fas fa-bookmark"></i></div>
                <span class="save_bookmark" style="position: absolute; top: 9999px; display: none"><i class="fas fa-bookmark"></i></span>
                
                
                
                <div class="title-top" style="padding-top: 20px">
                    <h2 class="title-item text-xl font-bold" align="center">Dạ Tinh Tú (1-137)</h2>
                    <h4 class="title-item text-base font-bold" align="center">Chương 14: Ba món quà</h4>
                    <h6 class="title-item font-bold" align="center" aria-hidden="true">
                        <a href="https://docln.net/truyen/23638-ta-dau-phai-phu-thuy/c264941-chuong-14-ba-mon-qua#chapter-comments" style="text-decoration: underline">2 Bình luận</a> -
                        Độ dài: 1,942 từ - Cập nhật: 
                        <time class="topic-time timeago" title="26-11-2025 03:03:12" datetime="2025-11-26T03:03:12+07:00"></time>                    </h6>
                </div>

                <div style="text-align: center; margin: 20px auto -20px auto;">
                                                            
                </div>

                <div id="chapter-content" class="long-text no-select text-justify">
                    <p style="display: none">Chương 14: Ba món quà</p>
                    <p id="1">Lorraine quan sát viên bảo thạch một lượt rồi cất nó đi.</p><p id="2">“Viên đá này ta tạm giữ trước, vài hôm nữa sẽ trả lại cho em.”</p><p id="3">Pullman vội vàng nói rằng mình hoàn toàn không để ý, bởi nếu không có Lorraine, cậu sẽ chẳng thể tự mình chiết xuất được năng lượng siêu phàm từ con Dơi Huyết Long.</p><p id="4">“Tạm xem như đạt yêu cầu đi… nhưng sau này ra ngoài thì đừng nhắc đến tên ta nữa, ta sợ mất mặt.” Cô vẫn có chút không vừa ý.</p><p id="5"><em>Tên học trò này đúng là hơi đần thật.</em></p><p id="6">Pullman chỉ đành cười gượng chấp nhận, nhưng trong lòng lại thầm thề rằng tương lai nhất định phải lập nên đại nghiệp, để người thầy trước mắt công nhận mình.</p><p id="7">Sau trận chiến này, Pullman nghỉ ngơi hai ngày, còn Lorraine thì suốt thời gian ấy vẫn ở trong căn nhà nhỏ trong rừng phong, nghiên cứu những công thức mà hệ thống đã thưởng trước đó.</p><p id="8">【Thuốc Hoạt Huyết】(Cấp Đồng Đỏ): Có thể bổ sung lượng máu đã mất, chữa trị bỏng lạnh và hàn độc, thúc đẩy vết thương mau lành, là loại thuốc thông dụng và có phạm vi sử dụng rất rộng.</p><p id="9">Để điều chế loại thuốc này, cần máu của sinh vật cấp cao, hoặc những vật liệu liên quan đến Chuỗi Ác Ma. Trước đây luôn không có nguyên liệu thích hợp, còn bây giờ vừa vặn có thể dùng viên Huyết Hồng Bảo Thạch đó làm nguyên liệu.</p><p id="10">Lorraine châm lửa dưới chiếc nồi luyện, trước tiên cho vào vài loại thảo dược phụ trợ, rồi bắt đầu đun sắc liên tục.</p><p id="11">Khó khăn lớn nhất khi điều chế thuốc nằm ở liều lượng và tỉ lệ của các nguyên liệu, cùng với việc kiểm soát những biến hóa phản ứng trong mỗi khâu, chỉ sơ ý một chút thôi là mọi công sức sẽ đổ sông đổ biển.</p><p id="12">Về phần nguyên liệu, mỗi cây thảo dược đều có kích thước khác nhau, lượng dược tính chứa bên trong cũng chênh lệch rất lớn tùy theo môi trường sinh trưởng, thời điểm thu hái và mức độ hao hụt khi bảo quản. Người mới thường phải luyện tập rất nhiều mới có thể nắm được cách chọn nguyên liệu và xác định liều lượng cho chính xác.</p><p id="13">Thực ra, dù là ở Kỷ nguyên thứ Hai hay là hiện tại, đa số dược sư chỉ thành thạo được một vài công thức mà thôi. Đúng kiểu chỉ cần một ngón nghề là đủ kiếm cơm cả đời.</p><p id="14">Những người thật sự có thể điều chế được nhiều loại thuốc đều là bậc đại sư. Suy cho cùng, nghề này phụ thuộc quá nhiều vào kinh nghiệm, chỉ cần sơ sẩy một chút là tiêu tốn biết bao nhiêu nguyên liệu quý giá. Thế nhưng, muốn lên tay thì dược sư bắt buộc phải thực hành, chính vì thế mà nhân tài trong ngành này xưa nay vẫn luôn vô cùng khan hiếm.</p><p id="15">Trong Vương triều Thủy Ngân, rất nhiều đại dược sư đều là phù thủy, bởi họ có tuổi thọ rất dài nên việc bồi dưỡng sẽ mang lại hiệu quả cao hơn. Hơn nữa, nếu là những loại thuốc thuộc đúng lĩnh vực của họ, thì khi điều chế thậm chí còn có thể tạo ra những hiệu quả kỳ diệu.</p><p id="16">Đến mức mà về sau này, hễ nhắc tới phù thủy, người ta sẽ lập tức liên tưởng đến hình ảnh người phụ nữ mặc váy áo đen tuyền, đứng bên cạnh chiếc vạc khổng lồ mà khuấy thuốc.</p><p id="17">Nhờ vào sự hỗ trợ của thiên phú cấp Thần thoại, Lorraine có thể cảm nhận một cách chuẩn xác và rõ ràng từng chút biến đổi của các thành phần bên trong nồi thuốc. Chỉ sau lần thử nghiệm đầu tiên, tới lần thứ hai cô đã điều chế ra được loại thuốc có phẩm chất Hoàn mỹ.</p><p id="18">Trong ống nghiệm, sắc đỏ mê người đang khẽ sóng sánh, một phần <em>Thuốc Hoạt Huyết</em> đã được điều chế xong.</p><p id="19">【Thuốc Hoạt Huyết】(Cấp Đồng Đỏ – Hoàn mỹ): Được điều chế với nguyên liệu chính là Huyết Hồng Bảo Thạch thuộc chuỗi Ác Ma. Quá trình điều chế hoàn hảo không chút tì vết, chất lượng vô cùng xuất sắc, đủ tiêu chuẩn làm mẫu vật giảng dạy.</p><p id="20">Tận dụng hoàn toàn viên Huyết Hồng Bảo Thạch ấy, cuối cùng Lorraine đã điều chế ra được 10 phần thuốc.</p><p id="21">Loại thuốc thường dùng trong chiến đấu này thì bản thân cô tạm thời chưa cần đến, nhưng sau này khi Pullman ra ngoài, cậu ấy sẽ rất cần nó.</p><p id="22">Nhưng thuốc lại rất dễ bị hỏng trong quá trình mang theo. Nghĩ đến điều đó, cô bước vào nhà bếp, mở một cánh tủ phía dưới và bê ra một cái hũ nhỏ.</p><p id="23">Cô mở lớp bùn niêm phong, rồi rót từ trong hũ ra một bát chất lỏng sền sệt màu vàng nhạt trong suốt. Ánh nắng từ ngoài cửa sổ chiếu rọi vào, khiến thứ chất lỏng màu vàng nhạt ấy càng thêm lung linh trong vắt, tỏa ra hương thơm ngọt ngào thoang thoảng.</p><p id="24">Trong hũ là siro phong do Lorraine thu thập. Đường phong không ngọt gắt đến mức phát ngấy như đường cát hay mật ong, nên hương vị này hợp ý cô hơn, mà còn rất giàu dinh dưỡng.</p><p id="25">Thỉnh thoảng cô cũng dùng nó để nấu ăn, hoặc pha trực tiếp với nước nóng để uống, bởi lẽ con người vốn dĩ sinh ra đã hảo ngọt. Ở kiếp trước, bất kể là trà sữa hay nước khoái lạc, vị ngọt đều là thứ không thể thiếu.[note84261]</p><p id="26">Trở lại phòng thí nghiệm, Lorraine cẩn thận trộn thuốc với siro phong, sau đó đun nóng nhẹ để làm bay hơi bớt lượng nước thừa, tạo thành một hỗn hợp sệt dạng keo bán trong suốt. Cô lấy khối keo dẻo như thạch ấy ra, đợi nguội đi một chút rồi nặn thành từng viên vuông nhỏ.</p><p id="27">Trên chiếc đĩa trắng tinh là mười khối vuông nhỏ trong suốt màu đỏ sẫm. Để tránh sau này chúng bị dính vào nhau, cô lại rắc thêm chút bột mì bao bọc bên ngoài, và thế là mười phần thuốc đã biến thành mười viên kẹo dẻo màu đỏ.</p><p id="28"><em>Cuối cùng cũng xong rồi!</em></p><p id="29">Cô khẽ vỗ tay, đặt những viên kẹo dẻo vào một chiếc hộp gỗ nhỏ để tránh bị đè bẹp, rồi mang chúng ra ngoài.</p><p id="30">Lorraine trở về phòng lấy thêm ba món đồ, rồi rời khỏi rừng phong, đi đến chỗ Pullman đang nghỉ ngơi.</p><p id="31">Lúc này trời đã chập choạng hoàng hôn. Pullman đang vận động tay chân, kiểm tra xem các vết thương đã lành đến đâu. Bên cạnh đống lửa trại là vài con cá đang được nướng, mùi thơm ngào ngạt lan tỏa khắp không gian.</p><p id="32">“Đã đỡ hơn chút nào chưa?”</p><p id="33">“Ổn rồi ạ, không còn vấn đề gì nghiêm trọng nữa.”</p><p id="34"><em>Không hổ là một thiếu niên sở hữu thiên phú Kiên Nghị, khả năng chịu đòn đúng là không tệ.</em></p><p id="35">“Ngày mai em sẽ lên đường sao?”</p><p id="36">“Vâng, em đã quyết định rồi.”</p><p id="37">“Được rồi, cũng đã đến lúc nói lời tạm biệt.”</p><p id="38">“Viên đá lúc trước, ta đã dùng để điều chế thành thuốc rồi.”</p><p id="39">Lorraine lấy hộp kẹo dẻo ra và đưa cho Pullman.</p><p id="40">“Sau này nếu bị thương, em có thể sử dụng nó. Nhưng chỉ có mười viên thôi, nên phải dùng tiết kiệm đấy.”</p><p id="41">“Cảm ơn cô.”</p><p id="42">Cậu thiếu niên vui vẻ nhận lấy, rồi Lorraine kéo từ phía sau ra một chiếc rương gỗ phong.</p><p id="43">“Cuối cùng, ta tặng cho em ba thứ này. Tuy chỉ là vật chất, nhưng chúng cũng đại diện cho ba lời khuyên mà ta muốn gửi gắm đến em.”</p><p id="44">“Trước hết là sức mạnh.”</p><p id="45">Cô mở tầng thứ nhất của chiếc rương, bên trong là một bó lúa mì được xếp ngay ngắn, chính là giống lúa mì đã được cải tiến.</p><p id="46">Ánh mắt Pullman hiện lên vẻ nghi hoặc.</p><p id="47">Lorraine nhặt bó lúa mì lên và bắt đầu giải thích.</p><p id="48">“Lương thực, cái ăn là điều quan trọng nhất. Em nuôi sống được bao nhiêu người sẽ định đoạt việc em nắm trong tay bao nhiêu quân đội, bao nhiêu nhân lực, và gây dựng được cơ nghiệp lớn đến nhường nào.”</p><p id="49">“Con người chính là sức mạnh.”</p><p id="50">Cậu thiếu niên dường như đã hiểu ra điều gì đó, liền khẽ gật đầu.</p><p id="51">“Tiếp theo là trí tuệ.”</p><p id="52">Cô mở tầng thứ hai của chiếc rương, bên trong là một chồng sách được xếp ngay ngắn.</p><p id="53">“Đừng bao giờ ngừng tư duy. Hãy liên tục nhìn lại, tổng kết kinh nghiệm và bài học, không ngừng học hỏi những kiến thức cần thiết, dùng đầu óc để giải quyết vấn đề. Nếu sau này em có lãnh địa của riêng mình, nhất định phải phổ cập giáo dục. Ban đầu hiệu quả sẽ chậm, nhưng đó là phương pháp có thể thay đổi tất cả từ gốc rễ.”</p><p id="54">Cậu thiếu niên vô cùng tán đồng. Qua quãng thời gian học hỏi vừa rồi, cậu mới ngộ ra những suy nghĩ trước kia của mình ấu trĩ và nực cười đến nhường nào.</p><p id="55">“Cuối cùng là may mắn.”</p><p id="56">Cô mở tầng cuối cùng của chiếc rương, bên trong là một quả trái cây màu cam trong suốt.</p><p id="57">“Luôn có người nói rằng họ thành công là nhờ may mắn, nhưng điều đó thật sự chỉ là ngẫu nhiên sao?”</p><p id="58">“Tại sao có người luôn gặp may, còn có người lại luôn xui xẻo? Điều đó thật sự chỉ là ngẫu nhiên sao?”</p><p id="59">“Không phải như vậy. Cho dù cùng một cơ hội đặt ngay trước mắt, vẫn có người không nắm bắt được. Khi thủy triều dâng lên thì không nhìn ra, nhưng một khi nước rút, sự thật sẽ hiện rõ.”</p><p id="60">“Đừng bao giờ ôm tâm lý may rủi. Nó chỉ biến em thành một kẻ đánh bạc mà thôi.”</p><p id="61">“Ta cho rằng vận may chính là phép màu được tạo nên từ hàng vạn lần nỗ lực và thử nghiệm không ngừng, kiên trì cho đến tận khi chạm tay vào thành công.”</p><p id="62">“Nếu trong một bể nước có 99 viên đá đen và 1 viên đá trắng, em mò 99 lần đều là đá đen, mãi đến lần cuối cùng mới chạm được viên đá trắng. Nhưng chỉ cần em giơ viên đá trắng ấy lên, mọi người sẽ lập tức cho rằng em là kẻ may mắn, là kẻ được số mệnh chọn trúng.”</p><p id="63">“Vì sao? Bởi vì người ta sẽ chẳng để ý đến những thất bại trước đó của em, những thứ tầm thường chẳng khác gì bao người khác. Họ chỉ nhìn thấy cảnh em thò tay vào bể nước, rút ra một viên đá trắng rồi reo lên rằng đó đúng là một kỳ tích.”</p><p id="64">“Bởi vì đại đa số người chỉ cần thử hai lần không trúng là bỏ cuộc rời đi. Chỉ có mình em là thành công. Dù trước đó em có chật vật hay thê thảm đến mức nào, người ta cũng sẽ tô vẽ nó lên và nói rằng đó là sự kiên trì của một anh hùng.”</p><p id="65">“Cái gọi là vận may không phải là ngẫu nhiên, mà là điều tất yếu sau hàng trăm ngàn lần cố gắng không ngừng. Ta hy vọng em có thể hiểu được điều này.”</p>

                    <p style="display: none">Hãy bình luận để ủng hộ người đăng nhé!</p>
                    
                    <!-- <div class="flex justify-center mt-10 mb-7 space-x-3">
                        <a
                            href="https://hako.vn/discord"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #7289da; text-decoration: initial; color: white !important;">
                            <svg
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                xmlns="http://www.w3.org/2000/svg"
                                fill-rule="evenodd"
                                clip-rule="evenodd"
                                viewbox="0 0 24 24">
                                <path
                                d="M19.54 0c1.356 0 2.46 1.104 2.46 2.472v21.528l-2.58-2.28-1.452-1.344-1.536-1.428.636 2.22h-13.608c-1.356 0-2.46-1.104-2.46-2.472v-16.224c0-1.368 1.104-2.472 2.46-2.472h16.08zm-4.632 15.672c2.652-.084 3.672-1.824 3.672-1.824 0-3.864-1.728-6.996-1.728-6.996-1.728-1.296-3.372-1.26-3.372-1.26l-.168.192c2.04.624 2.988 1.524 2.988 1.524-1.248-.684-2.472-1.02-3.612-1.152-.864-.096-1.692-.072-2.424.024l-.204.024c-.42.036-1.44.192-2.724.756-.444.204-.708.348-.708.348s.996-.948 3.156-1.572l-.12-.144s-1.644-.036-3.372 1.26c0 0-1.728 3.132-1.728 6.996 0 0 1.008 1.74 3.66 1.824 0 0 .444-.54.804-.996-1.524-.456-2.1-1.416-2.1-1.416l.336.204.048.036.047.027.014.006.047.027c.3.168.6.3.876.408.492.192 1.08.384 1.764.516.9.168 1.956.228 3.108.012.564-.096 1.14-.264 1.74-.516.42-.156.888-.384 1.38-.708 0 0-.6.984-2.172 1.428.36.456.792.972.792.972zm-5.58-5.604c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332.012-.732-.54-1.332-1.224-1.332zm4.38 0c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332 0-.732-.54-1.332-1.224-1.332z" />
                            </svg>
                            Discord
                        </a>
                        <a
                            href="https://fb.com/hako.page"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #1877f2; text-decoration: initial; color: white !important;">
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                viewBox="0 0 24 24">
                                <path
                                d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z" />
                            </svg>
                            Facebook
                        </a>
                    </div> -->

                                        <a href="/truyen/12377" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/12377/f162c340-e615-453e-96f2-ea60f39f3592.jpg?t=1756572253" class="d-none d-md-block" style="width: 970px; height: auto">
                    </a>
                    <a href="/truyen/12377" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/12377/7b4a9212-81a5-436f-bb19-1f0ea545eb5c.jpg?t=1756572253" class="d-md-none" style="width: 100%; height: auto">
                    </a>
                    
                                        <div class="note-reg">
                        <h2 align="center" style="margin-bottom: 40px;">Ghi chú</h2>
                                                    <div style="margin-bottom: 20px;" id="note84261"><a href="#anchor-note84261" class="none-print inline" style="margin-right: 10px"><i class="fas fa-caret-up"></i></a><a href="#anchor-note84261" class="inline-print none">[Lên trên] </a><div style="display: none"><span class="note-content long-text">Ám chỉ Coca-Cola hoặc các loại nước ngọt có gas nói chung. Gọi là "nước khoái lạc" vì uống vào thấy sướng mồm, vui vẻ chứ không phải thứ nước mà mấy người đang nghĩ đến đâu =)))</span></div><span class="note-content_real long-text">Ám chỉ Coca-Cola hoặc các loại nước ngọt có gas nói chung. Gọi là "nước khoái lạc" vì uống vào thấy sướng mồm, vui vẻ chứ không phải thứ nước mà mấy người đang nghĩ đến đâu =)))</span></div>
                                            </div>
                                    </div>

                <div style="text-align: center; margin: 20px auto 10px auto;">
                                                        </div>
                
                <section class="rd-basic_icon row">
                    <a href="/truyen/23638-ta-dau-phai-phu-thuy/c263547-chuong-13-doi-huyet-long" class="dark:text-black col text-center "><i class="fas fa-backward"></i></a>
                    <a href="/truyen/23638-ta-dau-phai-phu-thuy" class="dark:text-black col text-center"><i class="fas fa-home"></i></a>
                    <a href="/truyen/23638-ta-dau-phai-phu-thuy/c267766-chuong-15-tam-biet" class="dark:text-black col text-center "><i class="fas fa-forward"></i></a>
                </section>
                
                <!--the code style is important to keep this comment section be out of the effect of user reading's setting-->
            </div>
            <div class="col-12 col-lg-10 offset-lg-1" aria-hidden="true">
                <section id="chapter-comments" class="basic-section dark:bg-[#1f1f1f] dark:text-white dark:border dark:border-[#1f1f1f]">
                    <header class="sect-header tab-list dark:bg-[#2a2a2a] dark:border-[#2a2a2a]"> 
                        <span class="sect-title tab-title" data-tab-index="1">Bình luận <span class="comments-count">(2)</span></span>
                    </header>
                    <main id="fbcmt_root" class="sect-body">
                        <span style="padding: 10px; display: inline-block;">Báo cáo bình luận không phù hợp ở <a href="/thao-luan/619-bao-cao-binh-luan" style="color: blue">đây</a></span>
                        <div id="tab-content-1" class="tab-content clear">
                            <section class="ln-comment">
    <header>
        <h3 class="text-lg font-bold dark:text-white">2 Bình luận </h3>
        <!-- <i id="refresh_comment" class="fas fa-refresh" aria-hidden="true" style="margin-left: 10px; font-size: 18px"></i></h3> -->
            </header>

    <main class="ln-comment-body">
                    <div class="ln-comment_sign-in long-text">
                Bạn phải <a href="/login">đăng nhập</a> hoặc <a href="/register">tạo tài khoản</a> để bình luận.
            </div>
                
        
        
        <div class="ln-comment-group">
    <div id="ln-comment-3104034"
    class="ln-comment-item mt-3 clear"
    data-comment="3104034" 
    data-parent="3104034" 
    data-type="chapter" 
    data-typeid="264941">
    <div class="flex gap-1 max-w-full">
        <div class="w-[50px]">
            <div class="mx-1 my-1">
                <img src="https://i.docln.net/lightnovel/users/ua124712-7efe19cc-2c2e-47ca-9685-39c8984c5727.jpg" class="w-full rounded-full" />
            </div>
        </div>
        <div
            class="w-full min-w-0 rounded-md bg-gray-100 ps-1 pe-0 pb-1 pt-0 dark:!bg-zinc-800 ">
            <div class="flex min-w-0 flex-col px-2">
                <div class="flex align-top justify-between">
                    <div class="flex flex-wrap gap-x-2 gap-y-1 align-middle pt-1">
    <div class="self-center">
        <a class="font-bold leading-6 md:leading-7 ln-username " href="/thanh-vien/124712">Lumy</a>
    </div>
                                    </div>
                                        
                </div>
                                                    <div class="ln-comment-content long-text">
                        Tôi cần 1 ly "nước khoái lạc" 🐧
                    </div>
                    <div class="comment_see_more expand none">Xem thêm</div>
                    <div class="flex gap-2 align-bottom text-[13px] visible-toolkit">
                        <a href="/truyen/23638-ta-dau-phai-phu-thuy/c264941-chuong-14-ba-mon-qua?comment_id=3104034#ln-comment-3104034"
                            class="text-slate-500">
                            <time class="timeago" title="27-11-2025 01:40:13"
                                datetime="2025-11-27T01:40:13+07:00">
                                27-11-2025 01:40:13
                            </time>
                        </a>
                        <a
                            class="self-center visible-toolkit-item do-like cursor-pointer">
                            <i class="fas fa-thumbs-up me-1"></i>
                            <span class="likecount font-semibold">1</span>
                        </a>
                                            </div>
                            </div>
        </div>
    </div>
</div>

        <div class="ln-comment-reply">
            <div id="ln-comment-3140924"
    class="ln-comment-item mt-3 clear"
    data-comment="3140924" 
    data-parent="3104034" 
    data-type="chapter" 
    data-typeid="264941">
    <div class="flex gap-1 max-w-full">
        <div class="w-[50px]">
            <div class="mx-1 my-1">
                <img src="https://i.docln.net/lightnovel/users/ua69139-c482fd98-f4f6-4659-89c6-62a108fb2580.jpg" class="w-full rounded-full" />
            </div>
        </div>
        <div
            class="w-full min-w-0 rounded-md bg-gray-100 ps-1 pe-0 pb-1 pt-0 dark:!bg-zinc-800 ">
            <div class="flex min-w-0 flex-col px-2">
                <div class="flex align-top justify-between">
                    <div class="flex flex-wrap gap-x-2 gap-y-1 align-middle pt-1">
    <div class="self-center">
        <a class="font-bold leading-6 md:leading-7 ln-username " href="/thanh-vien/69139">anoy</a>
    </div>
                                    </div>
                                        
                </div>
                                                    <div class="ln-comment-content long-text">
                        sếch quá ô
                    </div>
                    <div class="comment_see_more expand none">Xem thêm</div>
                    <div class="flex gap-2 align-bottom text-[13px] visible-toolkit">
                        <a href="/truyen/23638-ta-dau-phai-phu-thuy/c264941-chuong-14-ba-mon-qua?comment_id=3104034&amp;reply_id=3140924#ln-comment-3140924"
                            class="text-slate-500">
                            <time class="timeago" title="28-12-2025 02:40:16"
                                datetime="2025-12-28T02:40:16+07:00">
                                28-12-2025 02:40:16
                            </time>
                        </a>
                        <a
                            class="self-center visible-toolkit-item do-like cursor-pointer">
                            <i class="fas fa-thumbs-up me-1"></i>
                            <span class="likecount font-semibold">1</span>
                        </a>
                                            </div>
                            </div>
        </div>
    </div>
</div>
    
                
    </div>
    </div>

<div class="ln-comment-page">
</div>    </main>

    <script>
        var token = 'BNjsgvQtJlvyPKTjwaFmuKjT4vfWowigb6Jgu6dp';
        var comment_type = 'chapter';
        var comment_typeid = '264941';
    </script>

    </section>


                        </div>
                    </main>
                </section>
            </div> 
        </div>
    </div>
</main>

<script>
    token = 'BNjsgvQtJlvyPKTjwaFmuKjT4vfWowigb6Jgu6dp';
        
    function turnoffall() {
        $(".rdtoggle").removeClass("on");
        $(".rdtoggle_body").removeClass("animation fade-in-left-big fade-in-down");
        $("html").removeClass("overflow-hiden");
    }
    
    function rdtoggle(classicon, effect) {
        if ($(classicon).hasClass("on")) {
            turnoffall();
        } else {
            turnoffall();
            $(classicon).addClass("on");
            $("html").addClass("overflow-hiden");
            $(classicon + " .rdtoggle_body").addClass("animation " + effect);
        } 
    };
    
    $("#rd-setting_icon").on('click', function() {
        rdtoggle("#setting", "fade-in-down");                   
    });

    $("#rd-tts_icon").on('click', function() {
        rdtoggle("#tts-panel", "fade-in-down");
    });
        
    $("#rd-info_icon").on('click', function() {
        rdtoggle("#chapters", "fade-in-left-big");              
    });
        
    $("#rd-bookmark_icon").on('click', function() {
        rdtoggle("#bookmarks", "fade-in-left-big");                     
    });
        
    $(".black-click").on('click', function() {
        turnoffall();
        $("#rd-side_icon").hide();
        $("#bookmark_top").removeClass("on");
    });
        
    var bgcolor    = Cookies.get('color') || (Cookies.get('night_mode') ? 6 : 4);
    var fontfamily = Cookies.get('fontfamily') || '';
    var fontsize   = Cookies.get('font') || 18; 
    var margin     = Cookies.get('margin') || 0;
    var textAlign  = Cookies.get('textAlign') || 'text-justify';
        
    function setcolor(alter = true) {
        var switcher = $(".set-color .set-input span").eq(bgcolor);
        switcher.addClass("current");

        if (alter) {
            for (var i = 0; i < $(".set-color .set-input span").length; i++) {
                $("#mainpart").removeClass('style-' + i);
                $("#mainpart").removeClass('dark');
            }
            $("#mainpart").addClass('style-' + bgcolor);

            // Manually hardcoded to dark
            if (bgcolor >= 6) {
                $("#mainpart").addClass('dark');
            }
        }
    }

    // This creates unsmooth experience so we only use it for select box
    function setfontfamily() {
        $('.set-font-family select option').filter(function () {
            return fontfamily.split(',')[0].indexOf($(this).text()) != -1 ;
        }).attr('selected', true);
    }
        
    function setfontstyle(alter = true) {
        $(".set-font input.set-slide_input").val(fontsize + "px"); 

        if (alter) {
            $("div#chapter-content").css("font-size", fontsize + "px");

            var lineheight = +fontsize + 10;
            $("#chapter-content").css("line-height", lineheight + "px");
        }
    }
        
    function setmargin() {
        $(".set-margin input.set-slide_input").val(margin + "px"); 
        $("#chapter-content").css({
            'padding-left': margin + "px",
            'padding-right': margin + "px"
        });
    }

    function setTextAlign(alter = true) {
        var switcher = $(".set-text-align .set-input span[data-align='" + textAlign + "']");
        switcher.addClass("current");

        if (alter) {
            $(".set-text-align .set-input span").each(function () {
                $("#chapter-content").removeClass($(this).attr('data-align'));
            });

            $("#chapter-content").addClass(textAlign);
        }
    }
    
    setcolor(false);
    setfontfamily();
    setfontstyle(false);
    setmargin();
    setTextAlign(true);
    
    //1px = 0.0625rem;
    //16px = 1rem (default);
    
    $(".set-color .set-input span").click(function(){
        bgcolor = $(this).data("id");
        $(".set-color .set-input span").removeClass("current");
        setcolor();            
        Cookies.set('color', bgcolor, { expires: 365 });
    });

    $('.set-font-family select').on('change', function () {
        fontfamily = "'" + $('option:selected', this).text() + "', " + '\'Times New Roman\', Georgia, serif';
        
        $('div#chapter-content').css('font-family', fontfamily);

        Cookies.set('fontfamily', fontfamily, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-smaller").click(function () {
        fontsize = fontsize - 2;
        if (fontsize < 0) fontsize = 0;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-bigger").click(function () {
        fontsize = +fontsize + 2;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-smaller").click(function () {
        margin = margin - 20;
        if (margin < 0) margin = 0;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-bigger").click(function () {
        margin = +margin + 20;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    }); 

    $(".set-text-align .set-input span").click(function(){
        textAlign = $(this).data("align");
        $(".set-text-align .set-input span").removeClass("current");
        setTextAlign();        
        Cookies.set('textAlign', textAlign, { expires: 365 });
    });
        
    $("#bookmarks_list li").each(function(){
        var linepr = $(this).data("line");
        var preview = $(".reading-content p#" + linepr).text();

        var shortText = preview.trim().substring(0, 30) + "...";
        $(this).find(".pos_bookmark small").text(shortText);
    });

    $('div#chapter-content').html(
        $('div#chapter-content').html().replace(
            /\[note(\d+)\]/gi, 
            '<span id="anchor-note$1" class="note-icon none-print inline note-tooltip" data-tooltip-content="#note$1 .note-content" data-note-id="note$1"><i class="fas fa-sticky-note"></i></span><a id="anchor-note$1" class="inline-print none" href="#note$1">[note]</a>'
        )
    )
    
    tippy('.note-tooltip', {
        delay: 50,
        maxWidth: 240,
        interactive: true,
        content(ref) {
            const selector = ref.getAttribute('data-tooltip-content');
            const template = document.querySelector(selector);
            return template ? template.innerHTML : 'Đặt sai ID của note';
        }
    });
        
    isLoggedIn = 0;
    series_id = parseInt('23638');
    chapter_id = parseInt('264941');

    readingObject = {
        series_id: series_id,
        series_title: 'Ta Đâu Phải Phù Thủy',
        series_url: $('i.fa-home').first().parent().attr('href'),
        series_cover: $('.rd_sidebar-header a.img').css('background-image'),
        chapter_title: $('ul.sub-chap_list li.current a').text().trim(),
        chapter_url: $('ul.sub-chap_list li.current a').attr('href'),
        book_title: $('ul#chap_list > li.current a').text(),
        book_url: $('ul#chap_list > li.current a').attr('href'),
        read_time: +new Date() / 1000 | 0,
    };

// TTS Manager - Enhanced Web Speech API (Vietnamese). Chunked queue for long texts, no delays/interrupts.
const synth = window.speechSynthesis;
let voices = [];
let voicesLoaded = false;
let ttsRate = parseFloat(localStorage.getItem('tts-rate')) || 1;
let ttsPitch = parseFloat(localStorage.getItem('tts-pitch')) || 1;
let ttsState = 'idle'; // idle, speaking, paused, loading
let currentChunk = 0;
let totalChunks = 0;
let processingIndex = 0;
let paragraphs = [];
const BUFFER_SIZE = 5;

// --- Background Persistence (Wake Lock + Silent Audio) ---
let wakeLock = null;
const silentAudio = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTSVNFAAAAPAAADEVuY29kZWQgd2l0aCBMYW1lMy4xMDBhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUA==');
silentAudio.loop = true;

async function enableConnection() {
    // 1. Start Silent Audio Loop (tricks browser into thinking we are a music player)
    try {
        await silentAudio.play();
    } catch (err) {
        console.warn('Silent Audio Play Failed (likely no interaction):', err);
    }

    // 2. Request Screen Wake Lock (prevents screen from sleeping automatically)
    if ('wakeLock' in navigator) {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (err) {
            console.warn('Wake Lock Request Failed:', err);
        }
    }
}

function disableConnection() {
    // 1. Stop Silent Audio
    try {
        silentAudio.pause();
        silentAudio.currentTime = 0;
    } catch (e) {}

    // 2. Release Wake Lock
    if (wakeLock) {
        try {
            wakeLock.release();
            wakeLock = null;
        } catch (e) {}
    }
}

// Re-acquire Wake Lock if visibility changes and we are speaking
document.addEventListener('visibilitychange', async () => {
    if (wakeLock !== null && document.visibilityState === 'visible' && ttsState === 'speaking') {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (e) {}
    }
});
// ---------------------------------------------------------

let ttsVoiceIdx = localStorage.getItem('tts-voice') || '0';

function populateVoices() {
    voices = synth.getVoices().filter(v => v.lang.startsWith('vi'));
    voicesLoaded = true;
    let $select = $('#tts-voice-select');
    $select.empty();

    if (voices.length === 0) {
        $select.append('<option value="-1">Không có giọng Việt (cài Chrome/Edge)</option>');
        return;
    }

    voices.forEach((voice, idx) => {
        $select.append(`<option value="${idx}">${voice.name} (${voice.lang}) ${voice.default ? '(mặc định)' : ''}</option>`);
    });

    let idx = Math.max(0, Math.min(parseInt(ttsVoiceIdx), voices.length - 1));
    $select.val(idx);
}

function updateTTSUI(progress = '') {
    let $icon = $('#rd-tts_icon i');
    $icon.removeClass('fa-volume-up fa-volume-mute fa-spinner fa-spin');
    let $playBtn = $('#tts-play-btn'), $pauseBtn = $('#tts-pause-btn'), $stopBtn = $('#tts-stop-btn');
    $playBtn.prop('disabled', ttsState === 'speaking' || ttsState === 'loading'); // Enable on idle/paused
    $pauseBtn.prop('disabled', ttsState === 'idle');
    $stopBtn.prop('disabled', ttsState === 'idle');
    // Always remove old progress
    $('#tts-progress').remove();

    if (progress && totalChunks > 0) {
        $playBtn.after(`<span id="tts-progress" class="text-xs block text-center mt-1">${progress}</span>`);
    }

    if (ttsState === 'idle') {
        // Check resume preview
        const resumeData = loadResumeState();
        let currentParagraphs = $('#chapter-content p').map(function() {
            return $(this).text().trim();
        }).get().filter(p => p.trim().length > 0);

        if (resumeData && resumeData.total === currentParagraphs.length) {
            $playBtn.text(`Tiếp tục (${resumeData.index + 1}/${resumeData.total})`);
        } else {
            $playBtn.text('Phát');
        }

        $icon.addClass('fa-volume-up');
    } else if (ttsState === 'speaking' || ttsState === 'loading') {
        $icon.addClass('fa-volume-up fa-spinner fa-spin');
    } else if (ttsState === 'paused') {
        $icon.addClass('fa-volume-mute');
    }
}

$('#tts-play-btn').off('click').on('click', function() {
    // Always restart/resume from storage
    enableConnection(); // Start keep-alive
    synth.cancel();
    ttsState = 'idle';
    // queuedUtterances = []; // Removed global queue
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();

    if (!voicesLoaded || voices.length === 0) {
        ttsState = 'loading';
        updateTTSUI();
        setTimeout(() => {
            if (!voicesLoaded) {
                alert('Giọng nói chưa tải. Thử lại.');
                ttsState = 'idle';
                updateTTSUI();
                return;
            }
            playTTS();
        }, 500);
        return;
    }

    playTTS();
});

function createUtterance(item) {
    let u = new SpeechSynthesisUtterance(item.text);
    u.lang = 'vi-VN';
    u.rate = parseFloat($('#tts-rate').val()) || 1;
    u.pitch = parseFloat($('#tts-pitch').val()) || 1;
    let voiceIdx = parseInt($('#tts-voice-select').val());

    if (voiceIdx >= 0 && voices[voiceIdx]) {
        u.voice = voices[voiceIdx];
    }

    u.onstart = () => {
        currentChunk++;
        saveResumeState();
        updateTTSUI(`${currentChunk}/${totalChunks}`);
        
        // Highlight logic
        $('.current-reading').removeClass('current-reading');
        if (item.el) {
            $(item.el).addClass('current-reading');
            item.el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        feedQueue(); // Ensure buffer is maintained
    };
    u.onerror = (event) => {
        console.error('TTS Error:', event.error, event);

        if (event.error !== 'interrupted') {
             // alert(`Lỗi TTS: ${event.error}. Bỏ qua đoạn.`);
             console.warn('TTS Error skipping chunk', event.error);
        }

        saveResumeState(); // Save on error
        feedQueue();
    };
    u.onend = () => {
        saveResumeState();

        if (currentChunk >= totalChunks) {
            clearResumeState();
            $('.current-reading').removeClass('current-reading'); // Cleanup
            
            // Auto-Next Logic
            let $nextBtn = $('.rd-basic_icon a').last();
            if ($nextBtn.length && !$nextBtn.hasClass('disabled')) {
                localStorage.setItem('tts-autoplay', 'true');
                window.location.href = $nextBtn.attr('href');
                return;
            }

            ttsState = 'idle';
            disableConnection(); // Cleanup
            currentChunk = 0;
            totalChunks = 0;
            processingIndex = 0;
            updateTTSUI();
        } else {
            feedQueue();
        }
    };
    u.onpause = () => { saveResumeState(); };
    return u;
}

function getStorageData() {
    try {
        return JSON.parse(localStorage.getItem('tts-resume-data')) || {};
    } catch {
        return {};
    }
}

function setStorageData(data) {
    localStorage.setItem('tts-resume-data', JSON.stringify(data));
}

function saveResumeState() {
    if (totalChunks > 0) {
        const data = getStorageData();
        data[chapter_id] = {
            index: currentChunk,
            total: totalChunks,
            timestamp: Date.now()
        };
        // Optional: Clean up old entries (older than 7 days?) to prevent infinite growth, 
        // but for now we just save.
        setStorageData(data);
    }
}

function clearResumeState() {
    const data = getStorageData();

    if (data[chapter_id]) {
        delete data[chapter_id];
        setStorageData(data);
    }
}

function loadResumeState() {
    const data = getStorageData();
    const saved = data[chapter_id];
    
    if (!saved) return null;
    
    if (Date.now() - saved.timestamp > 3600000 * 24 * 7) { // 7 days
        clearResumeState();
        return null;
    }

    return saved;
}

function initTTS() {
    populateVoices();
    $('#tts-rate').val(ttsRate);
    $('#tts-rate-value').text(ttsRate);
    $('#tts-pitch').val(ttsPitch);
    $('#tts-pitch-value').text(ttsPitch);
    updateTTSUI();
    
    if (localStorage.getItem('tts-autoplay') === 'true') {
        localStorage.removeItem('tts-autoplay');
        $(window).on('load', function() {
             setTimeout(() => {
                 $('#tts-play-btn').click(); 
             }, 500); 
        });
    }
}

function getParagraphs() {
    return $('#chapter-content p').map(function() {
        const text = $(this).text().trim();
        if (text.length > 0) {
            return { text: text, el: this };
        }
    }).get();
}

function feedQueue() {
    if (ttsState !== 'speaking') return;
    
    // Maintain buffer
    while (processingIndex < totalChunks && processingIndex < currentChunk + BUFFER_SIZE) {
        let u = createUtterance(paragraphs[processingIndex]);
        synth.speak(u);
        processingIndex++;
    }
}

function playTTS() {
    paragraphs = getParagraphs();
    if (paragraphs.length === 0) {
        alert('Không có nội dung để đọc.');
        ttsState = 'idle';
        disableConnection(); // Cleanup
        updateTTSUI();
        return;
    }
    
    const resumeData = loadResumeState();
    if (resumeData && resumeData.total === paragraphs.length) {
        currentChunk = resumeData.index;
        totalChunks = resumeData.total;
        // processingIndex needs to match what we are about to play
        // Current chunk is what finished, so we start processing from currentChunk?
        // Wait, currentChunk is "index of just finished" in some contexts?
        // No, in loadResume, index is currentChunk.
        // If saved index is 5. means 0..4 played.
        // We start playing from 5 (index).
        // So processingIndex = currentChunk.
        processingIndex = currentChunk;
    } else {
        clearResumeState();
        currentChunk = 0;
        totalChunks = paragraphs.length;
        processingIndex = 0;
    }
    
    synth.cancel();
    ttsState = 'speaking';
    
    feedQueue();
    updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
}

$('#tts-rate').on('input', function() {
    $('#tts-rate-value').text(this.value);
    localStorage.setItem('tts-rate', this.value);
});

$('#tts-pitch').on('input', function() {
    $('#tts-pitch-value').text(this.value);
    localStorage.setItem('tts-pitch', this.value);
});

$('#tts-voice-select').on('change', function() {
    localStorage.setItem('tts-voice', this.value);
});

$('#tts-pause-btn').off('click').on('click', function() {
    if (ttsState === 'speaking') {
        synth.pause();
        ttsState = 'paused';
        disableConnection(); // Pause keep-alive
        updateTTSUI();
        saveResumeState();
    } else if (ttsState === 'paused') {
        enableConnection(); // Resume keep-alive
        synth.resume();
        ttsState = 'speaking';
        updateTTSUI();
    }
});

$('#tts-stop-btn').off('click').on('click', function() {
    synth.cancel();
    // clearResumeState(); // Stop doesn't necessarily clear resume, usually just pause? 
    // But UI says "Stop". Let's clear resume state to consistent with old behavior 
    // or maybe optional? Old behavior cleared it.
    clearResumeState();
    
    disableConnection(); // Stop keep-alive
    $('.current-reading').removeClass('current-reading'); // Cleanup
    ttsState = 'idle';
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();
});

// Visibility handler removed - TTS continues on tab switch

synth.onvoiceschanged = populateVoices;
initTTS();
</script>



    
    <script src="/scripts/service-manager.js?r=4"></script>

    <script src="/scripts/app.js?id=a5a24eca66adcfc75cc0b2f62e2611db"></script>
    <script src="https://docln.net/vendor/livewire/livewire.min.js?id=df3a17f2"   data-csrf="BNjsgvQtJlvyPKTjwaFmuKjT4vfWowigb6Jgu6dp" data-update-uri="/livewire/update" data-navigate-once="true"></script>

    
    <script src="https://confidecross.com/d5/6b/4b/d56b4bd6c3d2c1e161c4ab3c78c27670.js" async></script>

        
            <footer id="footer">
    <div class="container">
        <!--<span><a href="">Hako.re</a></span>-->
        <span class="right">Liên hệ: <a href="mailto:contact@hako.vn" target="_blank" style="color: #5fff46">contact@hako.vn</a></span>

        <span>© 2016 - 2026 Cổng Light Novel - Đọc Light Novel</span>
    </div>
</footer>    
    <div x-data x-show="$store.toast.on" @click="$store.toast.hide()" class="bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fixed w-3/4 md:w-1/2 z-20 inset-x-0 bottom-10 mx-auto" role="alert" style="display: none">
    <div class="flex">
        <div class="py-1"><svg class="fill-current h-6 w-6 text-teal-500 mr-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"/></svg></div>
        <div>
            <p class="font-bold capitalize">Chú ý</p>
            <p class="text-sm" x-text="$store.toast.message"></p>
        </div>
    </div>
</div></body>
</html>
