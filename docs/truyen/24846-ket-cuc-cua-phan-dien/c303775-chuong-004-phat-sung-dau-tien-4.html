<!DOCTYPE html>
<html lang="vi" class="light">
<head>
    <meta charset="utf-8">
    
    <title>Đọc Kết cục của Phản diện - Chương 004 Phát súng đầu tiên (4) - Cổng Light Novel - Đọc Light Novel</title>

    <meta name="description" content="&quot;Cách đây vài ngày, tôi đã chạm đến kết cục. Chẳng có gì đao to búa lớn cả — tôi chỉ đặt khẩu súng vào thái dương rồi bóp cò. Ngay trước mặt vị hôn thê, ngay trong căn phòng có chị gái mình, và đôi khi là giữa quảng...">
    <meta name="theme-color" content="#000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="i9KkJtKQpYiDiuTWoUTcq3lG14NYntqdwQfyy1Hz">
    <meta name="logged-in" content="0">
    <meta property="fb:app_id" content="1864643850436909">

    <link rel="canonical" href="https://docln.net/truyen/24846-ket-cuc-cua-phan-dien/c303775-chuong-004-phat-sung-dau-tien-4">
    <meta property="og:image" content="https://i.hako.vn/ln/series/covers/s24846-4b75096a-828c-43fd-9b44-8482f5491631.jpg">


<style type="text/css">@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek/wght/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/devanagari/wght/normal.woff2);unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek-ext/wght/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek-ext/400/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek/400/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}</style>
    <link rel="preload" href="/fonts/OpenSans-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/fonts/OpenSans-SemiBold.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preconnect" href="https://www.google-analytics.com">

    <link rel="shortcut icon" href="/img/favicon.png?v=3">
    <link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon.png?v=3">
    <link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png?v=3">
    <link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png?v=3">

    <link rel="stylesheet" href="/css/interface.css?id=300c3109a58d319c9bb94c8585835c77">
    <link rel="stylesheet" href="/css/tailwind.css?id=1778859ff87d0737e2b75c38e2919ee9">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css" integrity="sha256-BtbhCIbtfeVWGsqxk1vOHEYXS6qcvQvLMZqjtpWUEx8=" crossorigin="anonymous" />
            
    
    <script src="/scripts/plugins.js?id=b612d946b32459430eed3066ed15adf2"></script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-34864968-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
      gtag('config', 'UA-34864968-3');
    </script>
</head>

<body>
	
    <div x-data="{ open: Cookies.get('globalwarning2') === undefined ? true : false }">
    <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4" x-show="open" style="display: none">
        <div class="flex">
            <div class="shrink-0">
                <button x-on:click="open = false; Cookies.set('globalwarning2', false, { expires: 0.5 })" type="button" class="inline-flex rounded-md bg-yellow-50 p-1.5 text-yellow-500 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-600 focus:ring-offset-2 focus:ring-offset-yellow-50">
                    <span class="sr-only">Dismiss</span>
                    <svg class="size-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
                    <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z" />
                    </svg>
                </button>
            </div>
            <div class="ml-3 font-bold">
                <p class="text-sm text-yellow-700">
                Nếu không thể <a class="font-medium text-blue-700" href="/thao-luan/2898-ten-mien-da-bi-chan">truy cập trang web</a> xin vui lòng sử dụng DNS 
                <a class="font-medium text-blue-700" href="https://www.google.com/search?q=c%C3%A1ch+c%C3%A0i+dns+1.1.1.1" target="_blank">1.1.1.1</a> hoặc <a class="font-medium text-blue-700" href="https://docln.sbs" target="_blank">docln.sbs</a>
                
                </p>
                <p>
                    <p class="text-sm text-orange-700">Hiện đang đứt cáp Internet APG, kết nối có thể chậm hoặc rất chậm. Dùng VPN không chắc có hiệu quả.</p>
                </p>
            </div>

        </div>
    </div>
</div>



	<style>
    body {
        background: inherit;
    }

    #footer {
        display: none;
    }
    
    .current-reading {
        background-color: rgba(189, 224, 254, 0.3);
        border-left: 5px solid #007bff;
        padding-left: 10px;
        transition: background-color 0.3s ease;
    }
</style>


<main id="mainpart" class="reading-page style-4">
    <section id="rd-side_icon" class="none force-block-l" aria-hidden="true">
                <a class="rd_sd-button_item rd_top-left" href="/truyen/24846-ket-cuc-cua-phan-dien/c299564-chuong-003-phat-sung-dau-tien-3"><i class="fas fa-backward"></i></a>
        
        <a class="rd_sd-button_item" href="/truyen/24846-ket-cuc-cua-phan-dien"><i class="fas fa-home"></i></a>     
        <a id="rd-setting_icon" data-affect="#" class="rd_sd-button_item"><i class="fas fa-font"></i></a>
        <a id="rd-tts_icon" class="rd_sd-button_item"><i class="fas fa-volume-up"></i></a>
        <a id="rd-info_icon" data-affect="#rd_sidebar.chapters" class="rd_sd-button_item"><i class="fas fa-info"></i></a>
        <a id="rd-bookmark_icon" data-affect="#rd_sidebar.bookmarks" class="rd_sd-button_item"><i class="fas fa-bookmark"></i></a>

        
         
        <a class="rd_sd-button_item rd_top-right disabled"><i class="fas fa-forward"></i></a>
            </section>    
    
    <section id="chapters" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <header class="rd_sidebar-header clear">
                <a class="img" href="/truyen/24846-ket-cuc-cua-phan-dien/c303775-chuong-004-phat-sung-dau-tien-4" style="background: url('https://i.hako.vn/ln/series/covers/s24846-4b75096a-828c-43fd-9b44-8482f5491631.jpg') no-repeat"></a> 
                <div class="rd_sidebar-name">                    
                    <h5><a href="/truyen/24846-ket-cuc-cua-phan-dien">Kết cục của Phản diện</a></h5>
                    <small><i class="fas fa-pen"></i>Eondeok-gungdengi</small>
                    <small><i class="fas fa-paint-brush"></i></small>                
                </div>
            </header>

            <ul id="chap_list" class="unstyled">
                                                            <li class="current"><a href="/truyen/24846-ket-cuc-cua-phan-dien/t36165-toan-van">Toàn văn</a></li>
                        <ul class="sub-chap_list unstyled">
                                                        <li >
                                <a href="/truyen/24846-ket-cuc-cua-phan-dien/c299556-chuong-001-phat-sung-dau-tien-1">
                                                                        Chương 001 Phát súng đầu tiên (1)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24846-ket-cuc-cua-phan-dien/c299558-chuong-002-phat-sung-dau-tien-2">
                                                                        Chương 002 Phát súng đầu tiên (2)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24846-ket-cuc-cua-phan-dien/c299564-chuong-003-phat-sung-dau-tien-3">
                                                                        Chương 003 Phát súng đầu tiên (3)
                                </a>
                            </li>
                                                        <li  class="current" >
                                <a href="/truyen/24846-ket-cuc-cua-phan-dien/c303775-chuong-004-phat-sung-dau-tien-4">
                                                                        Chương 004 Phát súng đầu tiên (4)
                                </a>
                            </li>
                                                    </ul>
                                        
                                        
            </ul>
        </main>
        <div class="black-click"></div>
    </section>
    
    <section id="bookmarks" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <div class="rd_sidebar-header">
                <h2 class="rd_s-name"><i class="fas fa-bookmark"></i><a href="/bookmark" style="color: white;"> Bookmarks</a></h2>
            </div>
            <ul id="bookmarks_list" class="unstyled">
                                            <li>Bạn phải đăng nhập để sử dụng bookmark</li>
                                        </ul>
        </main>
        <div class="black-click"></div>
    </section>

    <section id="setting" class="rdtoggle" aria-hidden="true">
        <section class="re_set-in basic-section clear rdtoggle_body">
        <header class="sect-header"><span class="sect-title">Tùy chỉnh</span></header>
            <main class="sect-body">
                <div class="set-list set-color clear">
                    <label class="font-bold">Màu nền</label>
                    <div class="set-input clear justify-center">
                        <span data-color="#ffffff" data-id="0" style="background-color: #ffffff"></span>
                        <span data-color="#e6f0e6" data-id="1" style="background-color: #e6f0e6"></span>
                        <span data-color="#e3f5fa" data-id="2" style="background-color: #e3f5fa"></span>
                        <span data-color="#f6f4ec" data-id="3" style="background-color: #f6f4ec"></span>
                        <span data-color="#eae4d3" data-id="4" style="background-color: #eae4d3"></span>
                        <span data-color="#f5e9ef" data-id="5" style="background-color: #f5e9ef"></span>
                        <span data-color="#222222" data-id="6" style="background-color: #222222"></span>
                        <span data-color="#000000" data-id="7" style="background-color: #000000"></span>
                    </div>
                </div>
                <div class="set-list set-font-family clear">
                    <label class="font-bold">Font chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <select>
                            <option>Times New Roman</option>
                            <option>Merriweather</option>
                            <option>Lora</option>
                            <option>Roboto</option>
                            <option>Noto Sans</option>
                            <option>Nunito</option>
                        </select>
                    </div>
                </div>
                <div class="set-list set-font clear">
                    <label class="font-bold">Kích cỡ chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="16px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-margin clear">
                    <label class="font-bold">Bản lề</label>
                    <div class="set-slide set-input justify-center">
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="20px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-text-align clear">
                    <label class="font-bold">Kiểu căn chỉnh</label>
                    <div class="set-input clear justify-center font-medium text-2xl flex flex-row gap-10">
                        <span data-align="text-left" class="p-1"><i class="fas fa-align-left"></i></span>
                        <span data-align="text-center" class="p-1"><i class="fas fa-align-center"></i></span>
                        <span data-align="text-right" class="p-1"><i class="fas fa-align-right"></i></span>
                        <span data-align="text-justify" class="p-1"><i class="fas fa-align-justify"></i></span>
                    </div>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>

    <section id="tts-panel" class="rdtoggle" aria-hidden="true">
        <section class="tts-settings basic-section clear rdtoggle_body">
            <header class="sect-header"><span class="sect-title">Text-to-Speech</span></header>
            <main class="sect-body">
                <div class="set-list clear" style="color: red; font-size: 14px; margin-bottom: 20px">
                    Đây là chức năng đang thử nghiệm, chi tiết xem tại <a href="/thao-luan/3305-chuc-nang-doc" style="color: blue">Link</a>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Giọng đọc</label>
                    <select id="tts-voice-select" class="w-full p-2 border rounded bg-white dark:bg-gray-800 text-sm dark:border-gray-600"></select>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Tốc độ</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-rate" min="0.1" max="3" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-rate-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Độ cao (Pitch)</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-pitch" min="0" max="2" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-pitch-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="flex gap-2 pt-4">
                    <button id="tts-play-btn" class="flex-1 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Phát</button>
                    <button id="tts-pause-btn" class="flex-1 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Tạm dừng</button>
                    <button id="tts-stop-btn" class="flex-1 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Dừng</button>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>
    
    <div class="container">
        <div class="row">
            <div class="reading-content col-12 col-lg-10 offset-lg-1" style="word-wrap: break-word;">
                <div id="bookmark_top" class="block d-lg-none"><i class="fas fa-bookmark"></i></div>
                <span class="save_bookmark" style="position: absolute; top: 9999px; display: none"><i class="fas fa-bookmark"></i></span>
                
                
                
                <div class="title-top" style="padding-top: 20px">
                    <h2 class="title-item text-xl font-bold" align="center">Toàn văn</h2>
                    <h4 class="title-item text-base font-bold" align="center">Chương 004 Phát súng đầu tiên (4)</h4>
                    <h6 class="title-item font-bold" align="center" aria-hidden="true">
                        <a href="https://docln.net/truyen/24846-ket-cuc-cua-phan-dien/c303775-chuong-004-phat-sung-dau-tien-4#chapter-comments" style="text-decoration: underline">1 Bình luận</a> -
                        Độ dài: 2,530 từ - Cập nhật: 
                        <time class="topic-time timeago" title="04-02-2026 18:51:51" datetime="2026-02-04T18:51:51+07:00"></time>                    </h6>
                </div>

                <div style="text-align: center; margin: 20px auto -20px auto;">
                                                        </div>

                <div class="pt-6 mb-6 mx-auto max-w-4xl" x-data="{ open: Cookies.get('affiliation_popup_closed2') === undefined }" x-cloak>
                    <div id="affiliation-popup" x-show="open" style="display: none" class="bg-slate-900 rounded-xl overflow-hidden shadow-lg border !border-slate-800">
                        <div class="p-4 flex flex-col md:flex-row items-center gap-4">
                            <button x-on:click="open = false; Cookies.set('affiliation_popup_closed2', 'true', { expires: 0.5 })" class="text-gray-400 hover:text-white transition-colors p-2" aria-label="Close">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                            
                            <div class="flex-shrink-0">
                                <img src="https://i2.hako.vip/vault/992471336465223711.webp" alt="Pepe" class="w-16 h-16 rounded-md object-cover">
                            </div>

                            <div class="flex-grow text-center md:text-left">
                                <p class="text-white text-sm md:text-base font-medium">
                                    Click vào link khi MUA <span class="text-orange-500 font-bold uppercase">BẤT KỲ THỨ GÌ</span> trên <span class="text-orange-500 font-bold">Shopee</span> để hỗ trợ HAKO. Có thể được tặng mã Free ship khi mua.
                                </p>
                            </div>

                            <div class="flex flex-col sm:flex-row gap-3 w-full md:w-auto flex-shrink-0">
                                <a href="https://s.shopee.vn/4q9eci0DM3" target="_blank" class="flex-1 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white font-bold py-2 px-6 rounded shadow-md transition-all text-center whitespace-nowrap" rel="noopener noreferrer">
                                    Shopee
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="chapter-content" class="long-text no-select text-justify">
                    <p style="display: none">Chương 004 Phát súng đầu tiên (4)</p>
                    <p id="1">Thời gian trong căn phòng trôi đi chậm chạp và nặng nề.</p><p id="2">Hoặc có lẽ, nó đã hoàn toàn ngưng đọng.</p><p id="3">Việc biết rằng dù mình có chết đi thì cũng chỉ quay trở lại khiến thời gian chẳng còn là thứ gì đó đặc biệt giá trị nữa.</p><p id="4">Mỗi sáng tôi bắt đầu ngày mới bằng việc đếm những chai rượu rỗng lăn lóc trên sàn ngay khi vừa mở mắt.</p><p id="5">Và mỗi đêm, tôi kết thúc ngày dài bằng việc đếm những hoa văn trên trần nhà và những vết ố trên lớp giấy dán tường ẩm mốc cho đến khi chìm vào giấc ngủ trong cơn say.</p><p id="6">Buổi sáng hôm đó cũng chẳng khác gì những ngày còn lại.</p><p id="7">Tôi thức dậy với một cơn đau đầu kinh khủng sau cơn say triền miên, đồng hành với đó là thứ axit dạ dày ghê tởm dâng lên tận cổ họng.</p><p id="8">Tôi lảo đảo bước đến bồn rửa mặt, vặn vòi nước và liên tục dội nước lạnh lên mặt mình.</p><p id="9">Tôi ngẩng đầu nhìn vào gương, nước vẫn còn nhỏ ròng ròng.</p><p id="10">Một kẻ xa lạ đang đứng trong đó.</p><p id="11">Quầng thâm bám chặt dưới mắt, và hai gò má hóp lại một cách suy kiệt.</p><p id="12">Bộ râu lởm chởm không được chăm sóc nhiều ngày phủ đầy khuôn mặt một cách nhếch nhác.</p><p id="13">Đó là một phế tích của một con người đang mấp mé bên bờ vực cái chết, một bộ dạng hoàn toàn không xứng với cái tên Lavin Edelgard.</p><p id="14">Có lẽ, đây mới là con người thật của tôi.</p><p id="15">Bởi vì cho đến tận bây giờ, tôi đã luôn cố gắng thay đổi danh tiếng của mình bằng cách nào đó, cố gắng tỏ ra tử tế trước mặt hôn thê, hoặc cố xoa dịu cô chị gái luôn coi thường tôi, bằng đủ loại việc làm vô nghĩa.</p><p id="16">Ngay khoảnh khắc đó, một ý nghĩ chợt lóe lên trong đầu tôi.</p><p id="17">Nếu đằng nào mọi chuyện cũng kết thúc.</p><p id="18">Nếu tôi đã định sẵn là bị trục xuất khỏi cả gia tộc lẫn học viện, rồi phải lang thang ngoài đường phố.</p><p id="19">Thì liệu có thực sự cần thiết phải thụ động chờ đợi cái kết thúc đang đến trong cái góc phòng tối tăm và ẩm thấp này không?</p><p id="20">Tôi không thực sự biết kết thúc đó là gì, hay tôi phải thu thập thứ gì.</p><p id="21">Cũng có khả năng những gì tôi thấy chỉ là ảo giác.</p><p id="22">Đó là một sự thúc đẩy nảy sinh từ nơi xa xôi, không phải từ hy vọng hay ý chí.</p><p id="23">Nó giống như cái cách tôi nắm chặt khẩu súng ổ quay khi nghe Levina nói rằng tôi đã bị đuổi khỏi gia đình.</p><p id="24">Hay một cảm giác tương tự như một tử tù đang cẩn thận chọn lựa bữa ăn cuối cùng của mình.</p><p id="25">Một cảm giác nhẹ nhõm đến lạ kỳ.</p><p id="26">Kéo lê thân hình nặng nề trái ngược với cảm xúc của mình, tôi lấy bộ đồng phục nhăn nhúm đang bị treo bừa bãi trên móc và mặc vào.</p><p id="27">Đường may ở vai bị lệch, và một mùi ẩm mốc nhàn nhạt tỏa ra từ lớp vải.</p><p id="28">Khi tôi mở cửa bước ra hành lang, khung cảnh buổi sáng của học viện mà tôi gặp lại sau một thời gian dài trông thật ngượng ngùng đến khó tin.</p><p id="29">Ánh nắng đổ xuống qua những khung cửa sổ, tiếng cười nói rộn ràng của sinh viên, những bước chân hối hả di chuyển trên hành lang.</p><p id="30">Tất cả chúng cảm giác như một câu chuyện từ thế giới khác, chẳng liên quan gì đến tôi.</p><p id="31">Tôi chỉ đơn giản bước đi vô định giữa họ, như một bóng ma.</p><p id="32">Không có điểm đến. Tôi chỉ di chuyển theo nơi bàn chân dẫn lối.</p><p id="33">Vô số ánh nhìn lướt qua tôi.</p><p id="34">Có kẻ nhìn với vẻ khinh miệt không che giấu, có người tò mò hóng hớt, trong khi những người khác nhanh chóng né tránh, như thể họ vừa nhìn thấy một đống rác biết đi.</p><p id="35">Không có nhiều sinh viên trong học viện này mà không biết mặt tôi.</p><p id="36">Tôi có thể tự hào mình là một kiểu người nổi tiếng theo nghĩa nào đó.</p><p id="37">Tên ngốc được sinh ra trong một gia tộc hiển hách, phạm đủ thứ sai lầm, bị tống vào học viện, và rồi, để kết thúc tất cả, hắn đã thách đấu với nam chính nguyên tác, hay nói cách khác, một gã thường dân ngạo mạn nhưng có chút thực lực, Kyle, trong một trận đấu tay đôi, chỉ để bị đánh bại một cách thảm hại.</p><p id="38">Đó là một ‘tôi’ mà được thế giới này ghi nhận.</p><p id="39">Trớ trêu thay, đó còn chẳng phải là việc tôi đã gây ra.</p><p id="40">Bởi vì đó là việc của Lavin.</p><p id="41">Nếu tôi nhập vào cơ thể này sớm hơn chỉ ba ngày, không, thậm chí chỉ một ngày thôi, tôi đã không làm chuyện ngu ngốc như vậy.</p><p id="42">Vả lại, ngay từ đầu tôi cũng chẳng muốn sống ở đây.</p><p id="43">Khi đang lang thang vô định dọc hành lang, tôi đi qua lớp học nơi đang diễn ra bài giảng về Thảo dược học Pháp thuật Nâng cao.</p><p id="44">Lớp học chắc hẳn vừa kết thúc, vì cửa phòng mở ra và những gương mặt quen thuộc tràn ra ngoài.</p><p id="45">Và trong nhóm đó có Seraphina.</p><p id="46">Cô ta gầy đi trông thấy chỉ sau vài ngày.</p><p id="47">Mái tóc vàng vốn luôn được chăm chút tỉ mỉ giờ đây xám xịt, và những bóng đen mệt mỏi đổ dài trên khuôn mặt nhợt nhạt.</p><p id="48">Dù đôi mắt xanh thẳm của cô ta vẫn tỏa sáng tuyệt đẹp.</p><p id="49">Và ánh sáng đó đang hướng về phía tôi.</p><p id="50">Ánh mắt chúng tôi chạm nhau.</p><p id="51">Đôi mắt xanh của Seraphina mở to.</p><p id="52">Cô ta mấp máy môi như muốn nói điều gì đó, nhưng rồi lại cắn chặt.</p><p id="53">Khuôn mặt cô ta là một sự pha trộn phức tạp giữa bối rối, một chút nhẹ nhõm rất mờ nhạt, tội lỗi và căm ghét.</p><p id="54">Lavin im lặng quay người đi, không muốn dính vào một cuộc tranh cãi mệt mỏi nào khác.</p><p id="55">Giọng nói của cô ta không vang lên từ phía sau hắn.</p><p id="56">Bởi vì họ không còn ở trong mối quan hệ như thế nữa.</p><p id="57">Seraphina thẫn thờ nhìn theo bóng lưng đang lùi dần của Lavin, người vừa liếc nhìn cô ta rồi bước qua như kẻ lạ.</p><p id="58">Bờ vai hắn có vẻ hẹp hơn trước rất nhiều, và bước chân hắn chẳng mang theo chút sức nặng nào.</p><p id="59">Hắn trông giống như một cái cây bệnh sắp héo rũ và chết tức tưởi, hay một kẻ vô gia cư nhếch nhác nằm vất vưởng trên phố, một dáng vẻ chẳng khác gì kẻ đã thất bại trong mọi thứ.</p><p id="60">"Này, người vừa đi qua... không phải là Lavin Edelgard sao?"</p><p id="61">Cô bạn Elise ở bên cạnh hỏi, lắc lắc cánh tay cô nàng.</p><p id="62">Seraphina lúc đó mới sực tỉnh khỏi cơn thẫn thờ.</p><p id="63">"Trông hắn thê thảm thật. Như một cái xác sống vậy."</p><p id="64">Cô không thể nói được gì.</p><p id="65">Cô chỉ biết cắn chặt môi dưới.</p><p id="66">"Seraphina? Có chuyện gì vậy? Trông cậu xanh xao quá."</p><p id="67">Elise khinh miệt hất cằm về phía cuối hành lang nơi Lavin vừa biến mất.</p><p id="68">"Có phải vì tên cặn bã đó không? Cậu nói là cuối cùng cũng hủy hôn rồi mà?"</p><p id="69">"......Phải."</p><p id="70">Seraphina cố gắng trả lời.</p><p id="71">"Đừng làm cái mặt đó vì loại rác rưởi như hắn. Cậu nên ăn mừng đi mới đúng! Cuối cùng cậu cũng thoát khỏi tên khốn đó rồi!"</p><p id="72">Những lời chúc mừng.</p><p id="73">Đó là những lời mà cô đã khao khát được nghe đến cháy lòng.</p><p id="74">Thế nhưng, giờ đây khi nghe thấy chúng, tại sao cô lại cảm thấy nghẹn đắng nơi cổ họng?</p><p id="75">Thay vì cảm giác nhẹ nhõm khi được giải thoát khỏi một sự ràng buộc mệt mỏi, một cảm xúc không tên lấp đầy trái tim Seraphina.</p><p id="76">Những sự kiện ngày hôm đó, biểu cảm của Lavin, cứ mãi ám ảnh tâm trí cô ta.</p><p id="77">Khi nghe cô nói rằng cô đã cầu nguyện cho hắn chết đi, đôi mắt hắn không hề lộ vẻ ngạc nhiên hay giận dữ.</p><p id="78">Hắn chỉ nhìn cô đờ đẫn, như thể hoàn toàn chẳng còn chút bận tâm nào.</p><p id="79">"Nhìn hắn mà xem. Hắn hoàn toàn tan nát rồi. Tớ nghe nói hắn cũng sắp bị đuổi khỏi gia tộc, nên có vẻ hắn chẳng còn nơi nào để đi nữa. Đáng đời hắn thôi."</p><p id="80">Seraphina không thể đáp lại lời của người bạn kia.</p><p id="81">Trong mắt cô, đó không phải là hình ảnh của một tên cặn bã say xỉn, lảo đảo, mà là bóng hình mờ nhạt của người bạn thuở nhỏ mà cô đã luôn phải để mắt tới.</p><p id="82">Cô không còn tâm trí đâu để tập trung vào cuộc trò chuyện của bạn bè nữa.</p><p id="83">Cô trân trân nhìn về phía cuối hành lang nơi Lavin đã biến mất.</p><p id="84">Suốt buổi chiều hôm đó, Seraphina không thể tập trung vào bài giảng.</p><p id="85">Giọng nói của giáo sư lướt qua tai cô như tiếng vo ve, và những con chữ trong sách hiện ra chỉ như những chuỗi ký tự vô nghĩa.</p><p id="86">Ngay khi lớp học kết thúc, cô từ chối lời mời ăn tối của bạn bè và đi thẳng về ký túc xá.</p><p id="87">Khoảnh khắc trở về phòng và đóng cửa lại, hơi thở mà cô kìm nén bấy lâu vỡ òa ra.</p><p id="88">Cô gục xuống, tựa lưng vào cánh cửa.</p><p id="89">Mọi thứ bên trong căn phòng rộng lớn và sang trọng này bỗng cảm thấy thật xa lạ.</p><p id="90">'Kết thúc rồi, phải không?'</p><p id="91">Cô nghĩ rằng mình đã chấm dứt mối quan hệ mệt mỏi này, và cuối cùng đã giành được tự do.</p><p id="92">Seraphina mở một ngăn kéo.</p><p id="93">Bên trong là những bức thư đã phai màu và một bông hoa tử đinh hương khô héo, một bông hoa duy nhất mà cô thậm chí không còn nhớ mình đã nhận được khi nào.</p><p id="94">Cô nhìn chúng không rời mắt suốt một hồi lâu.</p><p id="95">Trong khi đó, Lavin len lỏi và lách qua đám sinh viên đang đông đúc trên hành lang, bước đi vô định qua những dãy hành lang mê cung.</p><p id="96">Hắn thậm chí không biết mình đang đi đâu.</p><p id="97">Tất cả những gì hắn muốn là chạy trốn khỏi nơi này, cái nơi kinh khủng này.</p><p id="98">Bất cứ nơi nào hắn nhìn vào, cũng chỉ thấy những gã ngu ngốc trong những bộ đồng phục ngu ngốc.</p><p id="99">Có gì vui vẻ đến mức họ cứ vừa đi vừa cười nói như thế?</p><p id="100">Trong khi một người khác đang tuyệt vọng để thoát khỏi đây.</p><p id="101">Sau khi đi bộ một hồi lâu, hắn thấy mình đang đứng trước một tòa tháp cũ, nằm ở phần hẻo lánh nhất của học viện.</p><p id="102">Đó chính là ngọn tháp mà hắn từng đứng nhìn đờ đẫn từ cửa sổ phòng mình.</p><p id="103">Nó đã không được sử dụng từ lâu đến nỗi dây leo mọc chằng chịt như những nứt rạn trên tường, và lối vào đã bị đóng chặt.</p><p id="104">Hắn ngước nhìn tòa tháp.</p><p id="105">Rồi không chút do dự, hắn nắm lấy nắm cửa đang đóng chặt và vặn mạnh hết sức bình sinh.</p><p id="106">Với một tiếng <em>két</em>, những bản lề rỉ sét rít lên thảm thiết.</p><p id="107">Khi cánh cửa mở ra, mùi bụi bặm và nấm mốc bị giam cầm bấy lâu tỏa ra nồng nặc.</p><p id="108">Bên trong tối tăm và mát lạnh.</p><p id="109">Một cầu thang xoắn ốc hẹp trải dài vô tận lên phía trên.</p><p id="110">Hắn bắt đầu leo lên những bậc thang, từng bước một.</p><p id="111">Với mỗi bước đi, cầu thang gỗ cảm giác như sắp gãy vụn dưới chân, kêu răng rắc.</p><p id="112">Thỉnh thoảng, những tia sáng lọt qua những khe hở hẹp trên tường, soi sáng những hạt bụi đang lơ lửng trong không trung.</p><p id="113">Hắn đã leo được bao lâu rồi?</p><p id="114">Cuối cùng, cầu thang cũng kết thúc, và một cánh cửa gỗ nhỏ xuất hiện.</p><p id="115">Khi hắn mở cửa, một cơn gió dữ dội cùng với bầu trời bao la hiện ra trước mắt.</p><p id="116">Đó là đỉnh tháp, một không gian được bao quanh bởi một dãy lan can hẹp.</p><p id="117">Hắn tiến lại gần lan can và nhìn xuống.</p><p id="118">Toàn cảnh học viện thu gọn trong tầm mắt.</p><p id="119">Những tòa nhà phức hợp mà hắn vừa lang thang đi qua, quảng trường nơi sinh viên di chuyển như những đàn kiến, những dãy ký túc xá và thư viện ở phía xa.</p><p id="120">Hắn từng tự hỏi bức tranh phong cảnh mà Seraphina tặng hắn ngày xưa được vẽ từ đâu, có lẽ chính là từ đây.</p><p id="121">Cơn gió thổi tung mái tóc hắn một cách mạnh mẽ.</p><p id="122">Hắn lấy bao thuốc lá nhăn nhúm từ trong túi ra, và châm điếu thuốc cuối cùng còn lại.</p><p id="123">Làn khói khét lẹt bị gió cuốn đi và tan biến ngay lập tức.</p><p id="124">Hắn đứng trước lan can, nhìn xuống một hồi lâu.</p><p id="125">[Thu thập Kết thúc. 1/?] </p><p id="126">[Phần thưởng: Trở về thế giới ban đầu.]</p><p id="127">Ngay cả khi nhìn thấy dòng tin nhắn lơ lửng trước mắt, dường như đang bảo hắn hãy nhảy xuống ngay đi, hắn cũng không đặc biệt cảm thấy muốn nhảy.</p><p id="128">Dù sao thì hắn cũng sẽ thất bại thôi, nên chẳng việc gì phải lặp lại những hành động đau đớn đó nữa.</p><p id="129">Và mặc dù hắn không ngại cái chết, nhưng hắn hơi sợ độ cao.</p><p id="130">Từ đỉnh tháp, hắn nhìn xuống một hồi lâu.</p><p id="131">Đó là một tầm nhìn khá ổn.</p><p id="132">Giống như một vị thần, nhìn xuống đám sinh viên đang di chuyển như kiến và những tòa nhà trông như đồ chơi mang lại cho hắn một cảm giác giải thoát kỳ lạ.</p><p id="133">Tất nhiên, cảm giác giải thoát đó chẳng kéo dài được lâu.</p><p id="134">Bởi vì điếu thuốc của hắn đã cháy sạch đến tận cùng.</p><p id="135">Hắn bước lên những bậc thang gỗ kêu răng rắc, và chậm rãi bắt đầu đi xuống khỏi ngọn tháp.</p><p id="136">Thế giới vẫn ở đó, chẳng hề thay đổi.</p><p id="137">Rời bỏ bóng tối, bụi bặm và mùi hương của thời gian, khi hắn bước trở lại hành lang, mặt trời đã lặn về phía tây.</p><p id="138">Hắn phải trở về phòng mình.</p><p id="139">Nếu không uống rượu, hắn cảm thấy mình sẽ không thể chịu đựng nổi cơn đau đầu như muốn nứt toác hộp sọ, hay cái thực tại mệt mỏi này.</p><p id="140">Hắn hướng về phía ký túc xá, đi tắt qua những con đường hẻo lánh của học viện.</p><p id="141">Đó là một con đường tắt hiếm khi được sử dụng.</p><p id="142">Ngay lúc đó, vài tên sinh viên đã chặn đường hắn.</p><p id="143">Hắn dừng lại.</p><p id="144">Thậm chí không cần xác nhận khuôn mặt của họ.</p><p id="145">Mùi nước hoa rẻ tiền và thuốc lá chất lượng thấp tỏa ra từ phía họ.</p><p id="146">Đó là những gương mặt vô cùng quen thuộc.</p>

                    <p style="display: none">Hãy bình luận để ủng hộ người đăng nhé!</p>
                    
                    <!-- <div class="flex justify-center mt-10 mb-7 space-x-3">
                        <a
                            href="https://hako.vn/discord"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #7289da; text-decoration: initial; color: white !important;">
                            <svg
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                xmlns="http://www.w3.org/2000/svg"
                                fill-rule="evenodd"
                                clip-rule="evenodd"
                                viewbox="0 0 24 24">
                                <path
                                d="M19.54 0c1.356 0 2.46 1.104 2.46 2.472v21.528l-2.58-2.28-1.452-1.344-1.536-1.428.636 2.22h-13.608c-1.356 0-2.46-1.104-2.46-2.472v-16.224c0-1.368 1.104-2.472 2.46-2.472h16.08zm-4.632 15.672c2.652-.084 3.672-1.824 3.672-1.824 0-3.864-1.728-6.996-1.728-6.996-1.728-1.296-3.372-1.26-3.372-1.26l-.168.192c2.04.624 2.988 1.524 2.988 1.524-1.248-.684-2.472-1.02-3.612-1.152-.864-.096-1.692-.072-2.424.024l-.204.024c-.42.036-1.44.192-2.724.756-.444.204-.708.348-.708.348s.996-.948 3.156-1.572l-.12-.144s-1.644-.036-3.372 1.26c0 0-1.728 3.132-1.728 6.996 0 0 1.008 1.74 3.66 1.824 0 0 .444-.54.804-.996-1.524-.456-2.1-1.416-2.1-1.416l.336.204.048.036.047.027.014.006.047.027c.3.168.6.3.876.408.492.192 1.08.384 1.764.516.9.168 1.956.228 3.108.012.564-.096 1.14-.264 1.74-.516.42-.156.888-.384 1.38-.708 0 0-.6.984-2.172 1.428.36.456.792.972.792.972zm-5.58-5.604c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332.012-.732-.54-1.332-1.224-1.332zm4.38 0c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332 0-.732-.54-1.332-1.224-1.332z" />
                            </svg>
                            Discord
                        </a>
                        <a
                            href="https://fb.com/hako.page"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #1877f2; text-decoration: initial; color: white !important;">
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                viewBox="0 0 24 24">
                                <path
                                d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z" />
                            </svg>
                            Facebook
                        </a>
                    </div> -->

                                        <a href="/truyen/8476" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/8476/3269685b-c0ef-4013-a7d6-74104f39a24c.jpg?t=1739894654" class="d-none d-md-block" style="width: 970px; height: auto">
                    </a>
                    <a href="/truyen/8476" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/8476/bf1184be-cf52-429e-8acb-0d29fb4eea33.jpg?t=1739894654" class="d-md-none" style="width: 100%; height: auto">
                    </a>
                    
                                    </div>

                <div style="text-align: center; margin: 20px auto 10px auto;">
                                                        </div>
                
                <section class="rd-basic_icon row">
                    <a href="/truyen/24846-ket-cuc-cua-phan-dien/c299564-chuong-003-phat-sung-dau-tien-3" class="dark:text-black col text-center "><i class="fas fa-backward"></i></a>
                    <a href="/truyen/24846-ket-cuc-cua-phan-dien" class="dark:text-black col text-center"><i class="fas fa-home"></i></a>
                    <a href="/truyen/24846-ket-cuc-cua-phan-dien" class="dark:text-black col text-center  disabled "><i class="fas fa-forward"></i></a>
                </section>
                
                <!--the code style is important to keep this comment section be out of the effect of user reading's setting-->
            </div>
            <div class="col-12 col-lg-10 offset-lg-1" aria-hidden="true">
                <section id="chapter-comments" class="basic-section dark:bg-[#1f1f1f] dark:text-white dark:border dark:border-[#1f1f1f]">
                    <header class="sect-header tab-list dark:bg-[#2a2a2a] dark:border-[#2a2a2a]"> 
                        <span class="sect-title tab-title" data-tab-index="1">Bình luận <span class="comments-count">(1)</span></span>
                    </header>
                    <main id="fbcmt_root" class="sect-body">
                        <span style="padding: 10px; display: inline-block;">Báo cáo bình luận không phù hợp ở <a href="/thao-luan/619-bao-cao-binh-luan" style="color: blue">đây</a></span>
                        <div id="tab-content-1" class="tab-content clear">
                            <section class="ln-comment">
    <header>
        <h3 class="text-lg font-bold dark:text-white">1 Bình luận </h3>
        <!-- <i id="refresh_comment" class="fas fa-refresh" aria-hidden="true" style="margin-left: 10px; font-size: 18px"></i></h3> -->
            </header>

    <main class="ln-comment-body">
                    <div class="ln-comment_sign-in long-text">
                Bạn phải <a href="/login">đăng nhập</a> hoặc <a href="/register">tạo tài khoản</a> để bình luận.
            </div>
                
        
        
        <div class="ln-comment-group">
    <div id="ln-comment-3191359"
    class="ln-comment-item mt-3 clear"
    data-comment="3191359" 
    data-parent="3191359" 
    data-type="chapter" 
    data-typeid="303775">
    <div class="flex gap-1 max-w-full">
        <div class="w-[50px]">
            <div class="mx-1 my-1">
                <img src="https://i.hako.vn/ln/users/avatars/u217516-71ad82f9-2b7c-4215-84af-f56ebdcf28eb.jpg" class="w-full rounded-full" />
            </div>
        </div>
        <div
            class="w-full min-w-0 rounded-md bg-gray-100 ps-1 pe-0 pb-1 pt-0 dark:!bg-zinc-800 ">
            <div class="flex min-w-0 flex-col px-2">
                <div class="flex align-top justify-between">
                    <div class="flex flex-wrap gap-x-2 gap-y-1 align-middle pt-1">
    <div class="self-center">
        <a class="font-bold leading-6 md:leading-7 ln-username " href="/thanh-vien/217516">T Đ Anh</a>
    </div>
                                    </div>
                                        
                </div>
                                                    <div class="ln-comment-content long-text">
                        Ra tiếp đi ad
                    </div>
                    <div class="comment_see_more expand none">Xem thêm</div>
                    <div class="flex gap-2 align-bottom text-[13px] visible-toolkit">
                        <a href="/truyen/24846-ket-cuc-cua-phan-dien/c303775-chuong-004-phat-sung-dau-tien-4?comment_id=3191359#ln-comment-3191359"
                            class="text-slate-500">
                            <time class="timeago" title="04-02-2026 18:25:27"
                                datetime="2026-02-04T18:25:27+07:00">
                                04-02-2026 18:25:27
                            </time>
                        </a>
                        <a
                            class="self-center visible-toolkit-item do-like cursor-pointer">
                            <i class="fas fa-thumbs-up me-1"></i>
                            <span class="likecount font-semibold"></span>
                        </a>
                                            </div>
                            </div>
        </div>
    </div>
</div>

    </div>

<div class="ln-comment-page">
</div>    </main>

    <script>
        var token = 'CpyEGAHc8JrykVKfegMOfQxV1zeKZiwnDpYDuf6o';
        var comment_type = 'chapter';
        var comment_typeid = '303775';
    </script>

    </section>


                        </div>
                    </main>
                </section>
            </div> 
        </div>
    </div>
</main>

<script>
    token = 'i9KkJtKQpYiDiuTWoUTcq3lG14NYntqdwQfyy1Hz';
        
    function turnoffall() {
        $(".rdtoggle").removeClass("on");
        $(".rdtoggle_body").removeClass("animation fade-in-left-big fade-in-down");
        $("html").removeClass("overflow-hiden");
    }
    
    function rdtoggle(classicon, effect) {
        if ($(classicon).hasClass("on")) {
            turnoffall();
        } else {
            turnoffall();
            $(classicon).addClass("on");
            $("html").addClass("overflow-hiden");
            $(classicon + " .rdtoggle_body").addClass("animation " + effect);
        } 
    };
    
    $("#rd-setting_icon").on('click', function() {
        rdtoggle("#setting", "fade-in-down");                   
    });

    $("#rd-tts_icon").on('click', function() {
        rdtoggle("#tts-panel", "fade-in-down");
    });
        
    $("#rd-info_icon").on('click', function() {
        rdtoggle("#chapters", "fade-in-left-big");              
    });
        
    $("#rd-bookmark_icon").on('click', function() {
        rdtoggle("#bookmarks", "fade-in-left-big");                     
    });
        
    $(".black-click").on('click', function() {
        turnoffall();
        $("#rd-side_icon").hide();
        $("#bookmark_top").removeClass("on");
    });
        
    var bgcolor    = Cookies.get('color') || (Cookies.get('night_mode') ? 6 : 4);
    var fontfamily = Cookies.get('fontfamily') || '';
    var fontsize   = Cookies.get('font') || 18; 
    var margin     = Cookies.get('margin') || 0;
    var textAlign  = Cookies.get('textAlign') || 'text-justify';
        
    function setcolor(alter = true) {
        var switcher = $(".set-color .set-input span").eq(bgcolor);
        switcher.addClass("current");

        if (alter) {
            for (var i = 0; i < $(".set-color .set-input span").length; i++) {
                $("#mainpart").removeClass('style-' + i);
                $("#mainpart").removeClass('dark');
            }
            $("#mainpart").addClass('style-' + bgcolor);

            // Manually hardcoded to dark
            if (bgcolor >= 6) {
                $("#mainpart").addClass('dark');
            }
        }
    }

    // This creates unsmooth experience so we only use it for select box
    function setfontfamily() {
        $('.set-font-family select option').filter(function () {
            return fontfamily.split(',')[0].indexOf($(this).text()) != -1 ;
        }).attr('selected', true);
    }
        
    function setfontstyle(alter = true) {
        $(".set-font input.set-slide_input").val(fontsize + "px"); 

        if (alter) {
            $("div#chapter-content").css("font-size", fontsize + "px");

            var lineheight = +fontsize + 10;
            $("#chapter-content").css("line-height", lineheight + "px");
        }
    }
        
    function setmargin() {
        $(".set-margin input.set-slide_input").val(margin + "px"); 
        $("#chapter-content").css({
            'padding-left': margin + "px",
            'padding-right': margin + "px"
        });
    }

    function setTextAlign(alter = true) {
        var switcher = $(".set-text-align .set-input span[data-align='" + textAlign + "']");
        switcher.addClass("current");

        if (alter) {
            $(".set-text-align .set-input span").each(function () {
                $("#chapter-content").removeClass($(this).attr('data-align'));
            });

            $("#chapter-content").addClass(textAlign);
        }
    }
    
    setcolor(false);
    setfontfamily();
    setfontstyle(false);
    setmargin();
    setTextAlign(true);
    
    //1px = 0.0625rem;
    //16px = 1rem (default);
    
    $(".set-color .set-input span").click(function(){
        bgcolor = $(this).data("id");
        $(".set-color .set-input span").removeClass("current");
        setcolor();            
        Cookies.set('color', bgcolor, { expires: 365 });
    });

    $('.set-font-family select').on('change', function () {
        fontfamily = "'" + $('option:selected', this).text() + "', " + '\'Times New Roman\', Georgia, serif';
        
        $('div#chapter-content').css('font-family', fontfamily);

        Cookies.set('fontfamily', fontfamily, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-smaller").click(function () {
        fontsize = fontsize - 2;
        if (fontsize < 0) fontsize = 0;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-bigger").click(function () {
        fontsize = +fontsize + 2;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-smaller").click(function () {
        margin = margin - 20;
        if (margin < 0) margin = 0;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-bigger").click(function () {
        margin = +margin + 20;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    }); 

    $(".set-text-align .set-input span").click(function(){
        textAlign = $(this).data("align");
        $(".set-text-align .set-input span").removeClass("current");
        setTextAlign();        
        Cookies.set('textAlign', textAlign, { expires: 365 });
    });
        
    $("#bookmarks_list li").each(function(){
        var linepr = $(this).data("line");
        var preview = $(".reading-content p#" + linepr).text();

        var shortText = preview.trim().substring(0, 30) + "...";
        $(this).find(".pos_bookmark small").text(shortText);
    });

    $('div#chapter-content').html(
        $('div#chapter-content').html().replace(
            /\[note(\d+)\]/gi, 
            '<span id="anchor-note$1" class="note-icon none-print inline note-tooltip" data-tooltip-content="#note$1 .note-content" data-note-id="note$1"><i class="fas fa-sticky-note"></i></span><a id="anchor-note$1" class="inline-print none" href="#note$1">[note]</a>'
        )
    )
    
    tippy('.note-tooltip', {
        delay: 50,
        maxWidth: 240,
        interactive: true,
        content(ref) {
            const selector = ref.getAttribute('data-tooltip-content');
            const template = document.querySelector(selector);
            return template ? template.innerHTML : 'Đặt sai ID của note';
        }
    });
        
    isLoggedIn = 0;
    series_id = parseInt('24846');
    chapter_id = parseInt('303775');

    readingObject = {
        series_id: series_id,
        series_title: 'Kết cục của Phản diện',
        series_url: $('i.fa-home').first().parent().attr('href'),
        series_cover: $('.rd_sidebar-header a.img').css('background-image'),
        chapter_title: $('ul.sub-chap_list li.current a').text().trim(),
        chapter_url: $('ul.sub-chap_list li.current a').attr('href'),
        book_title: $('ul#chap_list > li.current a').text(),
        book_url: $('ul#chap_list > li.current a').attr('href'),
        read_time: +new Date() / 1000 | 0,
    };

// TTS Manager - Enhanced Web Speech API (Vietnamese). Chunked queue for long texts, no delays/interrupts.
const synth = window.speechSynthesis;
let voices = [];
let voicesLoaded = false;
let ttsRate = parseFloat(localStorage.getItem('tts-rate')) || 1;
let ttsPitch = parseFloat(localStorage.getItem('tts-pitch')) || 1;
let ttsState = 'idle'; // idle, speaking, paused, loading
let currentChunk = 0;
let totalChunks = 0;
let processingIndex = 0;
let paragraphs = [];
const BUFFER_SIZE = 5;

// --- Background Persistence (Wake Lock + Silent Audio) ---
let wakeLock = null;
const silentAudio = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTSVNFAAAAPAAADEVuY29kZWQgd2l0aCBMYW1lMy4xMDBhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUA==');
silentAudio.loop = true;

async function enableConnection() {
    // 1. Start Silent Audio Loop (tricks browser into thinking we are a music player)
    try {
        await silentAudio.play();
    } catch (err) {
        console.warn('Silent Audio Play Failed (likely no interaction):', err);
    }

    // 2. Request Screen Wake Lock (prevents screen from sleeping automatically)
    if ('wakeLock' in navigator) {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (err) {
            console.warn('Wake Lock Request Failed:', err);
        }
    }
}

function disableConnection() {
    // 1. Stop Silent Audio
    try {
        silentAudio.pause();
        silentAudio.currentTime = 0;
    } catch (e) {}

    // 2. Release Wake Lock
    if (wakeLock) {
        try {
            wakeLock.release();
            wakeLock = null;
        } catch (e) {}
    }
}

// Re-acquire Wake Lock if visibility changes and we are speaking
document.addEventListener('visibilitychange', async () => {
    if (wakeLock !== null && document.visibilityState === 'visible' && ttsState === 'speaking') {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (e) {}
    }
});
// ---------------------------------------------------------

let ttsVoiceIdx = localStorage.getItem('tts-voice') || '0';

function populateVoices() {
    voices = synth.getVoices().filter(v => v.lang.startsWith('vi'));
    voicesLoaded = true;
    let $select = $('#tts-voice-select');
    $select.empty();

    if (voices.length === 0) {
        $select.append('<option value="-1">Không có giọng Việt (cài Chrome/Edge)</option>');
        return;
    }

    voices.forEach((voice, idx) => {
        $select.append(`<option value="${idx}">${voice.name} (${voice.lang}) ${voice.default ? '(mặc định)' : ''}</option>`);
    });

    let idx = Math.max(0, Math.min(parseInt(ttsVoiceIdx), voices.length - 1));
    $select.val(idx);
}

function updateTTSUI(progress = '') {
    let $icon = $('#rd-tts_icon i');
    $icon.removeClass('fa-volume-up fa-volume-mute fa-spinner fa-spin');
    let $playBtn = $('#tts-play-btn'), $pauseBtn = $('#tts-pause-btn'), $stopBtn = $('#tts-stop-btn');
    $playBtn.prop('disabled', ttsState === 'speaking' || ttsState === 'loading'); // Enable on idle/paused
    $pauseBtn.prop('disabled', ttsState === 'idle');
    $stopBtn.prop('disabled', ttsState === 'idle');
    // Always remove old progress
    $('#tts-progress').remove();

    if (progress && totalChunks > 0) {
        $playBtn.after(`<span id="tts-progress" class="text-xs block text-center mt-1">${progress}</span>`);
    }

    if (ttsState === 'idle') {
        // Check resume preview
        const resumeData = loadResumeState();
        let currentParagraphs = $('#chapter-content p').map(function() {
            return $(this).text().trim();
        }).get().filter(p => p.trim().length > 0);

        if (resumeData && resumeData.total === currentParagraphs.length) {
            $playBtn.text(`Tiếp tục (${resumeData.index + 1}/${resumeData.total})`);
        } else {
            $playBtn.text('Phát');
        }

        $icon.addClass('fa-volume-up');
    } else if (ttsState === 'speaking' || ttsState === 'loading') {
        $icon.addClass('fa-volume-up fa-spinner fa-spin');
    } else if (ttsState === 'paused') {
        $icon.addClass('fa-volume-mute');
    }
}

$('#tts-play-btn').off('click').on('click', function() {
    // Always restart/resume from storage
    enableConnection(); // Start keep-alive
    synth.cancel();
    ttsState = 'idle';
    // queuedUtterances = []; // Removed global queue
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();

    if (!voicesLoaded || voices.length === 0) {
        ttsState = 'loading';
        updateTTSUI();
        setTimeout(() => {
            if (!voicesLoaded) {
                alert('Giọng nói chưa tải. Thử lại.');
                ttsState = 'idle';
                updateTTSUI();
                return;
            }
            playTTS();
        }, 500);
        return;
    }

    playTTS();
});

function createUtterance(item) {
    let u = new SpeechSynthesisUtterance(item.text);
    u.lang = 'vi-VN';
    u.rate = parseFloat($('#tts-rate').val()) || 1;
    u.pitch = parseFloat($('#tts-pitch').val()) || 1;
    let voiceIdx = parseInt($('#tts-voice-select').val());

    if (voiceIdx >= 0 && voices[voiceIdx]) {
        u.voice = voices[voiceIdx];
    }

    u.onstart = () => {
        currentChunk++;
        saveResumeState();
        updateTTSUI(`${currentChunk}/${totalChunks}`);
        
        // Highlight logic
        $('.current-reading').removeClass('current-reading');
        if (item.el) {
            $(item.el).addClass('current-reading');
            item.el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        feedQueue(); // Ensure buffer is maintained
    };
    u.onerror = (event) => {
        console.error('TTS Error:', event.error, event);

        if (event.error !== 'interrupted') {
             // alert(`Lỗi TTS: ${event.error}. Bỏ qua đoạn.`);
             console.warn('TTS Error skipping chunk', event.error);
        }

        saveResumeState(); // Save on error
        feedQueue();
    };
    u.onend = () => {
        saveResumeState();

        if (currentChunk >= totalChunks) {
            clearResumeState();
            $('.current-reading').removeClass('current-reading'); // Cleanup
            
            // Auto-Next Logic
            let $nextBtn = $('.rd-basic_icon a').last();
            if ($nextBtn.length && !$nextBtn.hasClass('disabled')) {
                localStorage.setItem('tts-autoplay', 'true');
                window.location.href = $nextBtn.attr('href');
                return;
            }

            ttsState = 'idle';
            disableConnection(); // Cleanup
            currentChunk = 0;
            totalChunks = 0;
            processingIndex = 0;
            updateTTSUI();
        } else {
            feedQueue();
        }
    };
    u.onpause = () => { saveResumeState(); };
    return u;
}

function getStorageData() {
    try {
        return JSON.parse(localStorage.getItem('tts-resume-data')) || {};
    } catch {
        return {};
    }
}

function setStorageData(data) {
    localStorage.setItem('tts-resume-data', JSON.stringify(data));
}

function saveResumeState() {
    if (totalChunks > 0) {
        const data = getStorageData();
        data[chapter_id] = {
            index: currentChunk,
            total: totalChunks,
            timestamp: Date.now()
        };
        // Optional: Clean up old entries (older than 7 days?) to prevent infinite growth, 
        // but for now we just save.
        setStorageData(data);
    }
}

function clearResumeState() {
    const data = getStorageData();

    if (data[chapter_id]) {
        delete data[chapter_id];
        setStorageData(data);
    }
}

function loadResumeState() {
    const data = getStorageData();
    const saved = data[chapter_id];
    
    if (!saved) return null;
    
    if (Date.now() - saved.timestamp > 3600000 * 24 * 7) { // 7 days
        clearResumeState();
        return null;
    }

    return saved;
}

function initTTS() {
    populateVoices();
    $('#tts-rate').val(ttsRate);
    $('#tts-rate-value').text(ttsRate);
    $('#tts-pitch').val(ttsPitch);
    $('#tts-pitch-value').text(ttsPitch);
    updateTTSUI();
    
    if (localStorage.getItem('tts-autoplay') === 'true') {
        localStorage.removeItem('tts-autoplay');
        $(window).on('load', function() {
             setTimeout(() => {
                 $('#tts-play-btn').click(); 
             }, 500); 
        });
    }
}

function getParagraphs() {
    return $('#chapter-content p').map(function() {
        let text = $(this).text().trim();
        
        // If paragraph contains an image, replace with "Hình ảnh"
        if ($(this).find('img').length > 0) {
            text = 'Hình ảnh';
        }
        
        if (text.length > 0) {
            return { text: text, el: this };
        }
    }).get();
}

function feedQueue() {
    if (ttsState !== 'speaking') return;
    
    // Maintain buffer
    while (processingIndex < totalChunks && processingIndex < currentChunk + BUFFER_SIZE) {
        let u = createUtterance(paragraphs[processingIndex]);
        synth.speak(u);
        processingIndex++;
    }
}

function playTTS() {
    paragraphs = getParagraphs();
    if (paragraphs.length === 0) {
        alert('Không có nội dung để đọc.');
        ttsState = 'idle';
        disableConnection(); // Cleanup
        updateTTSUI();
        return;
    }
    
    const resumeData = loadResumeState();
    if (resumeData && resumeData.total === paragraphs.length) {
        currentChunk = resumeData.index;
        totalChunks = resumeData.total;
        // processingIndex needs to match what we are about to play
        // Current chunk is what finished, so we start processing from currentChunk?
        // Wait, currentChunk is "index of just finished" in some contexts?
        // No, in loadResume, index is currentChunk.
        // If saved index is 5. means 0..4 played.
        // We start playing from 5 (index).
        // So processingIndex = currentChunk.
        processingIndex = currentChunk;
    } else {
        clearResumeState();
        currentChunk = 0;
        totalChunks = paragraphs.length;
        processingIndex = 0;
    }
    
    synth.cancel();
    ttsState = 'speaking';
    
    feedQueue();
    updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
}

$('#tts-rate').on('input', function() {
    $('#tts-rate-value').text(this.value);
    localStorage.setItem('tts-rate', this.value);
});

$('#tts-pitch').on('input', function() {
    $('#tts-pitch-value').text(this.value);
    localStorage.setItem('tts-pitch', this.value);
});

$('#tts-voice-select').on('change', function() {
    localStorage.setItem('tts-voice', this.value);
});

$('#tts-pause-btn').off('click').on('click', function() {
    if (ttsState === 'speaking') {
        synth.pause();
        ttsState = 'paused';
        disableConnection(); // Pause keep-alive
        updateTTSUI();
        saveResumeState();
    } else if (ttsState === 'paused') {
        enableConnection(); // Resume keep-alive
        synth.resume();
        ttsState = 'speaking';
        updateTTSUI();
    }
});

$('#tts-stop-btn').off('click').on('click', function() {
    synth.cancel();
    // clearResumeState(); // Stop doesn't necessarily clear resume, usually just pause? 
    // But UI says "Stop". Let's clear resume state to consistent with old behavior 
    // or maybe optional? Old behavior cleared it.
    clearResumeState();
    
    disableConnection(); // Stop keep-alive
    $('.current-reading').removeClass('current-reading'); // Cleanup
    ttsState = 'idle';
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();
});

// Visibility handler removed - TTS continues on tab switch

// Long-press to start TTS from selected paragraph (500ms hold)
let longPressTimer = null;
let longPressTarget = null;

// $('#chapter-content p').on('touchstart mousedown', function(e) {
//     longPressTarget = this;
//     longPressTimer = setTimeout(() => {
//         const allParagraphs = getParagraphs();
//         const startIndex = allParagraphs.findIndex(p => p.el === longPressTarget);

//         if (startIndex === -1) return;

//         clearResumeState();
//         synth.cancel();
        
//         paragraphs = allParagraphs;
//         currentChunk = startIndex;
//         totalChunks = paragraphs.length;
//         processingIndex = startIndex;
//         ttsState = 'speaking';
        
//         enableConnection();
//         feedQueue();
//         updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
//     }, 500);
// }).on('touchend touchmove mouseup mouseleave', function() {
//     clearTimeout(longPressTimer);
//     longPressTimer = null;
// });

synth.onvoiceschanged = populateVoices;
initTTS();


</script>





    
    <script src="/scripts/service-manager.js?r=4"></script>

    <script src="/scripts/app.js?id=a5a24eca66adcfc75cc0b2f62e2611db"></script>
    <script src="https://docln.net/vendor/livewire/livewire.min.js?id=df3a17f2"   data-csrf="i9KkJtKQpYiDiuTWoUTcq3lG14NYntqdwQfyy1Hz" data-update-uri="/livewire/update" data-navigate-once="true"></script>

    
    <script src="https://confidecross.com/d5/6b/4b/d56b4bd6c3d2c1e161c4ab3c78c27670.js" async></script>

        
            <footer id="footer">
    <div class="container">
        <!--<span><a href="">Hako.re</a></span>-->
        <span class="right">Liên hệ: <a href="mailto:contact@hako.vn" target="_blank" style="color: #5fff46">contact@hako.vn</a></span>

        <span>© 2016 - 2026 Cổng Light Novel - Đọc Light Novel</span>
    </div>
</footer>    
    <div x-data x-show="$store.toast.on" @click="$store.toast.hide()" class="bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fixed w-3/4 md:w-1/2 z-20 inset-x-0 bottom-10 mx-auto" role="alert" style="display: none">
    <div class="flex">
        <div class="py-1"><svg class="fill-current h-6 w-6 text-teal-500 mr-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"/></svg></div>
        <div>
            <p class="font-bold capitalize">Chú ý</p>
            <p class="text-sm" x-text="$store.toast.message"></p>
        </div>
    </div>
</div><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c8a382929042ca6',t:'MTc3MDIwODY0Ng=='};var a=document.createElement('script');a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
