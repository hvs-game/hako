<!DOCTYPE html>
<html lang="vi" class="light">
<head>
    <meta charset="utf-8">
    
    <title>Đọc Cục Cưng Chính Phái Giật Mình Tỉnh Dậy: Phản Diện Hóa Ra Là Chính Tôi - Chương 01: Gặp khó khăn là đi ngủ - Cổng Light Novel - Đọc Light Novel</title>

    <meta name="description" content="Cảm ơn đã mời, hiện đang mò cá (trốn việc), tinh thần đã &quot;toang&quot; từ lâu. Thanh niên hơn hai mươi tuổi nứt ra thành hai bé con vừa phế vừa đáng yêu mười mấy tuổi. Dạ Tinh Lam với tam quan vỡ nát quyết định buông xuôi để đối...">
    <meta name="theme-color" content="#000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="92UdDCEZwOWXCdM17t5XrHhHCJ2zsxFJG5nOrIIl">
    <meta name="logged-in" content="0">
    <meta property="fb:app_id" content="1864643850436909">

    <link rel="canonical" href="https://docln.net/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c288014-chuong-01-gap-kho-khan-la-di-ngu">
    <meta property="og:image" content="https://i.hako.vn/ln/series/covers/s24309-df2a557c-91c4-4dd4-88c9-72d576b878f0.jpg">


<style type="text/css">@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/devanagari/wght/normal.woff2);unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek/wght/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek-ext/wght/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek/400/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek-ext/400/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}</style>
    <link rel="preload" href="/fonts/OpenSans-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/fonts/OpenSans-SemiBold.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preconnect" href="https://www.google-analytics.com">

    <link rel="shortcut icon" href="/img/favicon.png?v=3">
    <link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon.png?v=3">
    <link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png?v=3">
    <link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png?v=3">

    <link rel="stylesheet" href="/css/interface.css?id=300c3109a58d319c9bb94c8585835c77">
    <link rel="stylesheet" href="/css/tailwind.css?id=c044c63e744fb1723a7d067aa1473af1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css" crossorigin="anonymous" />
            
    
    <script src="/scripts/plugins.js?id=b612d946b32459430eed3066ed15adf2"></script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-34864968-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
      gtag('config', 'UA-34864968-3');
    </script>
</head>

<body>
	
    <div x-data="{ open: Cookies.get('globalwarning2') === undefined ? true : false }">
    <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4" x-show="open" style="display: none">
        <div class="flex">
            <div class="shrink-0">
                <button x-on:click="open = false; Cookies.set('globalwarning2', false, { expires: 0.5 })" type="button" class="inline-flex rounded-md bg-yellow-50 p-1.5 text-yellow-500 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-600 focus:ring-offset-2 focus:ring-offset-yellow-50">
                    <span class="sr-only">Dismiss</span>
                    <svg class="size-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
                    <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z" />
                    </svg>
                </button>
            </div>
            <div class="ml-3 font-bold">
                <p class="text-sm text-yellow-700">
                Nếu không thể <a class="font-medium text-blue-700" href="/thao-luan/2898-ten-mien-da-bi-chan">truy cập trang web</a> xin vui lòng sử dụng DNS 
                <a class="font-medium text-blue-700" href="https://www.google.com/search?q=c%C3%A1ch+c%C3%A0i+dns+1.1.1.1" target="_blank">1.1.1.1</a> hoặc <a class="font-medium text-blue-700" href="https://docln.sbs" target="_blank">docln.sbs</a>
                
                </p>
                <p>
                    <p class="text-sm text-orange-700">Hiện đang đứt cáp Internet APG, kết nối có thể chậm hoặc rất chậm. Dùng VPN không chắc có hiệu quả.</p>
                </p>
            </div>

        </div>
    </div>
</div>



	<style>
    body {
        background: inherit;
    }

    #footer {
        display: none;
    }
    
    .current-reading {
        background-color: rgba(189, 224, 254, 0.3);
        border-left: 5px solid #007bff;
        padding-left: 10px;
        transition: background-color 0.3s ease;
    }
</style>


<main id="mainpart" class="reading-page style-4">
    <section id="rd-side_icon" class="none force-block-l" aria-hidden="true">
                <a class="rd_sd-button_item rd_top-left" href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c288011-chuong-38-nang-luong-loli-sac-day-roi"><i class="fas fa-backward"></i></a>
        
        <a class="rd_sd-button_item" href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi"><i class="fas fa-home"></i></a>     
        <a id="rd-setting_icon" data-affect="#" class="rd_sd-button_item"><i class="fas fa-font"></i></a>
        <a id="rd-tts_icon" class="rd_sd-button_item"><i class="fas fa-volume-up"></i></a>
        <a id="rd-info_icon" data-affect="#rd_sidebar.chapters" class="rd_sd-button_item"><i class="fas fa-info"></i></a>
        <a id="rd-bookmark_icon" data-affect="#rd_sidebar.bookmarks" class="rd_sd-button_item"><i class="fas fa-bookmark"></i></a>

        
                <a class="rd_sd-button_item rd_top-right" href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c291859-chuong-02-tim-kiem-su-giup-do-tu-thu-da-nhan"><i class="fas fa-forward"></i></a>
            </section>    
    
    <section id="chapters" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <header class="rd_sidebar-header clear">
                <a class="img" href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c288014-chuong-01-gap-kho-khan-la-di-ngu" style="background: url('https://i.hako.vn/ln/series/covers/s24309-df2a557c-91c4-4dd4-88c9-72d576b878f0.jpg') no-repeat"></a> 
                <div class="rd_sidebar-name">                    
                    <h5><a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi">Cục Cưng Chính Phái Giật...</a></h5>
                    <small><i class="fas fa-pen"></i>Xúc tu-san (觸手桑)</small>
                    <small><i class="fas fa-paint-brush"></i></small>                
                </div>
            </header>

            <ul id="chap_list" class="unstyled">
                                                            <li class=""><a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c273774-minh-hoa-nhan-vat-da-tinh">Minh họa &amp; Nhân vật</a></li>
                                        
                                                            <li class=""><a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c273654-chuong-01-trong-chan-co-mot-loli-toc-trang">Quyển 1: Một người, hai thân xác</a></li>
                                        
                                                            <li class="current"><a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/t35574-quyen-2-thanh-pho-bup-be">Quyển 2: Thành phố con rối</a></li>
                        <ul class="sub-chap_list unstyled">
                                                        <li  class="current" >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c288014-chuong-01-gap-kho-khan-la-di-ngu">
                                                                        Chương 01: Gặp khó khăn là đi ngủ
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c291859-chuong-02-tim-kiem-su-giup-do-tu-thu-da-nhan">
                                                                        Chương 02: Tìm kiếm sự giúp đỡ từ Thủ Dạ Nhân
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c291887-chuong-03-nuoc-mat-doi-khi-cung-co-tac-dung">
                                                                        Chương 03: Nước mắt đôi khi cũng có tác dụng
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c291895-chuong-04-linh-vat-pha-cach">
                                                                        Chương 04: Linh vật phá cách
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c291904-chuong-05-bi-quyet-de-ket-ban">
                                                                        Chương 05: Bí quyết để kết bạn
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c291919-chuong-6-khi-moc-ngau-su-gap-quan-dien-gia">
                                                                        Chương 06: Khi Mộc Ngẫu Sư gặp Quan Diễn Giả
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c291943-chuong-07-khong-duoc-de-nguoi-khac-lam-hong-dau-nhe">
                                                                        Chương 07: Không được để người khác làm hỏng đâu nhé
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c297428-chuong-08-ngu-chung">
                                                                        Chương 08: Ngủ chung
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c297431-chuong-09-bi-vay-ban-roi">
                                                                        Chương 09: Bị &quot;vấy bẩn&quot; rồi
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c297435-chuong-10-noi-dat-khach-que-nguoi-ngo-co-tri">
                                                                        Chương 10: Nơi đất khách quê người ngộ cố tri
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c297439-chuong-11-tinh-cach-con-nguoi-von-thich-su-chiet-trung">
                                                                        Chương 11: Tính cách con người vốn thích sự chiết trung
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c305072-chuong-12-cuoi-chet-mat">
                                                                        Chương 12: Cười chết mất
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c305075-chuong-13-thieu-nu-u-linh">
                                                                        Chương 13: Thiếu nữ u linh
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c305809-chuong-14-phai-tin-vao-khoa-hoc">
                                                                        Chương 14: Phải tin vào khoa học!
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c305813-chuong-15-tinh-thuc-u-linh">
                                                                        Chương 15: Tinh Thực u linh
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c305817-chuong-16-ham-muon-bieu-dien-manh-liet">
                                                                        Chương 16: Ham muốn biểu diễn mãnh liệt
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c306413-chuong-17-gap-go-nguoi-than">
                                                                        Chương 17: Gặp gỡ người thân
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c308169-chuong-18-co-cau-la-du-roi">
                                                                        Chương 18: Có cậu là đủ rồi
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c308177-chuong-19-rac">
                                                                        Chương 19: Rắc
                                </a>
                            </li>
                                                    </ul>
                                        
                                        
            </ul>
        </main>
        <div class="black-click"></div>
    </section>
    
    <section id="bookmarks" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <div class="rd_sidebar-header">
                <h2 class="rd_s-name"><i class="fas fa-bookmark"></i><a href="/bookmark" style="color: white;"> Bookmarks</a></h2>
            </div>
            <ul id="bookmarks_list" class="unstyled">
                                            <li>Bạn phải đăng nhập để sử dụng bookmark</li>
                                        </ul>
        </main>
        <div class="black-click"></div>
    </section>

    <section id="setting" class="rdtoggle" aria-hidden="true">
        <section class="re_set-in basic-section clear rdtoggle_body">
        <header class="sect-header"><span class="sect-title">Tùy chỉnh</span></header>
            <main class="sect-body">
                <div class="set-list set-color clear">
                    <label class="font-bold">Màu nền</label>
                    <div class="set-input clear justify-center">
                        <span data-color="#ffffff" data-id="0" style="background-color: #ffffff"></span>
                        <span data-color="#e6f0e6" data-id="1" style="background-color: #e6f0e6"></span>
                        <span data-color="#e3f5fa" data-id="2" style="background-color: #e3f5fa"></span>
                        <span data-color="#f6f4ec" data-id="3" style="background-color: #f6f4ec"></span>
                        <span data-color="#eae4d3" data-id="4" style="background-color: #eae4d3"></span>
                        <span data-color="#f5e9ef" data-id="5" style="background-color: #f5e9ef"></span>
                        <span data-color="#222222" data-id="6" style="background-color: #222222"></span>
                        <span data-color="#000000" data-id="7" style="background-color: #000000"></span>
                    </div>
                </div>
                <div class="set-list set-font-family clear">
                    <label class="font-bold">Font chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <select>
                            <option>Times New Roman</option>
                            <option>Merriweather</option>
                            <option>Lora</option>
                            <option>Roboto</option>
                            <option>Noto Sans</option>
                            <option>Nunito</option>
                        </select>
                    </div>
                </div>
                <div class="set-list set-font clear">
                    <label class="font-bold">Kích cỡ chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="16px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-margin clear">
                    <label class="font-bold">Bản lề</label>
                    <div class="set-slide set-input justify-center">
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="20px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-text-align clear">
                    <label class="font-bold">Kiểu căn chỉnh</label>
                    <div class="set-input clear justify-center font-medium text-2xl flex flex-row gap-10">
                        <span data-align="text-left" class="p-1"><i class="fas fa-align-left"></i></span>
                        <span data-align="text-center" class="p-1"><i class="fas fa-align-center"></i></span>
                        <span data-align="text-right" class="p-1"><i class="fas fa-align-right"></i></span>
                        <span data-align="text-justify" class="p-1"><i class="fas fa-align-justify"></i></span>
                    </div>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>

    <section id="tts-panel" class="rdtoggle" aria-hidden="true">
        <section class="tts-settings basic-section clear rdtoggle_body">
            <header class="sect-header"><span class="sect-title">Text-to-Speech</span></header>
            <main class="sect-body">
                <div class="set-list clear" style="color: red; font-size: 14px; margin-bottom: 20px">
                    Đây là chức năng đang thử nghiệm, chi tiết xem tại <a href="/thao-luan/3305-chuc-nang-doc" style="color: blue">Link</a>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Giọng đọc</label>
                    <select id="tts-voice-select" class="w-full p-2 border rounded bg-white dark:bg-gray-800 text-sm dark:border-gray-600"></select>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Tốc độ</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-rate" min="0.1" max="3" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-rate-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Độ cao (Pitch)</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-pitch" min="0" max="2" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-pitch-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="flex gap-2 pt-4">
                    <button id="tts-play-btn" class="flex-1 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Phát</button>
                    <button id="tts-pause-btn" class="flex-1 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Tạm dừng</button>
                    <button id="tts-stop-btn" class="flex-1 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Dừng</button>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>
    
    <div class="container">
        <div class="row">
            <div class="reading-content col-12 col-lg-10 offset-lg-1" style="word-wrap: break-word;">
                <div id="bookmark_top" class="block d-lg-none"><i class="fas fa-bookmark"></i></div>
                <span class="save_bookmark" style="position: absolute; top: 9999px; display: none"><i class="fas fa-bookmark"></i></span>
                
                
                
                <div class="title-top" style="padding-top: 20px">
                    <h2 class="title-item text-xl font-bold" align="center">Quyển 2: Thành phố con rối</h2>
                    <h4 class="title-item text-base font-bold" align="center">Chương 01: Gặp khó khăn là đi ngủ</h4>
                    <h6 class="title-item font-bold" align="center" aria-hidden="true">
                        <a href="https://docln.net/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c288014-chuong-01-gap-kho-khan-la-di-ngu#chapter-comments" style="text-decoration: underline">1 Bình luận</a> -
                        Độ dài: 1,772 từ - Cập nhật: 
                        <time class="topic-time timeago" title="09-01-2026 17:29:31" datetime="2026-01-09T17:29:31+07:00"></time>                    </h6>
                </div>

                <div style="text-align: center; margin: 20px auto -20px auto;">
                                                        </div>

                <div class="pt-6 mb-6 mx-auto max-w-4xl" x-data="{ open: Cookies.get('affiliation_popup_closed2') === undefined }" x-cloak>
                    <div id="affiliation-popup" x-show="open" style="display: none" class="bg-slate-900 rounded-xl overflow-hidden shadow-lg border !border-slate-800">
                        <div class="p-4 flex flex-col md:flex-row items-center gap-4">
                            <button x-on:click="open = false; Cookies.set('affiliation_popup_closed2', 'true', { expires: 0.5 })" class="text-gray-400 hover:text-white transition-colors p-2" aria-label="Close">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                            
                            <div class="flex-shrink-0">
                                <img src="https://i2.hako.vip/vault/992471336465223711.webp" alt="Pepe" class="w-16 h-16 rounded-md object-cover">
                            </div>

                            <div class="flex-grow text-center md:text-left">
                                <p class="text-white text-sm md:text-base font-medium">
                                    Click vào link khi MUA <span class="text-orange-500 font-bold uppercase">BẤT KỲ THỨ GÌ</span> trên <span class="text-orange-500 font-bold">Shopee</span> để hỗ trợ HAKO. Có thể được tặng mã Free ship khi mua.
                                </p>
                            </div>

                            <div class="flex flex-col sm:flex-row gap-3 w-full md:w-auto flex-shrink-0">
                                <a href="https://s.shopee.vn/4q9eci0DM3" target="_blank" class="flex-1 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white font-bold py-2 px-6 rounded shadow-md transition-all text-center whitespace-nowrap" rel="noopener noreferrer">
                                    Shopee
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="chapter-content" class="long-text no-select text-justify">
                    <p style="display: none">Chương 01: Gặp khó khăn là đi ngủ</p>
                    <p id="1">Trong căn phòng lập loè ánh đèn yếu ớt.</p><p id="2">Hai cô bé loli tóc bạc và tóc đen, lần lượt mặc đồ ngủ màu trắng và màu đen, đang nằm trên giường. Đó chính là Dạ Tinh và Dạ Lan, hay nói cách khác, là Dạ Tinh Lan.</p><p id="3">Cô không ngủ ngay lập tức mà đang suy nghĩ về vài chuyện. Về Tinh Tú của mình, liệu có thể dùng nó để làm những việc mình muốn không?</p><p id="4">Ví dụ như chuyện "mặn mòi" mà cô thích nhất... à không đúng, là biến tất cả mọi người trên thế giới thành những loli tóc bạc đáng yêu.</p><p id="5"><em>Ý tưởng này không tồi, ghi chú lại đã.</em></p><p id="6">Dạ Lan đưa bàn tay nhỏ nhắn trắng như sương ra, ôm lấy vòng eo thon gọn của Dạ Tinh, dán khuôn mặt mịn màng vào bụng nhỏ của đối phương, thân mật cọ xát vào lớp vải đồ ngủ mỏng manh, phát ra những tiếng "sột soạt" khe khẽ.</p><p id="7">Cảm giác hơi ngứa, nhưng cũng khá thoải mái.</p><p id="8">Thú thật mà nói, cô rất muốn lật lớp áo ngủ màu đen mỏng dính kia lên để "nếm" thử một cái, chắc hẳn sẽ có hương thơm thoang thoảng và cảm giác mềm mượt, nhưng nghĩ kỹ lại thì như thế cũng quá là mất liêm sỉ rồi. [note86748]</p><p id="9">"Cỗ Máy Ước Nguyện sao...? Mình thực sự có năng lực hiện thực hóa điều ước đó sao?"</p><p id="10">Qua quá trình không ngừng tìm hiểu, Dạ Tinh Lan đã biết mình có thể nguy hiểm ngang ngửa với Tinh Thực cấp Siêu Tân Tinh trong vụ [Thành Phố Búp Bê].</p><p id="11">Năng lực phá cách ở một mức độ nào đó đã đạt đến trình độ cực kỳ gian lận.</p><p id="12">Con người không nên nắm giữ sức mạnh khủng khiếp như vậy, nếu dùng tốt thì có thể đảo lộn mọi lẽ thường trên thế giới.</p><p id="13">Cô đã đọc sơ qua giới thiệu về sự kiện [Thành Phố Búp Bê], đó chẳng qua là do được giải quyết kịp thời mà thôi. Thảm họa quy mô đó đủ sức ảnh hưởng đến toàn bộ quốc gia. Nếu không phải các Thủ Dạ Nhân liều chết ngăn chặn, có lẽ mọi thứ đã tiêu đời nhà ma rồi.</p><p id="14">Dạ Tinh Lan lúc này đang nghĩ: Nếu cô biến thành Tinh Thực, sẽ gây ra thảm họa thế nào?</p><p id="15">Sẽ thực hiện điều ước của bất kỳ ai một cách không kiềm chế, hay là trực tiếp đảo ngược điều ước của người ta rồi mới thực hiện?</p><p id="16">Chẳng lẽ lại tệ hại như "Chén Thánh Đen" sao?</p><p id="17">"Ưm... thôi đừng nghĩ lung tung nữa, dù sao mình cũng sẽ không mất kiểm soát đâu."</p><p id="18">Vì việc mình mất kiểm soát có thể mang lại thảm họa cho những người xung quanh, nên chỉ cần tự khống chế bản thân là được. Vậy thì, trước tiên hãy ước một điều trong lòng đã.</p><p id="19">"Hy vọng mình sẽ mãi mãi không để [Cỗ Máy Ước Nguyện] bị mất kiểm soát..."</p><p id="20">Ừm, ý tứ đã gửi gắm xong, còn có thành hiện thực hay không thì phải xem Tinh Tú có nể mặt hay không đã.</p><p id="21">Nói cho cùng, đến tận bây giờ Dạ Tinh Lan vẫn chưa biết cách sử dụng Tinh Tú của mình. </p><p id="22">Nếu chỉ cần tiện miệng ước một câu là thành hiện thực, thì cả thế giới đã biến thành loli tóc bạc từ lâu rồi.</p><p id="23">Nói đến việc làm chủ Tinh Tú, thực sự không dễ dàng gì. Dạ Tinh Lan đã nhận được một số thông tin từ Tiêu Tiến. Nghe nói vào ngày Tinh Tú phá cách ra đời, hình như cũng là khoảng thời gian cô biến thành hai bé loli.</p><p id="24">Nói cách khác, đó được tính là đã thực hiện tâm nguyện của chính cô.</p><p id="25">Và lần thứ hai, chính là lúc giúp đỡ Bạch Ngư cách đây không lâu, cô cũng như ý nguyện mà giúp Bạch Ngư hồi phục.</p><p id="26">Ở đây có một điểm chung: Đó chính là đi ngủ!</p><p id="27">Đúng vậy, chính là ngủ đại một giấc. Lúc đó trước khi ngủ cô đều nói những lời tương tự như đang ước nguyện. Lần biến thành loli cũng vậy, lần đi vào câu chuyện của Bạch Ngư cũng thế.</p><p id="28">Chắc chắn là không sai vào đâu được.</p><p id="29">Vậy nên cơ chế của [Cỗ Máy Ước Nguyện] là phải nói vài lời ước nguyện trước khi ngủ đại một giấc, có đúng vậy không? Dạ Tinh Lan không chắc chắn lắm.</p><p id="30">"Ưm... hay là thử xem sao?"</p><p id="31">Thực tiễn mới đẻ ra chân lý. Dạ Tinh Lan dự định thử một phen. Dù sao bây giờ cũng chuẩn bị đi ngủ rồi. Cơ hội hiếm có này mà không xác thực dự đoán của mình thì đúng là có chút bứt rứt.</p><p id="32">"Nhưng mà nên ước điều gì đây?"</p><p id="33">Lần này Dạ Tinh Lan hơi do dự. Ước bậy bạ chắc chắn là không được, vạn nhất nó thành thật thì sao? Tuy cô muốn cả thế giới thành loli tóc bạc, nhưng đó cũng chỉ là ảo tưởng thôi.</p><p id="34">"Ưm..."</p><p id="35">Sau đó, Dạ Tinh Lan nhìn vào hai nửa con rối đặt trên bàn, trong lòng đã có ý tưởng.</p><p id="36">Nếu đã vậy, hãy ước một điều đơn giản thôi.</p><p id="37">Trước đó Dạ Tinh từng bảo Mộc Ngẫu Sư thử ước với mình, đó chỉ là suy đoán, rất khó kiểm chứng.</p><p id="38">Bây giờ cô cũng muốn thử. </p><p id="39">Nếu thành công, không chỉ chứng minh được dự đoán, làm chủ thêm sức mạnh Tinh Tú, mà còn sửa được con rối yêu quý của cô bé múa rối, nhất cử lưỡng tiện.</p><p id="40">Nhưng nếu thất bại thì cũng chẳng lỗ lả gì.</p><p id="41">"Phù~"</p><p id="42">Dạ Tinh và Dạ Lan đồng thời thở phào một hơi, đã sẵn sàng vào trạng thái ngủ. "Tắt đèn đi ngủ thôi~"</p><p id="43"><em>Cạch</em> một tiếng, căn phòng lập tức tối sầm lại. Thời gian chậm rãi trôi qua.</p><p id="44">Một lát sau, đôi mắt màu xanh lam và màu đỏ rực khẽ lóe lên trong bóng tối, hai người nhìn nhau, đều thấy rõ sự khổ sở trong mắt đối phương.</p><p id="45">"Làm sao bây giờ... hoàn toàn không ngủ được."</p><p id="46">Càng nghĩ nhiều trước khi ngủ thì càng khó ngủ, càng muốn ngủ thì càng mất ngủ.</p><p id="47">"Thử thả lỏng tâm trí trước đã..."</p><p id="48">Dạ Tinh và Dạ Lan nhắm mắt lại lần nữa. Cơn buồn ngủ cuối cùng cũng kéo đến. Sau đó, hai tiếng thở khẽ và đều đặn vang lên trong phòng. Hai bé loli đã chìm vào giấc mộng.</p><p id="49">Giây tiếp theo, thời không sai lệch, một màn đêm hư vô bao trùm lấy hai dáng người nhỏ nhắn trên giường.</p><p id="50">......</p><p id="51">Khi Dạ Tinh và Dạ Lan mở mắt ra, họ phát hiện trời đã sáng. Cả hai lờ đờ ngồi dậy, dụi dụi đôi mắt ngái ngủ, cuối cùng cũng tỉnh táo hơn nhiều.</p><p id="52">"Thất bại rồi sao...?" Biểu cảm của Dạ Tinh và Dạ Lan có chút hụt hẫng, dường như rất thất vọng vì dự đoán của mình không được xác thực.</p><p id="53">"Ưm... cứ ngỡ là sẽ thành công chứ, không ngờ dự đoán của mình lại sai sao? Hu hu hu~"</p><p id="54">Nhưng thất vọng thì thất vọng, cuộc sống vẫn phải tiếp tục. Hôm nay Dạ Lan cũng phải giữ tâm trạng tốt để đi gặp Linh Miêu và Bạch Ngư! Còn Dạ Tinh thì tiếp tục ở nhà nghiên cứu cách sửa con rối của cô bé múa rối vậy.</p><p id="55">Nói đến con rối. Dạ Tinh và Dạ Lan nhìn về phía chiếc bàn nơi đặt con rối hôm qua.</p><p id="56">"Hả?"</p><p id="57">"Con rối... biến mất rồi!"</p><p id="58">Đồng tử của Dạ Tinh và Dạ Lan hơi giãn ra, lập tức nhảy dựng từ trên giường xuống, bắt đầu tìm kiếm kỹ lưỡng xem có phải nó rơi vào khe hở nào không. Kết quả là lật tung cả căn phòng lên vẫn không thấy đâu.</p><p id="59">"Oa... rốt cuộc là nó biến mất kiểu gì vậy? Rõ ràng hôm qua đặt ở đây mà, lẽ nào bị chuột tha đi rồi sao? Phen này tiêu đời rồi..."</p><p id="60">Vẻ mặt Dạ Tinh vô cùng thất vọng. Bây giờ cô làm mất con rối của người ta, không biết phải ăn nói thế nào với cô bé múa rối nữa. Chẳng lẽ phải trở thành "con rối" của cô bé ấy thật sao?</p><p id="61">Đến nước này cũng chẳng còn cách nào khác. Hôm nay cứ qua đó xin lỗi cậu ấy tử tế vậy. Rồi cố gắng bù đắp cho em ấy sau. Còn Dạ Lan thì vẫn phải đến căn cứ Thủ Dạ Nhân để học hỏi kiến thức.</p><p id="62">Dạ Lan cầm điện thoại lên xem giờ. Ngày 16 tháng 9 năm 2100, khoảng 9 giờ sáng.</p><p id="63">"Ưm... mới 9 giờ, ăn sáng rồi đi vậy."</p><p id="64">Dạ Lan vừa đặt điện thoại xuống, cơ thể bỗng dưng cứng đờ lại. Chờ đã, cô vừa nhìn thấy cái gì? Dạ Lan vội vàng cầm điện thoại lên nhìn lại lần nữa để xác nhận xem mình có nhìn nhầm không.</p><p id="65">Ngày 16 tháng 9 năm 2100.</p><p id="66">"Mẹ ơi! Cái quái gì thế này?!"</p><p id="67">Dạ Lan có chút hoảng sợ, còn tưởng mình vẫn đang nằm mơ. Cô và Dạ Tinh nhéo má nhau một cái, nhưng cả hai đều cảm thấy đau. "Oa~ không phải mơ, là thật..."</p><p id="68">Dạ Tinh Lan bắt đầu luống cuống chân tay. Rõ ràng trước đó đang là cuối tháng 11 năm 2101 mà, sao tự dưng lại quay về quá khứ rồi?</p><p id="69">"Chờ đã, hình như mình đã bỏ sót điều gì đó..." Dạ Lan cúi đầu trầm tư, rồi vỗ mạnh vào lòng bàn tay. "Hiểu rồi, đây là hiệu ứng Tinh Tú của mình!"</p><p id="70">Dù sao thì lúc tham gia vào sự kiện của Bạch Ngư cũng từng xảy ra chuyện tương tự, nên không khó để xác nhận. Nhận ra điều này, Dạ Tinh Lan lập tức hết hoảng loạn, thay vào đó là một cảm giác phấn khích.</p><p id="71">Nhưng phấn khích chưa được bao lâu, vấn đề mới lại nảy sinh.</p><p id="72">Cô nhớ trước khi ngủ mình ước là muốn sửa xong con rối mà. Điều ước này đáng lẽ phải đơn giản lắm chứ, tại sao đột nhiên lại quay về mốc thời gian này?</p><p id="73">"Ưm..." Dạ Tinh và Dạ Lan đồng thời đứng dậy.</p><p id="74">Sư phụ Dạ sau khi suy nghĩ nửa ngày trời, quyết định đi ăn chút gì đó để lấp đầy cái bụng trước đã.</p>

                    <p style="display: none">Hãy bình luận để ủng hộ người đăng nhé!</p>
                    
                    <!-- <div class="flex justify-center mt-10 mb-7 space-x-3">
                        <a
                            href="https://hako.vn/discord"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #7289da; text-decoration: initial; color: white !important;">
                            <svg
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                xmlns="http://www.w3.org/2000/svg"
                                fill-rule="evenodd"
                                clip-rule="evenodd"
                                viewbox="0 0 24 24">
                                <path
                                d="M19.54 0c1.356 0 2.46 1.104 2.46 2.472v21.528l-2.58-2.28-1.452-1.344-1.536-1.428.636 2.22h-13.608c-1.356 0-2.46-1.104-2.46-2.472v-16.224c0-1.368 1.104-2.472 2.46-2.472h16.08zm-4.632 15.672c2.652-.084 3.672-1.824 3.672-1.824 0-3.864-1.728-6.996-1.728-6.996-1.728-1.296-3.372-1.26-3.372-1.26l-.168.192c2.04.624 2.988 1.524 2.988 1.524-1.248-.684-2.472-1.02-3.612-1.152-.864-.096-1.692-.072-2.424.024l-.204.024c-.42.036-1.44.192-2.724.756-.444.204-.708.348-.708.348s.996-.948 3.156-1.572l-.12-.144s-1.644-.036-3.372 1.26c0 0-1.728 3.132-1.728 6.996 0 0 1.008 1.74 3.66 1.824 0 0 .444-.54.804-.996-1.524-.456-2.1-1.416-2.1-1.416l.336.204.048.036.047.027.014.006.047.027c.3.168.6.3.876.408.492.192 1.08.384 1.764.516.9.168 1.956.228 3.108.012.564-.096 1.14-.264 1.74-.516.42-.156.888-.384 1.38-.708 0 0-.6.984-2.172 1.428.36.456.792.972.792.972zm-5.58-5.604c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332.012-.732-.54-1.332-1.224-1.332zm4.38 0c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332 0-.732-.54-1.332-1.224-1.332z" />
                            </svg>
                            Discord
                        </a>
                        <a
                            href="https://fb.com/hako.page"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #1877f2; text-decoration: initial; color: white !important;">
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                viewBox="0 0 24 24">
                                <path
                                d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z" />
                            </svg>
                            Facebook
                        </a>
                    </div> -->

                                        <a href="/truyen/8476" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/8476/3269685b-c0ef-4013-a7d6-74104f39a24c.jpg?t=1739894654" class="d-none d-md-block" style="width: 970px; height: auto">
                    </a>
                    <a href="/truyen/8476" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/8476/bf1184be-cf52-429e-8acb-0d29fb4eea33.jpg?t=1739894654" class="d-md-none" style="width: 100%; height: auto">
                    </a>
                    
                                        <div class="note-reg">
                        <h2 align="center" style="margin-bottom: 40px;">Ghi chú</h2>
                                                    <div style="margin-bottom: 20px;" id="note86748"><a href="#anchor-note86748" class="none-print inline" style="margin-right: 10px"><i class="fas fa-caret-up"></i></a><a href="#anchor-note86748" class="inline-print none">[Lên trên] </a><div style="display: none"><span class="note-content long-text">MỠ DÂNG ĐẾN MIỆNG RỒI MÀ SAO KHÔNG ĂNNNNN</span></div><span class="note-content_real long-text">MỠ DÂNG ĐẾN MIỆNG RỒI MÀ SAO KHÔNG ĂNNNNN</span></div>
                                            </div>
                                    </div>

                <div style="text-align: center; margin: 20px auto 10px auto;">
                                                        </div>
                
                <section class="rd-basic_icon row">
                    <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c288011-chuong-38-nang-luong-loli-sac-day-roi" class="dark:text-black col text-center "><i class="fas fa-backward"></i></a>
                    <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi" class="dark:text-black col text-center"><i class="fas fa-home"></i></a>
                    <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c291859-chuong-02-tim-kiem-su-giup-do-tu-thu-da-nhan" class="dark:text-black col text-center "><i class="fas fa-forward"></i></a>
                </section>
                
                <!--the code style is important to keep this comment section be out of the effect of user reading's setting-->
            </div>
            <div class="col-12 col-lg-10 offset-lg-1" aria-hidden="true">
                <section id="chapter-comments" class="basic-section dark:bg-[#1f1f1f] dark:text-white dark:border dark:border-[#1f1f1f]">
                    <header class="sect-header tab-list dark:bg-[#2a2a2a] dark:border-[#2a2a2a]"> 
                        <span class="sect-title tab-title" data-tab-index="1">Bình luận <span class="comments-count">(1)</span></span>
                    </header>
                    <main id="fbcmt_root" class="sect-body">
                        <span style="padding: 10px; display: inline-block;">Báo cáo bình luận không phù hợp ở <a href="/thao-luan/619-bao-cao-binh-luan" style="color: blue">đây</a></span>
                        <div id="tab-content-1" class="tab-content clear">
                            <section class="ln-comment">
    <header>
        <h3 class="text-lg font-bold dark:text-white">1 Bình luận </h3>
        <!-- <i id="refresh_comment" class="fas fa-refresh" aria-hidden="true" style="margin-left: 10px; font-size: 18px"></i></h3> -->
            </header>

    <main class="ln-comment-body">
                    <div class="ln-comment_sign-in long-text">
                Bạn phải <a href="/login">đăng nhập</a> hoặc <a href="/register">tạo tài khoản</a> để bình luận.
            </div>
                
        
        
        <div class="ln-comment-group">
    <div id="ln-comment-3157030"
    class="ln-comment-item mt-3 clear"
    data-comment="3157030" 
    data-parent="3157030" 
    data-type="chapter" 
    data-typeid="288014">
    <div class="flex gap-1 max-w-full">
        <div class="w-[50px]">
            <div class="mx-1 my-1">
                <img src="https://i.hako.vn/ln/users/avatars/u124707-9592ad7b-ddd9-459e-9504-f803cf71fbc8.jpg" class="w-full rounded-full" />
            </div>
        </div>
        <div
            class="w-full min-w-0 rounded-md bg-gray-100 ps-1 pe-0 pb-1 pt-0 dark:!bg-zinc-800 ">
            <div class="flex min-w-0 flex-col px-2">
                <div class="flex align-top justify-between">
                    <div class="flex flex-wrap gap-x-2 gap-y-1 align-middle pt-1">
    <div class="self-center">
        <a class="font-bold leading-6 md:leading-7 ln-username " href="/thanh-vien/124707">Thgames1997</a>
    </div>
                                    </div>
                                        
                </div>
                                                    <div class="ln-comment-content long-text">
                        :^)
                    </div>
                    <div class="comment_see_more expand none">Xem thêm</div>
                    <div class="flex gap-2 align-bottom text-[13px] visible-toolkit">
                        <a href="/truyen/24309-doan-sung-chinh-phai-giat-minh-tinh-day-phan-dien-hoa-ra-la-chinh-toi/c288014-chuong-01-gap-kho-khan-la-di-ngu?comment_id=3157030#ln-comment-3157030"
                            class="text-slate-500">
                            <time class="timeago" title="09-01-2026 19:11:56"
                                datetime="2026-01-09T19:11:56+07:00">
                                09-01-2026 19:11:56
                            </time>
                        </a>
                        <a
                            class="self-center visible-toolkit-item do-like cursor-pointer">
                            <i class="fas fa-thumbs-up me-1"></i>
                            <span class="likecount font-semibold"></span>
                        </a>
                                            </div>
                            </div>
        </div>
    </div>
</div>

    </div>

<div class="ln-comment-page">
</div>    </main>

    <script>
        var token = '92UdDCEZwOWXCdM17t5XrHhHCJ2zsxFJG5nOrIIl';
        var comment_type = 'chapter';
        var comment_typeid = '288014';
    </script>

    </section>


                        </div>
                    </main>
                </section>
            </div> 
        </div>
    </div>
</main>

<script>
    token = '92UdDCEZwOWXCdM17t5XrHhHCJ2zsxFJG5nOrIIl';
        
    function turnoffall() {
        $(".rdtoggle").removeClass("on");
        $(".rdtoggle_body").removeClass("animation fade-in-left-big fade-in-down");
        $("html").removeClass("overflow-hiden");
    }
    
    function rdtoggle(classicon, effect) {
        if ($(classicon).hasClass("on")) {
            turnoffall();
        } else {
            turnoffall();
            $(classicon).addClass("on");
            $("html").addClass("overflow-hiden");
            $(classicon + " .rdtoggle_body").addClass("animation " + effect);
        } 
    };
    
    $("#rd-setting_icon").on('click', function() {
        rdtoggle("#setting", "fade-in-down");                   
    });

    $("#rd-tts_icon").on('click', function() {
        rdtoggle("#tts-panel", "fade-in-down");
    });
        
    $("#rd-info_icon").on('click', function() {
        rdtoggle("#chapters", "fade-in-left-big");              
    });
        
    $("#rd-bookmark_icon").on('click', function() {
        rdtoggle("#bookmarks", "fade-in-left-big");                     
    });
        
    $(".black-click").on('click', function() {
        turnoffall();
        $("#rd-side_icon").hide();
        $("#bookmark_top").removeClass("on");
    });
        
    var bgcolor    = Cookies.get('color') || (Cookies.get('night_mode') ? 6 : 4);
    var fontfamily = Cookies.get('fontfamily') || '';
    var fontsize   = Cookies.get('font') || 18; 
    var margin     = Cookies.get('margin') || 0;
    var textAlign  = Cookies.get('textAlign') || 'text-justify';
        
    function setcolor(alter = true) {
        var switcher = $(".set-color .set-input span").eq(bgcolor);
        switcher.addClass("current");

        if (alter) {
            for (var i = 0; i < $(".set-color .set-input span").length; i++) {
                $("#mainpart").removeClass('style-' + i);
                $("#mainpart").removeClass('dark');
            }
            $("#mainpart").addClass('style-' + bgcolor);

            // Manually hardcoded to dark
            if (bgcolor >= 6) {
                $("#mainpart").addClass('dark');
            }
        }
    }

    // This creates unsmooth experience so we only use it for select box
    function setfontfamily() {
        $('.set-font-family select option').filter(function () {
            return fontfamily.split(',')[0].indexOf($(this).text()) != -1 ;
        }).attr('selected', true);
    }
        
    function setfontstyle(alter = true) {
        $(".set-font input.set-slide_input").val(fontsize + "px"); 

        if (alter) {
            $("div#chapter-content").css("font-size", fontsize + "px");

            var lineheight = +fontsize + 10;
            $("#chapter-content").css("line-height", lineheight + "px");
        }
    }
        
    function setmargin() {
        $(".set-margin input.set-slide_input").val(margin + "px"); 
        $("#chapter-content").css({
            'padding-left': margin + "px",
            'padding-right': margin + "px"
        });
    }

    function setTextAlign(alter = true) {
        var switcher = $(".set-text-align .set-input span[data-align='" + textAlign + "']");
        switcher.addClass("current");

        if (alter) {
            $(".set-text-align .set-input span").each(function () {
                $("#chapter-content").removeClass($(this).attr('data-align'));
            });

            $("#chapter-content").addClass(textAlign);
        }
    }
    
    setcolor(false);
    setfontfamily();
    setfontstyle(false);
    setmargin();
    setTextAlign(true);
    
    //1px = 0.0625rem;
    //16px = 1rem (default);
    
    $(".set-color .set-input span").click(function(){
        bgcolor = $(this).data("id");
        $(".set-color .set-input span").removeClass("current");
        setcolor();            
        Cookies.set('color', bgcolor, { expires: 365 });
    });

    $('.set-font-family select').on('change', function () {
        fontfamily = "'" + $('option:selected', this).text() + "', " + '\'Times New Roman\', Georgia, serif';
        
        $('div#chapter-content').css('font-family', fontfamily);

        Cookies.set('fontfamily', fontfamily, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-smaller").click(function () {
        fontsize = fontsize - 2;
        if (fontsize < 0) fontsize = 0;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-bigger").click(function () {
        fontsize = +fontsize + 2;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-smaller").click(function () {
        margin = margin - 20;
        if (margin < 0) margin = 0;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-bigger").click(function () {
        margin = +margin + 20;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    }); 

    $(".set-text-align .set-input span").click(function(){
        textAlign = $(this).data("align");
        $(".set-text-align .set-input span").removeClass("current");
        setTextAlign();        
        Cookies.set('textAlign', textAlign, { expires: 365 });
    });
        
    $("#bookmarks_list li").each(function(){
        var linepr = $(this).data("line");
        var preview = $(".reading-content p#" + linepr).text();

        var shortText = preview.trim().substring(0, 30) + "...";
        $(this).find(".pos_bookmark small").text(shortText);
    });

    $('div#chapter-content').html(
        $('div#chapter-content').html().replace(
            /\[note(\d+)\]/gi, 
            '<span id="anchor-note$1" class="note-icon none-print inline note-tooltip" data-tooltip-content="#note$1 .note-content" data-note-id="note$1"><i class="fas fa-sticky-note"></i></span><a id="anchor-note$1" class="inline-print none" href="#note$1">[note]</a>'
        )
    )
    
    tippy('.note-tooltip', {
        delay: 50,
        maxWidth: 240,
        interactive: true,
        content(ref) {
            const selector = ref.getAttribute('data-tooltip-content');
            const template = document.querySelector(selector);
            return template ? template.innerHTML : 'Đặt sai ID của note';
        }
    });
        
    isLoggedIn = 0;
    series_id = parseInt('24309');
    chapter_id = parseInt('288014');

    readingObject = {
        series_id: series_id,
        series_title: 'Cục Cưng Chính Phái Giật Mình Tỉnh Dậy: Phản Diện Hóa Ra Là Chính Tôi',
        series_url: $('i.fa-home').first().parent().attr('href'),
        series_cover: $('.rd_sidebar-header a.img').css('background-image'),
        chapter_title: $('ul.sub-chap_list li.current a').text().trim(),
        chapter_url: $('ul.sub-chap_list li.current a').attr('href'),
        book_title: $('ul#chap_list > li.current a').text(),
        book_url: $('ul#chap_list > li.current a').attr('href'),
        read_time: +new Date() / 1000 | 0,
    };

// TTS Manager - Enhanced Web Speech API (Vietnamese). Chunked queue for long texts, no delays/interrupts.
const synth = window.speechSynthesis;
let voices = [];
let voicesLoaded = false;
let ttsRate = parseFloat(localStorage.getItem('tts-rate')) || 1;
let ttsPitch = parseFloat(localStorage.getItem('tts-pitch')) || 1;
let ttsState = 'idle'; // idle, speaking, paused, loading
let currentChunk = 0;
let totalChunks = 0;
let processingIndex = 0;
let paragraphs = [];
const BUFFER_SIZE = 5;

// --- Background Persistence (Wake Lock + Silent Audio) ---
let wakeLock = null;
const silentAudio = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTSVNFAAAAPAAADEVuY29kZWQgd2l0aCBMYW1lMy4xMDBhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUA==');
silentAudio.loop = true;

async function enableConnection() {
    // 1. Start Silent Audio Loop (tricks browser into thinking we are a music player)
    try {
        await silentAudio.play();
    } catch (err) {
        console.warn('Silent Audio Play Failed (likely no interaction):', err);
    }

    // 2. Request Screen Wake Lock (prevents screen from sleeping automatically)
    if ('wakeLock' in navigator) {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (err) {
            console.warn('Wake Lock Request Failed:', err);
        }
    }
}

function disableConnection() {
    // 1. Stop Silent Audio
    try {
        silentAudio.pause();
        silentAudio.currentTime = 0;
    } catch (e) {}

    // 2. Release Wake Lock
    if (wakeLock) {
        try {
            wakeLock.release();
            wakeLock = null;
        } catch (e) {}
    }
}

// Re-acquire Wake Lock if visibility changes and we are speaking
document.addEventListener('visibilitychange', async () => {
    if (wakeLock !== null && document.visibilityState === 'visible' && ttsState === 'speaking') {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (e) {}
    }
});
// ---------------------------------------------------------

let ttsVoiceIdx = localStorage.getItem('tts-voice') || '0';

function populateVoices() {
    voices = synth.getVoices().filter(v => v.lang.startsWith('vi'));
    voicesLoaded = true;
    let $select = $('#tts-voice-select');
    $select.empty();

    if (voices.length === 0) {
        $select.append('<option value="-1">Không có giọng Việt (cài Chrome/Edge)</option>');
        return;
    }

    voices.forEach((voice, idx) => {
        $select.append(`<option value="${idx}">${voice.name} (${voice.lang}) ${voice.default ? '(mặc định)' : ''}</option>`);
    });

    let idx = Math.max(0, Math.min(parseInt(ttsVoiceIdx), voices.length - 1));
    $select.val(idx);
}

function updateTTSUI(progress = '') {
    let $icon = $('#rd-tts_icon i');
    $icon.removeClass('fa-volume-up fa-volume-mute fa-spinner fa-spin');
    let $playBtn = $('#tts-play-btn'), $pauseBtn = $('#tts-pause-btn'), $stopBtn = $('#tts-stop-btn');
    $playBtn.prop('disabled', ttsState === 'speaking' || ttsState === 'loading'); // Enable on idle/paused
    $pauseBtn.prop('disabled', ttsState === 'idle');
    $stopBtn.prop('disabled', ttsState === 'idle');
    // Always remove old progress
    $('#tts-progress').remove();

    if (progress && totalChunks > 0) {
        $playBtn.after(`<span id="tts-progress" class="text-xs block text-center mt-1">${progress}</span>`);
    }

    if (ttsState === 'idle') {
        // Check resume preview
        const resumeData = loadResumeState();
        let currentParagraphs = $('#chapter-content p').map(function() {
            return $(this).text().trim();
        }).get().filter(p => p.trim().length > 0);

        if (resumeData && resumeData.total === currentParagraphs.length) {
            $playBtn.text(`Tiếp tục (${resumeData.index + 1}/${resumeData.total})`);
        } else {
            $playBtn.text('Phát');
        }

        $icon.addClass('fa-volume-up');
    } else if (ttsState === 'speaking' || ttsState === 'loading') {
        $icon.addClass('fa-volume-up fa-spinner fa-spin');
    } else if (ttsState === 'paused') {
        $icon.addClass('fa-volume-mute');
    }
}

$('#tts-play-btn').off('click').on('click', function() {
    // Always restart/resume from storage
    enableConnection(); // Start keep-alive
    synth.cancel();
    ttsState = 'idle';
    // queuedUtterances = []; // Removed global queue
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();

    if (!voicesLoaded || voices.length === 0) {
        ttsState = 'loading';
        updateTTSUI();
        setTimeout(() => {
            if (!voicesLoaded) {
                alert('Giọng nói chưa tải. Thử lại.');
                ttsState = 'idle';
                updateTTSUI();
                return;
            }
            playTTS();
        }, 500);
        return;
    }

    playTTS();
});

function createUtterance(item) {
    let u = new SpeechSynthesisUtterance(item.text);
    u.lang = 'vi-VN';
    u.rate = parseFloat($('#tts-rate').val()) || 1;
    u.pitch = parseFloat($('#tts-pitch').val()) || 1;
    let voiceIdx = parseInt($('#tts-voice-select').val());

    if (voiceIdx >= 0 && voices[voiceIdx]) {
        u.voice = voices[voiceIdx];
    }

    u.onstart = () => {
        currentChunk++;
        saveResumeState();
        updateTTSUI(`${currentChunk}/${totalChunks}`);
        
        // Highlight logic
        $('.current-reading').removeClass('current-reading');
        if (item.el) {
            $(item.el).addClass('current-reading');
            item.el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        feedQueue(); // Ensure buffer is maintained
    };
    u.onerror = (event) => {
        console.error('TTS Error:', event.error, event);

        if (event.error !== 'interrupted') {
             // alert(`Lỗi TTS: ${event.error}. Bỏ qua đoạn.`);
             console.warn('TTS Error skipping chunk', event.error);
        }

        saveResumeState(); // Save on error
        feedQueue();
    };
    u.onend = () => {
        saveResumeState();

        if (currentChunk >= totalChunks) {
            clearResumeState();
            $('.current-reading').removeClass('current-reading'); // Cleanup
            
            // Auto-Next Logic
            let $nextBtn = $('.rd-basic_icon a').last();
            if ($nextBtn.length && !$nextBtn.hasClass('disabled')) {
                localStorage.setItem('tts-autoplay', 'true');
                window.location.href = $nextBtn.attr('href');
                return;
            }

            ttsState = 'idle';
            disableConnection(); // Cleanup
            currentChunk = 0;
            totalChunks = 0;
            processingIndex = 0;
            updateTTSUI();
        } else {
            feedQueue();
        }
    };
    u.onpause = () => { saveResumeState(); };
    return u;
}

function getStorageData() {
    try {
        return JSON.parse(localStorage.getItem('tts-resume-data')) || {};
    } catch {
        return {};
    }
}

function setStorageData(data) {
    localStorage.setItem('tts-resume-data', JSON.stringify(data));
}

function saveResumeState() {
    if (totalChunks > 0) {
        const data = getStorageData();
        data[chapter_id] = {
            index: currentChunk,
            total: totalChunks,
            timestamp: Date.now()
        };
        // Optional: Clean up old entries (older than 7 days?) to prevent infinite growth, 
        // but for now we just save.
        setStorageData(data);
    }
}

function clearResumeState() {
    const data = getStorageData();

    if (data[chapter_id]) {
        delete data[chapter_id];
        setStorageData(data);
    }
}

function loadResumeState() {
    const data = getStorageData();
    const saved = data[chapter_id];
    
    if (!saved) return null;
    
    if (Date.now() - saved.timestamp > 3600000 * 24 * 7) { // 7 days
        clearResumeState();
        return null;
    }

    return saved;
}

function initTTS() {
    populateVoices();
    $('#tts-rate').val(ttsRate);
    $('#tts-rate-value').text(ttsRate);
    $('#tts-pitch').val(ttsPitch);
    $('#tts-pitch-value').text(ttsPitch);
    updateTTSUI();
    
    if (localStorage.getItem('tts-autoplay') === 'true') {
        localStorage.removeItem('tts-autoplay');
        $(window).on('load', function() {
             setTimeout(() => {
                 $('#tts-play-btn').click(); 
             }, 500); 
        });
    }
}

function getParagraphs() {
    return $('#chapter-content p').map(function() {
        let text = $(this).text().trim();
        
        // If paragraph contains an image, replace with "Hình ảnh"
        if ($(this).find('img').length > 0) {
            text = 'Hình ảnh';
        }
        
        if (text.length > 0) {
            return { text: text, el: this };
        }
    }).get();
}

function feedQueue() {
    if (ttsState !== 'speaking') return;
    
    // Maintain buffer
    while (processingIndex < totalChunks && processingIndex < currentChunk + BUFFER_SIZE) {
        let u = createUtterance(paragraphs[processingIndex]);
        synth.speak(u);
        processingIndex++;
    }
}

function playTTS() {
    paragraphs = getParagraphs();
    if (paragraphs.length === 0) {
        alert('Không có nội dung để đọc.');
        ttsState = 'idle';
        disableConnection(); // Cleanup
        updateTTSUI();
        return;
    }
    
    const resumeData = loadResumeState();
    if (resumeData && resumeData.total === paragraphs.length) {
        currentChunk = resumeData.index;
        totalChunks = resumeData.total;
        // processingIndex needs to match what we are about to play
        // Current chunk is what finished, so we start processing from currentChunk?
        // Wait, currentChunk is "index of just finished" in some contexts?
        // No, in loadResume, index is currentChunk.
        // If saved index is 5. means 0..4 played.
        // We start playing from 5 (index).
        // So processingIndex = currentChunk.
        processingIndex = currentChunk;
    } else {
        clearResumeState();
        currentChunk = 0;
        totalChunks = paragraphs.length;
        processingIndex = 0;
    }
    
    synth.cancel();
    ttsState = 'speaking';
    
    feedQueue();
    updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
}

$('#tts-rate').on('input', function() {
    $('#tts-rate-value').text(this.value);
    localStorage.setItem('tts-rate', this.value);
});

$('#tts-pitch').on('input', function() {
    $('#tts-pitch-value').text(this.value);
    localStorage.setItem('tts-pitch', this.value);
});

$('#tts-voice-select').on('change', function() {
    localStorage.setItem('tts-voice', this.value);
});

$('#tts-pause-btn').off('click').on('click', function() {
    if (ttsState === 'speaking') {
        synth.pause();
        ttsState = 'paused';
        disableConnection(); // Pause keep-alive
        updateTTSUI();
        saveResumeState();
    } else if (ttsState === 'paused') {
        enableConnection(); // Resume keep-alive
        synth.resume();
        ttsState = 'speaking';
        updateTTSUI();
    }
});

$('#tts-stop-btn').off('click').on('click', function() {
    synth.cancel();
    // clearResumeState(); // Stop doesn't necessarily clear resume, usually just pause? 
    // But UI says "Stop". Let's clear resume state to consistent with old behavior 
    // or maybe optional? Old behavior cleared it.
    clearResumeState();
    
    disableConnection(); // Stop keep-alive
    $('.current-reading').removeClass('current-reading'); // Cleanup
    ttsState = 'idle';
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();
});

// Visibility handler removed - TTS continues on tab switch

// Long-press to start TTS from selected paragraph (500ms hold)
let longPressTimer = null;
let longPressTarget = null;

// $('#chapter-content p').on('touchstart mousedown', function(e) {
//     longPressTarget = this;
//     longPressTimer = setTimeout(() => {
//         const allParagraphs = getParagraphs();
//         const startIndex = allParagraphs.findIndex(p => p.el === longPressTarget);

//         if (startIndex === -1) return;

//         clearResumeState();
//         synth.cancel();
        
//         paragraphs = allParagraphs;
//         currentChunk = startIndex;
//         totalChunks = paragraphs.length;
//         processingIndex = startIndex;
//         ttsState = 'speaking';
        
//         enableConnection();
//         feedQueue();
//         updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
//     }, 500);
// }).on('touchend touchmove mouseup mouseleave', function() {
//     clearTimeout(longPressTimer);
//     longPressTimer = null;
// });

synth.onvoiceschanged = populateVoices;
initTTS();


</script>





    
    <script src="/scripts/service-manager.js?r=4"></script>

    <script src="/scripts/app.js?id=a5a24eca66adcfc75cc0b2f62e2611db"></script>
    <script src="https://docln.net/vendor/livewire/livewire.min.js?id=df3a17f2"   data-csrf="92UdDCEZwOWXCdM17t5XrHhHCJ2zsxFJG5nOrIIl" data-update-uri="/livewire/update" data-navigate-once="true"></script>

    
    <script src="https://confidecross.com/d5/6b/4b/d56b4bd6c3d2c1e161c4ab3c78c27670.js" async></script>

        
            <footer id="footer">
    <div class="container">
        <!--<span><a href="">Hako.re</a></span>-->
        <span class="right">Liên hệ: <a href="mailto:contact@hako.vn" target="_blank" style="color: #5fff46">contact@hako.vn</a></span>

        <span>© 2016 - 2026 Cổng Light Novel - Đọc Light Novel</span>
    </div>
</footer>    
    <div x-data x-show="$store.toast.on" @click="$store.toast.hide()" class="bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fixed w-3/4 md:w-1/2 z-20 inset-x-0 bottom-10 mx-auto" role="alert" style="display: none">
    <div class="flex">
        <div class="py-1"><svg class="fill-current h-6 w-6 text-teal-500 mr-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"/></svg></div>
        <div>
            <p class="font-bold capitalize">Chú ý</p>
            <p class="text-sm" x-text="$store.toast.message"></p>
        </div>
    </div>
</div><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9cb376571f5e1193',t:'MTc3MDY0MTEwOQ=='};var a=document.createElement('script');a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
