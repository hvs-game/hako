<!DOCTYPE html>
<html lang="vi" class="light">
<head>
    <meta charset="utf-8">
    
    <title>Đọc Tiểu thư quý tộc cải tạo ký - Nobel Lady Reformation Guide - Chương 04 : Duplain (1) - Cổng Light Novel - Đọc Light Novel</title>

    <meta name="description" content="Để miêu tả những tiểu thư quý tộc trẻ tuổi, họ hoặc là cực kỳ thô lỗ, hoặc là chẳng có chút nếp nhăn nào trong đầu, nhưng mà ngay cả khi đã nghe những lời đồn đại như vậy, vẫn có một chàng trai trẻ sẵn sàng đi chứng...">
    <meta name="theme-color" content="#000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="RQLFQZYVaJfaomIxmhYCdYAVRQB4OEGFWF00QAmO">
    <meta name="logged-in" content="0">
    <meta property="fb:app_id" content="1864643850436909">

    <link rel="canonical" href="https://docln.net/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide/c297890-chuong-04-duplain-1">
    <meta property="og:image" content="https://i.hako.vn/ln/series/covers/s24812-c103f459-f5b6-4c89-b85e-4951915fff04.jpg">


<style type="text/css">@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek/wght/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/devanagari/wght/normal.woff2);unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek-ext/wght/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek/400/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek-ext/400/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}</style>
    <link rel="preload" href="/fonts/OpenSans-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/fonts/OpenSans-SemiBold.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preconnect" href="https://www.google-analytics.com">

    <link rel="shortcut icon" href="/img/favicon.png?v=3">
    <link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon.png?v=3">
    <link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png?v=3">
    <link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png?v=3">

    <link rel="stylesheet" href="/css/interface.css?id=300c3109a58d319c9bb94c8585835c77">
    <link rel="stylesheet" href="/css/tailwind.css?id=79c8956531b276c6564b6dfd12d504f8">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css" integrity="sha256-BtbhCIbtfeVWGsqxk1vOHEYXS6qcvQvLMZqjtpWUEx8=" crossorigin="anonymous" />
            
    
    <script src="/scripts/plugins.js?id=b612d946b32459430eed3066ed15adf2"></script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-34864968-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
      gtag('config', 'UA-34864968-3');
    </script>
</head>

<body>
	
    <div x-data="{ open: Cookies.get('globalwarning2') === undefined ? true : false }">
    <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4" x-show="open" style="display: none">
        <div class="flex">
            <div class="shrink-0">
                <button x-on:click="open = false; Cookies.set('globalwarning2', false, { expires: 0.5 })" type="button" class="inline-flex rounded-md bg-yellow-50 p-1.5 text-yellow-500 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-600 focus:ring-offset-2 focus:ring-offset-yellow-50">
                    <span class="sr-only">Dismiss</span>
                    <svg class="size-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
                    <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z" />
                    </svg>
                </button>
            </div>
            <div class="ml-3 font-bold">
                <p class="text-sm text-yellow-700">
                Nếu không thể <a class="font-medium text-blue-700" href="/thao-luan/2898-ten-mien-da-bi-chan">truy cập trang web</a> xin vui lòng sử dụng DNS 
                <a class="font-medium text-blue-700" href="https://www.google.com/search?q=c%C3%A1ch+c%C3%A0i+dns+1.1.1.1" target="_blank">1.1.1.1</a> hoặc <a class="font-medium text-blue-700" href="https://docln.sbs" target="_blank">docln.sbs</a>
                
                </p>
                <p>
                    <p class="text-sm text-orange-700">Hiện đang đứt cáp Internet APG, kết nối có thể chậm hoặc rất chậm. Dùng VPN không chắc có hiệu quả.</p>
                </p>
            </div>

        </div>
    </div>
</div>



	<style>
    body {
        background: inherit;
    }

    #footer {
        display: none;
    }
    
    .current-reading {
        background-color: rgba(189, 224, 254, 0.3);
        border-left: 5px solid #007bff;
        padding-left: 10px;
        transition: background-color 0.3s ease;
    }
</style>


<main id="mainpart" class="reading-page style-4">
    <section id="rd-side_icon" class="none force-block-l" aria-hidden="true">
                <a class="rd_sd-button_item rd_top-left" href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide/c297859-chuong-03-dereck-3"><i class="fas fa-backward"></i></a>
        
        <a class="rd_sd-button_item" href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide"><i class="fas fa-home"></i></a>     
        <a id="rd-setting_icon" data-affect="#" class="rd_sd-button_item"><i class="fas fa-font"></i></a>
        <a id="rd-tts_icon" class="rd_sd-button_item"><i class="fas fa-volume-up"></i></a>
        <a id="rd-info_icon" data-affect="#rd_sidebar.chapters" class="rd_sd-button_item"><i class="fas fa-info"></i></a>
        <a id="rd-bookmark_icon" data-affect="#rd_sidebar.bookmarks" class="rd_sd-button_item"><i class="fas fa-bookmark"></i></a>

        
                <a class="rd_sd-button_item rd_top-right" href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide/c297900-chuong-05-duplain-2"><i class="fas fa-forward"></i></a>
            </section>    
    
    <section id="chapters" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <header class="rd_sidebar-header clear">
                <a class="img" href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide/c297890-chuong-04-duplain-1" style="background: url('https://i.hako.vn/ln/series/covers/s24812-c103f459-f5b6-4c89-b85e-4951915fff04.jpg') no-repeat"></a> 
                <div class="rd_sidebar-name">                    
                    <h5><a href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide">Tiểu thư quý tộc cải tạo...</a></h5>
                    <small><i class="fas fa-pen"></i>Corita (코리타)</small>
                    <small><i class="fas fa-paint-brush"></i>Shin Hee-bin (신희빈) / Team Pink Shark</small>                
                </div>
            </header>

            <ul id="chap_list" class="unstyled">
                                                            <li class="current"><a href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide/t36070-tap-01">Tập 01</a></li>
                        <ul class="sub-chap_list unstyled">
                                                        <li >
                                <a href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide/c297857-chuong-01-dereck-1">
                                                                        Chương 01 : Dereck (1)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide/c297858-chuong-02-dereck-2">
                                                                        Chương 02 : Dereck (2)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide/c297859-chuong-03-dereck-3">
                                                                        Chương 03 : Dereck (3)
                                </a>
                            </li>
                                                        <li  class="current" >
                                <a href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide/c297890-chuong-04-duplain-1">
                                                                        Chương 04 : Duplain (1)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide/c297900-chuong-05-duplain-2">
                                                                        Chương 05 : Duplain (2)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide/c297901-chuong-06-duplain-3">
                                                                        Chương 06 : Duplain (3)
                                </a>
                            </li>
                                                    </ul>
                                        
                                        
            </ul>
        </main>
        <div class="black-click"></div>
    </section>
    
    <section id="bookmarks" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <div class="rd_sidebar-header">
                <h2 class="rd_s-name"><i class="fas fa-bookmark"></i><a href="/bookmark" style="color: white;"> Bookmarks</a></h2>
            </div>
            <ul id="bookmarks_list" class="unstyled">
                                            <li>Bạn phải đăng nhập để sử dụng bookmark</li>
                                        </ul>
        </main>
        <div class="black-click"></div>
    </section>

    <section id="setting" class="rdtoggle" aria-hidden="true">
        <section class="re_set-in basic-section clear rdtoggle_body">
        <header class="sect-header"><span class="sect-title">Tùy chỉnh</span></header>
            <main class="sect-body">
                <div class="set-list set-color clear">
                    <label class="font-bold">Màu nền</label>
                    <div class="set-input clear justify-center">
                        <span data-color="#ffffff" data-id="0" style="background-color: #ffffff"></span>
                        <span data-color="#e6f0e6" data-id="1" style="background-color: #e6f0e6"></span>
                        <span data-color="#e3f5fa" data-id="2" style="background-color: #e3f5fa"></span>
                        <span data-color="#f6f4ec" data-id="3" style="background-color: #f6f4ec"></span>
                        <span data-color="#eae4d3" data-id="4" style="background-color: #eae4d3"></span>
                        <span data-color="#f5e9ef" data-id="5" style="background-color: #f5e9ef"></span>
                        <span data-color="#222222" data-id="6" style="background-color: #222222"></span>
                        <span data-color="#000000" data-id="7" style="background-color: #000000"></span>
                    </div>
                </div>
                <div class="set-list set-font-family clear">
                    <label class="font-bold">Font chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <select>
                            <option>Times New Roman</option>
                            <option>Merriweather</option>
                            <option>Lora</option>
                            <option>Roboto</option>
                            <option>Noto Sans</option>
                            <option>Nunito</option>
                        </select>
                    </div>
                </div>
                <div class="set-list set-font clear">
                    <label class="font-bold">Kích cỡ chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="16px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-margin clear">
                    <label class="font-bold">Bản lề</label>
                    <div class="set-slide set-input justify-center">
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="20px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-text-align clear">
                    <label class="font-bold">Kiểu căn chỉnh</label>
                    <div class="set-input clear justify-center font-medium text-2xl flex flex-row gap-10">
                        <span data-align="text-left" class="p-1"><i class="fas fa-align-left"></i></span>
                        <span data-align="text-center" class="p-1"><i class="fas fa-align-center"></i></span>
                        <span data-align="text-right" class="p-1"><i class="fas fa-align-right"></i></span>
                        <span data-align="text-justify" class="p-1"><i class="fas fa-align-justify"></i></span>
                    </div>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>

    <section id="tts-panel" class="rdtoggle" aria-hidden="true">
        <section class="tts-settings basic-section clear rdtoggle_body">
            <header class="sect-header"><span class="sect-title">Text-to-Speech</span></header>
            <main class="sect-body">
                <div class="set-list clear" style="color: red; font-size: 14px; margin-bottom: 20px">
                    Đây là chức năng đang thử nghiệm, chi tiết xem tại <a href="/thao-luan/3305-chuc-nang-doc" style="color: blue">Link</a>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Giọng đọc</label>
                    <select id="tts-voice-select" class="w-full p-2 border rounded bg-white dark:bg-gray-800 text-sm dark:border-gray-600"></select>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Tốc độ</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-rate" min="0.1" max="3" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-rate-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Độ cao (Pitch)</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-pitch" min="0" max="2" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-pitch-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="flex gap-2 pt-4">
                    <button id="tts-play-btn" class="flex-1 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Phát</button>
                    <button id="tts-pause-btn" class="flex-1 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Tạm dừng</button>
                    <button id="tts-stop-btn" class="flex-1 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Dừng</button>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>
    
    <div class="container">
        <div class="row">
            <div class="reading-content col-12 col-lg-10 offset-lg-1" style="word-wrap: break-word;">
                <div id="bookmark_top" class="block d-lg-none"><i class="fas fa-bookmark"></i></div>
                <span class="save_bookmark" style="position: absolute; top: 9999px; display: none"><i class="fas fa-bookmark"></i></span>
                
                
                
                <div class="title-top" style="padding-top: 20px">
                    <h2 class="title-item text-xl font-bold" align="center">Tập 01</h2>
                    <h4 class="title-item text-base font-bold" align="center">Chương 04 : Duplain (1)</h4>
                    <h6 class="title-item font-bold" align="center" aria-hidden="true">
                        <a href="https://docln.net/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide/c297890-chuong-04-duplain-1#chapter-comments" style="text-decoration: underline">0 Bình luận</a> -
                        Độ dài: 3,168 từ - Cập nhật: 
                        <time class="topic-time timeago" title="27-01-2026 12:27:21" datetime="2026-01-27T12:27:21+07:00"></time>                    </h6>
                </div>

                <div style="text-align: center; margin: 20px auto -20px auto;">
                                                        </div>

                <div class="pt-6 mb-6 mx-auto max-w-4xl" x-data="{ open: Cookies.get('affiliation_popup_closed2') === undefined }" x-cloak>
                    <div id="affiliation-popup" x-show="open" style="display: none" class="bg-slate-900 rounded-xl overflow-hidden shadow-lg border !border-slate-800">
                        <div class="p-4 flex flex-col md:flex-row items-center gap-4">
                            <button x-on:click="open = false; Cookies.set('affiliation_popup_closed2', 'true', { expires: 0.5 })" class="text-gray-400 hover:text-white transition-colors p-2" aria-label="Close">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                            
                            <div class="flex-shrink-0">
                                <img src="https://i2.hako.vip/vault/992471336465223711.webp" alt="Pepe" class="w-16 h-16 rounded-md object-cover">
                            </div>

                            <div class="flex-grow text-center md:text-left">
                                <p class="text-white text-sm md:text-base font-medium">
                                    Click vào link khi MUA <span class="text-orange-500 font-bold uppercase">BẤT KỲ THỨ GÌ</span> trên <span class="text-orange-500 font-bold">Shopee</span> để hỗ trợ HAKO. Có thể được tặng mã Free ship khi mua.
                                </p>
                            </div>

                            <div class="flex flex-col sm:flex-row gap-3 w-full md:w-auto flex-shrink-0">
                                <a href="https://s.shopee.vn/4q9eci0DM3" target="_blank" class="flex-1 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white font-bold py-2 px-6 rounded shadow-md transition-all text-center whitespace-nowrap" rel="noopener noreferrer">
                                    Shopee
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="chapter-content" class="long-text no-select text-justify">
                    <p style="display: none">Chương 04 : Duplain (1)</p>
                    <p id="1">Các quý cô thường xuyên lui tới những dinh thự xa hoa nằm bên trong thành phố Ebelstein để được huấn luyện về giao tế xã hội. Người ta nói rằng, chỉ riêng việc để một quý cô ở trong một dinh thự độc lập đã cần ít nhất bốn mươi người hầu để phục vụ.</p><p id="2">Một quản gia trưởng, một hầu gái trưởng, ba hầu gái phụ trách lau dọn, ba đầu bếp, bốn phụ bếp, ba hầu gái rửa bát, năm hầu gái thiếp thân, một hầu gái phụ trách các hầu gái thiếp thân, cùng với các gia nhân, cận vệ, đánh xe, người trông chuồng ngựa, người làm vườn… và còn nhiều nhiều nhiều hơn nữa.</p><p id="3">(Dịch giả-kun : người hầu là người phục vụ việc nhà, còn gia nhân là người làm những việc khác quan trọng hơn, ví dụ như đưa thư hoặc chạy vặt. Nó không hẳn là như vậy, nhưng trong bản dịch này t cố ý phân ra như vậy. )</p><p id="4">Chưa dừng lại ở đó, còn cần một tổng quản nội vụ phụ trách giám sát và tuyển dụng toàn bộ những vai trò kể trên. Nếu người đó đang chuẩn bị cho lễ ra mắt xã hội, số lượng gia sư riêng sẽ tăng lên đáng kể, đôi khi vượt quá cả chục người.</p><p id="5">Trong số những gia sư ấy, những người đáng giá nhất chính là các pháp sư. Ma pháp được xem là đặc quyền và là dấu hiệu bẩm sinh của những người thuộc tầng lớp quý tộc. Pháp sư cấp cao cực kỳ hiếm, và họ thường giữ những vị trí quan trọng chứ không đi làm gia sư riêng cho ai.</p><p id="6">Chính bối cảnh đó đã lý giải vì sao Bá tước Elvester, vị anh hùng chiến tranh lừng danh nhất ở phía Đông, lại đích thân viết thư chiêu mộ Katia. </p><p id="7">Một người vừa thấu hiểu văn hóa quý tộc, vừa có thực lực ma pháp xuất sắc, lại còn sở hữu khả năng giảng dạy — giá trị của họ còn quý hơn vàng. Không có gì lạ khi các gia tộc quý tộc lại tranh nhau mời gọi những người như vậy.</p><p id="8">Có một câu chuyện nổi tiếng lan truyền trong giới lính đánh thuê kể rằng Bá tước Delros phương Bắc từng đích thân lên kinh đô chỉ để “cướp người”, mang về một gia sư ma pháp cấp ba, vì sợ rằng nếu chậm chân thì sẽ bị gia tộc khác mời mất. Đó là một hành động đầy tuyệt vọng, hoàn toàn không xứng với thân phận của ông ta.</p><p id="9">Suy cho cùng, các bậc phụ huynh luôn sẵn sàng làm bất cứ điều gì để mang đến cho con cái mình những gia sư tốt nhất. Những kẻ ngồi trên ngai vàng cai trị thế giới này cũng không ngoại lệ.</p><p id="10">Gia thần, người hầu, gia sư, thậm chí cả kỵ sĩ hộ vệ — tất cả hợp lại thành một đội quân nhỏ, hoặc một thương đội khổng lồ, chỉ để phục vụ một quý cô duy nhất.</p><p id="11">Cả thế giới dường như xoay quanh một cô gái trẻ thậm chí còn chưa bước vào tuổi trưởng thành. Đó chính là địa vị của một quý cô xuất thân từ gia tộc danh giá.</p><p id="12">Còn thế giới của Dereck thì hoàn toàn khác.</p><p id="13">Vì thế, việc hai bên không có bất kỳ giao điểm nào vốn dĩ là điều hiển nhiên.</p><p id="14">*****</p><p id="15">“Lần này chúng ta có một đơn đặt hàng lớn đấy. Yêu cầu đến từ gia tộc của Công tước Duplain.”</p><p id="16">Jaden, chủ nhân của quán rượu ‘Giọt Lệ của Veldurn’ nằm sâu nhất trong khu phố lính đánh thuê, đồng thời cũng là thủ lĩnh của Đội lính đánh thuê Veldurn, lên tiếng.</p><p id="17">“Đừng than phiền vì tôi gọi cậu một cách gấp gáp, Dereck. Cậu biết tôi vẫn luôn làm việc theo quy trình đàng hoàng mà.”</p><p id="18">“Công tước Duplain sao? Nghe khó tin thật. Sao họ lại tìm đến chúng ta?”</p><p id="19">“Nhưng đó chính là sự thật. Và đây là một cơ hội hiếm có đối với Đội lính đánh thuê Veldurn.”</p><p id="20">Khi nhắc đến lính đánh thuê ở Ebelstein, người ta thường nghĩ đến hai loại.</p><p id="21">Một là những quân đoàn lính đánh thuê mang tính quân đội thực thụ, đóng quân cố định ở một khu vực, tiếp nhận nhiệm vụ cấp lãnh địa hoặc quốc gia. Họ thường tập hợp quanh các vị tướng lĩnh đã về hưu, hiếm khi rời khỏi vị trí, nên rất khó gặp.</p><p id="22">Loại còn lại là những nhóm hoạt động xoay quanh khu phố quán rượu ở Ebelstein. Các đơn vị lính đánh thuê cá nhân liên kết thành nhóm để xử lý những nhiệm vụ phức tạp và nguy hiểm hơn.</p><p id="23">Loại thứ nhất có tinh thần đồng đội rất mạnh, còn loại thứ hai thì không. Họ giống như những đối tác làm ăn hơn là chiến hữu.</p><p id="24">Jaden là một người đàn ông trung niên, người đã sáng lập đội lính đánh thuê Veldurn. Dù quy mô của đội lính đánh thuê này không lớn, nhưng đội trưởng của họ lại mang trong mình tham vọng không nhỏ. </p><p id="25">Dereck không quá gắn bó với đội lính đánh thuê này, nhưng thỉnh thoảng vẫn nhận nhiệm vụ cùng họ.</p><p id="26">“Nếu bỏ lỡ cơ hội vàng này, tôi sẽ không tha thứ cho chính mình.”</p><p id="27">Jaden là một chiến binh từng trải qua vô số trận chiến. Giờ đây, với bộ râu xồm xoàm, ông trông giống một chủ quán rượu hơn là một kiếm sĩ. Nhưng lính đánh thuê giỏi thường tụ tập ở quán rượu tốt — và vai trò của ông vì thế vẫn vô cùng quan trọng.</p><p id="28">“Cậu cũng biết rồi đấy, quý tộc hào phóng đến mức nào. Họ sẽ ném vàng vào mặt chúng ta chỉ để yêu cầu mấy việc lặt vặt, và nếu chúng ta có thể làm họ hài lòng, họ sẽ tiếp tục quay trở lại mãi.”</p><p id="29">“Vậy, nhiệm vụ lần này là gì?”</p><p id="30">Dereck ngồi trên một chiếc ghế kê sát nên quầy rượu ngay trước mặt chủ quán, áo choàng khoác hờ, hỏi với giọng thờ ơ.</p><p id="31">“Không có gì lớn. Chỉ là tiêu diệt vài con quái vật ở vùng ngoại vi lãnh địa của công tước.”</p><p id="32">“Quái vật gì?”</p><p id="33">“Hình như là goblin, và nếu nguy hiểm thì có thể sẽ có thêm vài con troll.”</p><p id="34">“Chỉ vậy thôi à?”</p><p id="35">“Ừ. Thật ra thì để cậu hoặc Felinne đi một mình cũng xử lý được. Nhưng lần này, trong hoàn cảnh này, tôi cần phải đích thân đi để đảm bảo không xảy ra bất trắc. Tương lai của cả đội phụ thuộc vào nó!”</p><p id="36">Sau quầy rượu treo một thanh đại kiếm — kỷ vật từ thời Jaden còn là một chiến binh. Giờ ông là chủ quán kiêm thủ lĩnh lính đánh thuê, nhưng kỹ năng của một chiến binh lão luyện vẫn còn nguyên vẹn bên trong ông.</p><p id="37">Đó là nguyên nhân Dereck thừa nhận Jaden và gia nhập vào đội lính đánh thuê. Dù có hơi tham lam, lạc quan quá mức và đầy tham vọng, ông vẫn là một người lãnh đạo đáng tin cậy.</p><p id="38">“Công tước Duplain…”</p><p id="39">Ebelstein nằm ở cực nam của bán đảo Belkos rộng lớn thuộc phía Tây lục địa. Toàn bộ nửa phía bắc bán đảo này đều nằm dưới quyền cai trị của Công tước Duplain — một khách hàng cực kỳ quan trọng.</p><p id="40">Điều đó khiến Dereck cảm thấy bất an. Quân đội tư nhân của công tước rất mạnh, vậy tại sao họ lại cần đến một đội lính đánh thuê nhỏ để xử lý mấy con quái vật cấp thấp? Quá đáng ngờ.</p><p id="41">“Có gì đó không ổn.”</p><p id="42">“Dereck, chúng ta là lính đánh thuê.”</p><p id="43">Jaden vừa lau cốc vừa cười.</p><p id="44">“Nhận nhiệm vụ, hoàn thành nhiệm vụ và lấy tiền mới là công việc của chúng ta. Lý do phía sau không phải là thứ chúng ta cần quan tâm, ít nhất là cho đến khi nó lộ ra.”</p><p id="45">“Cũng đúng… Nhưng nếu ông đã đi rồi thì có tôi hay không cũng đâu có quan trọng.”</p><p id="46">Dereck là một tài sản có giá trị. Có kỹ năng kiếm thuật không tệ và có thể sử dụng ma pháp, pháp sư cấp một Dereck là nhân tài hiếm trong giới lính đánh thuê, đủ sức giúp họ xoay xở trong nhiều tình huống.</p><p id="47">Nhưng dù vậy, cậu vẫn không quan trọng hơn một lão binh như Jaden. Goblin và troll là loại việc mà Jaden có thể tự xử lý. Dereck không nhất thiết phải tham gia.</p><p id="48">Nhưng Jaden lắc đầu.</p><p id="49">“Có lý do tôi gọi cậu gấp như vậy. Gia thần của công tước chỉ định phải có sự tham gia của pháp sư.”</p><p id="50">“Tại sao lại cần đến pháp sư cho một nhiệm vụ tiêu diệt đơn giản?”</p><p id="51">“Tôi cũng thắc mắc như vậy. Nhưng họ chỉ khăng khăng là cần mang theo một pháp sư, để đề phòng.”</p><p id="52">Jaden thở dài nặng nề.</p><p id="53">“Càng nghe càng thấy đáng ngờ.”</p><p id="54">“Thôi nào, hãy nghĩ theo hướng tích cực đi. Này, nhìn cái này xem.”</p><p id="55">Jaden đặt một đồng vàng lên bàn. Mắt Dereck mở to.</p><p id="56">“Đồng vàng Aidel. Họ đưa nó cho tôi mà không cần mặc cả. Điên thật, đúng không? Nghĩ lại thì những ngày mà chúng ta phải vật lộn vì vài đồng bạc thật đúng là vô nghĩa.”</p><p id="57">“Quý tộc hào phóng đến vậy sao? Chỉ vì vài con goblin mà đã ném ra một đồng vàng.”</p><p id="58">“Chưa hết đâu. Đây không phải tiền công, mà là tiền ứng trước.”</p><p id="59">Đối mặt với những đồng vàng sáng lấp lánh, Dereck không thể không thay đổi thái độ của mình.</p><p id="60">*****</p><p id="61">Buổi chiều, các vị khách của đội lính đánh thuê Veldurn đã đến được quán rượu. </p><p id="62">Vào thời điểm này trong ngày có rất ít người uống rượu, vậy nên không gian ở Giọt Lệ của Veldrun khá yên tĩnh. Dereck ngồi ở quầy, lặng lẽ quan sát những người mới bước vào. Rõ ràng họ không thuộc về khu phố của những quán rượu, với làn da được chăm sóc kỹ lưỡng và y phục chỉnh tề.</p><p id="63">Có ba người.</p><p id="64">Người dẫn đầu là một ông lão với vẻ ngoài khắc khổ và mệt mỏi. Đầu hói một nửa, ánh mắt sắc bén, những nếp nhăn hằn sâu trên khuôn mặt.</p><p id="65">Theo sau ông ta là một phụ nữ lớn tuổi, tóc đã điểm bạc, cùng một người khác khoác trên mình một chiếc áo choàng dài che kín khuôn mặt.</p><p id="66">Khi họ ngồi xuống, Jaden đích thân mang nước trái cây ra phục vụ.</p><p id="67">“Các vị đến thật sớm. Hy vọng đội lính đánh thuê chúng tôi có thể giúp đỡ được cho các vị.”</p><p id="68">Ông lão liếc nhìn ly nước rồi đẩy sang một bên, hoàn toàn không có hứng thú. Cách cư xử thiếu lễ độ của ông ta thể hiện rõ vị trí của ông ta trong số các gia nhân của gia đình Công tước Duplain là khá cao.</p><p id="69">“Ngươi là Jaden, chiến binh từng nổi danh trong Trận Chiến Bình Minh?”</p><p id="70">“Đúng vậy. Nhưng giờ tôi không còn là binh sĩ nữa, chỉ là một chủ quán rượu bình thường thôi.”</p><p id="71">“Vậy thì năng lực của ngươi hẳn là đáng tin cậy.”</p><p id="72">Theo hiệu lệnh của ông lão, người phụ nữ và kẻ khoác áo choàng cùng ngồi xuống trước chiếc bàn tròn. Dereck yên lặng ngồi ở quầy, vừa uống nước vừa lắng nghe.</p><p id="73">“Ta là Melvin, người hầu riêng của Đại Công tước Duplain. Đây là nữ hầu trợ lý của ta, còn người khoác áo choàng là một thanh tra gia tập sự. Cả hai đều đến từ dinh thự của công tước.”</p><p id="74">(Dịch giả-kun : chức vụ có bị t chỉnh lại một chút để phù hợp với câu chuyện. Bản tiếng Anh có lẽ là bị sai rồi .)</p><p id="75">Chức vị người hầu riêng cho gia chủ là một vị trí rất cao trong số các gia nhân. Jaden mỉm cười chào họ.</p><p id="76">“Người nữ phụ trách các công việc chung, còn thanh tra tập sự thì giám sát nhiệm vụ. Cả hai đều thuộc dinh công tước.”</p><p id="77">Dereck giả vờ uống nước, kín đáo quan sát hai người kia. Nữ hầu ăn mặc gọn gàng, quần áo sạch sẽ và được chăm sóc cẩn thận — trông rất già dặn kinh nghiệm. Còn dáng người của kẻ khoác áo choàng thì khá nhỏ nhắn.</p><p id="78">“Ngài Thanh tra đây sẽ báo cáo lại trực tiếp với công tước phải không? Vậy thì chúng tôi phải để lại ấn tượng tốt mới được.”</p><p id="79">“Đừng lo. Cô ấy vẫn chỉ là tập sự thôi. Mà… pháp sư của các ngươi đâu?”</p><p id="80">“À, ở đây. Dereck, lại đây và tự giới thiệu đi!”</p><p id="81">Dereck đứng dậy bước tới. Cậu cảm nhận rõ những ánh mắt đang dồn về phía mình. Cậu hạ mũ trùm, để lộ khuôn mặt.</p><p id="82">“Tôi là Dereck.”</p><p id="83">Mái tóc trắng được chải gọn và đôi mắt đỏ của cậu khiến vẻ ngoài của cậu luôn để lại một ấn tượng sâu sắc. Trang bị từ da và kim loại được bảo dưỡng kỹ lưỡng.</p><p id="84">Trang bị của Dereck không xa hoa, nhưng rất thực dụng. Áo vải sạch sẽ bên trong giáp da, thắt lưng tốt với dao găm một bên, kiếm treo bên kia, túi da, găng tay và ủng — tất cả đều gọn gàng, ngăn nắp.</p><p id="85">Rõ ràng, cậu là một lính đánh thuê từng trải dày dặn kinh nghiệm, chỉ là có một điểm chưa hoàn hảo.</p><p id="86">“Quá trẻ.”</p><p id="87">Melvin nhíu mày nhìn Jaden.</p><p id="88">“Chúng ta yêu cầu một pháp sư có năng lực, và thằng bé này thậm chí còn chưa đến lễ trưởng thành.”</p><p id="89">Sự thẳng thừng của Melvin rất điển hình cho những kẻ phục vụ quý tộc, những người thường tự xem mình cũng là quý tộc.</p><p id="90">Melvin cau có nhìn Jaden.</p><p id="91">“Ta đã kỳ vọng ngươi sẽ có phán đoán tốt hơn phù hợp với danh tiếng của mình. Làm sao ngươi có thể mang đến cho ta một kẻ như thế này?”</p><p id="92">“Đừng đánh giá cậu ta qua vẻ ngoài. Pháp sư hiếm thấy ở khu này lắm. Ông hiểu mà, đúng không?” </p><p id="93">“Ta biết, trong số các thường dân, pháp sư chiếm số lượng rất ít. Nhưng chính vì vậy, ở độ tuổi này, nó cùng lắm chỉ dùng được pháp thuật cấp một. Chúng ta cần nhiều hơn thế.”</p><p id="94">Melvin trừng mắt nhìn Dereck. Cậu chỉ nhún vai, giơ tay ra, tỏ vẻ không quan tâm.</p><p id="95">Hành động đó càng khiến Melvin khó chịu hơn.</p><p id="96">“Nếu đây là tất cả những gì ngươi có, ta nghĩ có lẽ ta nên rời đi—”</p><p id="97">“Ngài Melvin.”</p><p id="98">Người nữ hầu, đang thì thầm trao đổi với kẻ khoác áo choàng, lên tiếng cắt ngang.</p><p id="99">Melvin thở dài, quay sang nhìn Dereck.</p><p id="100">“Cậu bao nhiêu tuổi?”</p><p id="101">“Mười sáu.”</p><p id="102">“Có thể sử dụng ma pháp đến mức nào?”</p><p id="103">“Tôi có thể dùng được pháp thuật cấp một.”</p><p id="104">“Được. Với độ tuổi đó, cũng coi như không tệ. Xem như cậu gặp may.”</p><p id="105">Melvin lại thở dài, rồi quay sang Jaden.</p><p id="106">“Tiếp tục đi.”</p><p id="107">Đúng là một kẻ thích kiểm soát, Dereck nghĩ thầm, vẫn giữ vẻ mặt thờ ơ. </p><p id="108">Jaden thì tỏ ra hài lòng, vỗ nhẹ lên vai cậu. Có vẻ như khách hàng sẽ không tiếp tục nếu không có pháp sư, và điều đó khiến sự hiện diện của Dereck trở nên then chốt.</p><p id="109">“Như tôi đã nói, tôi là Melvin, người hầu riêng của Công tước Duplain.”</p><p id="110">“Tôi là Delia, phụ trách tạp vụ trong dinh thự của Công tước Duplain.”</p><p id="111">Giữa người hầu và người hầu đều có cấp bậc. Những người có thể phục vụ cho Công tước Duplain, dù là gia thần hay người hầu, đều có quyền hạn không nhỏ.</p><p id="112">“Tôi là thanh tra tập sự, phụ trách giám sát việc hoàn thành nhiệm vụ lần này.”</p><p id="113">Người khoác áo choàng đưa tay ra. Một bàn tay thon nhỏ. Khi ánh sáng chiếu tới, Dereck nhận ra đó là một phụ nữ với làn da trắng nhợt, mái tóc đen tuyền tương phản với đôi mắt xanh lam trong trẻo.</p><p id="114">“Xin lỗi vì không thể lộ diện hoàn toàn. Da tôi rất nhạy cảm với ánh nắng.”</p><p id="115">“Không sao.”</p><p id="116">Dereck bắt tay và gật đầu, đồng thời chú ý đến phong thái tao nhã của vị thanh tra — trông rất giống một quý tộc thực thụ.</p><p id="117">“Nhanh chóng ra ngoài thôi. Chúng ta đã chuẩn bị sẵn xe ngựa. Đây không phải là một nhiệm vụ khó khăn.”</p><p id="118">*****</p><p id="119">“Dù họ có thiếu lễ độ thì cũng đừng ngạc nhiên. Các gia đình quý tộc thường vẫn luôn như thế. Chỉ cần tập trung vào tiền công là được.”</p><p id="120">Jaden ghé tai Dereck thì thầm khi họ đi về phía chuồng ngựa.</p><p id="121">“Tôi cũng không bận tâm lắm.”</p><p id="122">Dereck đáp, ánh mắt dõi theo ba người đi phía trước.</p><p id="123">“Cậu nghĩ sao?”</p><p id="124">“Họ nói dối.”</p><p id="125">“Thật à?”</p><p id="126">Dù xuất thân từ khu ổ chuột, Dereck đã học được rất nhiều về văn hóa quý tộc từ Katia. Bà thường kể chuyện trước giờ ngủ hoặc trong những buổi dạo bộ.</p><p id="127">Ngoài ra, Dereck có thói quen quan sát rất kỹ mọi người mình gặp.</p><p id="128">“Người hầu thiếp thân của các quý tộc thường phải đi lại nhiều, nên đa phần trong số họ vẫn còn trẻ và khéo léo trong việc giao tiếp. Ông lão đó không phù hợp với vai trò này.”</p><p id="129">“Thú vị thật…”</p><p id="130">“Người nữ hầu phụ trách tạp vụ cũng rất lạ. Tay cô ta quá đẹp đẽ để là một người làm việc nặng. Cô ta rõ ràng không làm công việc như lời tự xưng của mình.”</p><p id="131">Rất có thể cả hai đều đã cố tình che giấu thân phận của mình.</p><p id="132">Xét đến sự chênh lệch cấp bậc giữa gia thần và người hầu, Dereck nghi ngờ họ không phải người như vẻ bề ngoài.</p><p id="133">“Còn thanh tra khoác áo choàng thì—”</p><p id="134">“Dereck.”</p><p id="135">Jaden cắt lời, nở nụ cười như đã hiểu hết.</p><p id="136">“…”</p><p id="137">“Tôi đã nói rồi. Đừng đào quá sâu vào chuyện riêng của quý tộc. Nhạy bén quá không phải lúc nào cũng tốt.”</p><p id="138">Lính đánh thuê làm việc rồi nhận tiền. Chỉ thế thôi. Dính dáng</p><p id="139"> quá sâu vào chuyện của quý tộc thường chỉ mang lại rắc rối.</p><p id="140">Lời khuyên của Jaden là điều Dereck cũng hiểu. Cậu khẽ thở dài, hạ ánh mắt xuống.</p><p id="141">Jaden nói đúng.</p><p id="142">Trong thế giới hoang dã này, sống sót mới là ưu tiên hàng đầu.</p><p id="143">Mọi thứ khác đều cần phải xếp hàng phía sau nó.</p>

                    <p style="display: none">Hãy bình luận để ủng hộ người đăng nhé!</p>
                    
                    <!-- <div class="flex justify-center mt-10 mb-7 space-x-3">
                        <a
                            href="https://hako.vn/discord"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #7289da; text-decoration: initial; color: white !important;">
                            <svg
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                xmlns="http://www.w3.org/2000/svg"
                                fill-rule="evenodd"
                                clip-rule="evenodd"
                                viewbox="0 0 24 24">
                                <path
                                d="M19.54 0c1.356 0 2.46 1.104 2.46 2.472v21.528l-2.58-2.28-1.452-1.344-1.536-1.428.636 2.22h-13.608c-1.356 0-2.46-1.104-2.46-2.472v-16.224c0-1.368 1.104-2.472 2.46-2.472h16.08zm-4.632 15.672c2.652-.084 3.672-1.824 3.672-1.824 0-3.864-1.728-6.996-1.728-6.996-1.728-1.296-3.372-1.26-3.372-1.26l-.168.192c2.04.624 2.988 1.524 2.988 1.524-1.248-.684-2.472-1.02-3.612-1.152-.864-.096-1.692-.072-2.424.024l-.204.024c-.42.036-1.44.192-2.724.756-.444.204-.708.348-.708.348s.996-.948 3.156-1.572l-.12-.144s-1.644-.036-3.372 1.26c0 0-1.728 3.132-1.728 6.996 0 0 1.008 1.74 3.66 1.824 0 0 .444-.54.804-.996-1.524-.456-2.1-1.416-2.1-1.416l.336.204.048.036.047.027.014.006.047.027c.3.168.6.3.876.408.492.192 1.08.384 1.764.516.9.168 1.956.228 3.108.012.564-.096 1.14-.264 1.74-.516.42-.156.888-.384 1.38-.708 0 0-.6.984-2.172 1.428.36.456.792.972.792.972zm-5.58-5.604c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332.012-.732-.54-1.332-1.224-1.332zm4.38 0c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332 0-.732-.54-1.332-1.224-1.332z" />
                            </svg>
                            Discord
                        </a>
                        <a
                            href="https://fb.com/hako.page"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #1877f2; text-decoration: initial; color: white !important;">
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                viewBox="0 0 24 24">
                                <path
                                d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z" />
                            </svg>
                            Facebook
                        </a>
                    </div> -->

                                        <a href="/truyen/16221" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/16221/29902cc6-afcf-446e-8fff-62b938eb8f8d.jpg?t=1747982730" class="d-none d-md-block" style="width: 970px; height: auto">
                    </a>
                    <a href="/truyen/16221" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/16221/88df77ba-e124-4669-9aee-bf8635c395da.jpg?t=1747982730" class="d-md-none" style="width: 100%; height: auto">
                    </a>
                    
                                    </div>

                <div style="text-align: center; margin: 20px auto 10px auto;">
                                                        </div>
                
                <section class="rd-basic_icon row">
                    <a href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide/c297859-chuong-03-dereck-3" class="dark:text-black col text-center "><i class="fas fa-backward"></i></a>
                    <a href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide" class="dark:text-black col text-center"><i class="fas fa-home"></i></a>
                    <a href="/truyen/24812-tieu-thu-quy-toc-cai-tao-ky-nobel-lady-reformation-guide/c297900-chuong-05-duplain-2" class="dark:text-black col text-center "><i class="fas fa-forward"></i></a>
                </section>
                
                <!--the code style is important to keep this comment section be out of the effect of user reading's setting-->
            </div>
            <div class="col-12 col-lg-10 offset-lg-1" aria-hidden="true">
                <section id="chapter-comments" class="basic-section dark:bg-[#1f1f1f] dark:text-white dark:border dark:border-[#1f1f1f]">
                    <header class="sect-header tab-list dark:bg-[#2a2a2a] dark:border-[#2a2a2a]"> 
                        <span class="sect-title tab-title" data-tab-index="1">Bình luận <span class="comments-count">(0)</span></span>
                    </header>
                    <main id="fbcmt_root" class="sect-body">
                        <span style="padding: 10px; display: inline-block;">Báo cáo bình luận không phù hợp ở <a href="/thao-luan/619-bao-cao-binh-luan" style="color: blue">đây</a></span>
                        <div id="tab-content-1" class="tab-content clear">
                            <section class="ln-comment">
    <header>
        <h3 class="text-lg font-bold dark:text-white">0 Bình luận </h3>
        <!-- <i id="refresh_comment" class="fas fa-refresh" aria-hidden="true" style="margin-left: 10px; font-size: 18px"></i></h3> -->
            </header>

    <main class="ln-comment-body">
                    <div class="ln-comment_sign-in long-text">
                Bạn phải <a href="/login">đăng nhập</a> hoặc <a href="/register">tạo tài khoản</a> để bình luận.
            </div>
                
        
        
        <div class="ln-comment-page">
</div>    </main>

    <script>
        var token = 'RQLFQZYVaJfaomIxmhYCdYAVRQB4OEGFWF00QAmO';
        var comment_type = 'chapter';
        var comment_typeid = '297890';
    </script>

    </section>


                        </div>
                    </main>
                </section>
            </div> 
        </div>
    </div>
</main>

<script>
    token = 'RQLFQZYVaJfaomIxmhYCdYAVRQB4OEGFWF00QAmO';
        
    function turnoffall() {
        $(".rdtoggle").removeClass("on");
        $(".rdtoggle_body").removeClass("animation fade-in-left-big fade-in-down");
        $("html").removeClass("overflow-hiden");
    }
    
    function rdtoggle(classicon, effect) {
        if ($(classicon).hasClass("on")) {
            turnoffall();
        } else {
            turnoffall();
            $(classicon).addClass("on");
            $("html").addClass("overflow-hiden");
            $(classicon + " .rdtoggle_body").addClass("animation " + effect);
        } 
    };
    
    $("#rd-setting_icon").on('click', function() {
        rdtoggle("#setting", "fade-in-down");                   
    });

    $("#rd-tts_icon").on('click', function() {
        rdtoggle("#tts-panel", "fade-in-down");
    });
        
    $("#rd-info_icon").on('click', function() {
        rdtoggle("#chapters", "fade-in-left-big");              
    });
        
    $("#rd-bookmark_icon").on('click', function() {
        rdtoggle("#bookmarks", "fade-in-left-big");                     
    });
        
    $(".black-click").on('click', function() {
        turnoffall();
        $("#rd-side_icon").hide();
        $("#bookmark_top").removeClass("on");
    });
        
    var bgcolor    = Cookies.get('color') || (Cookies.get('night_mode') ? 6 : 4);
    var fontfamily = Cookies.get('fontfamily') || '';
    var fontsize   = Cookies.get('font') || 18; 
    var margin     = Cookies.get('margin') || 0;
    var textAlign  = Cookies.get('textAlign') || 'text-justify';
        
    function setcolor(alter = true) {
        var switcher = $(".set-color .set-input span").eq(bgcolor);
        switcher.addClass("current");

        if (alter) {
            for (var i = 0; i < $(".set-color .set-input span").length; i++) {
                $("#mainpart").removeClass('style-' + i);
                $("#mainpart").removeClass('dark');
            }
            $("#mainpart").addClass('style-' + bgcolor);

            // Manually hardcoded to dark
            if (bgcolor >= 6) {
                $("#mainpart").addClass('dark');
            }
        }
    }

    // This creates unsmooth experience so we only use it for select box
    function setfontfamily() {
        $('.set-font-family select option').filter(function () {
            return fontfamily.split(',')[0].indexOf($(this).text()) != -1 ;
        }).attr('selected', true);
    }
        
    function setfontstyle(alter = true) {
        $(".set-font input.set-slide_input").val(fontsize + "px"); 

        if (alter) {
            $("div#chapter-content").css("font-size", fontsize + "px");

            var lineheight = +fontsize + 10;
            $("#chapter-content").css("line-height", lineheight + "px");
        }
    }
        
    function setmargin() {
        $(".set-margin input.set-slide_input").val(margin + "px"); 
        $("#chapter-content").css({
            'padding-left': margin + "px",
            'padding-right': margin + "px"
        });
    }

    function setTextAlign(alter = true) {
        var switcher = $(".set-text-align .set-input span[data-align='" + textAlign + "']");
        switcher.addClass("current");

        if (alter) {
            $(".set-text-align .set-input span").each(function () {
                $("#chapter-content").removeClass($(this).attr('data-align'));
            });

            $("#chapter-content").addClass(textAlign);
        }
    }
    
    setcolor(false);
    setfontfamily();
    setfontstyle(false);
    setmargin();
    setTextAlign(true);
    
    //1px = 0.0625rem;
    //16px = 1rem (default);
    
    $(".set-color .set-input span").click(function(){
        bgcolor = $(this).data("id");
        $(".set-color .set-input span").removeClass("current");
        setcolor();            
        Cookies.set('color', bgcolor, { expires: 365 });
    });

    $('.set-font-family select').on('change', function () {
        fontfamily = "'" + $('option:selected', this).text() + "', " + '\'Times New Roman\', Georgia, serif';
        
        $('div#chapter-content').css('font-family', fontfamily);

        Cookies.set('fontfamily', fontfamily, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-smaller").click(function () {
        fontsize = fontsize - 2;
        if (fontsize < 0) fontsize = 0;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-bigger").click(function () {
        fontsize = +fontsize + 2;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-smaller").click(function () {
        margin = margin - 20;
        if (margin < 0) margin = 0;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-bigger").click(function () {
        margin = +margin + 20;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    }); 

    $(".set-text-align .set-input span").click(function(){
        textAlign = $(this).data("align");
        $(".set-text-align .set-input span").removeClass("current");
        setTextAlign();        
        Cookies.set('textAlign', textAlign, { expires: 365 });
    });
        
    $("#bookmarks_list li").each(function(){
        var linepr = $(this).data("line");
        var preview = $(".reading-content p#" + linepr).text();

        var shortText = preview.trim().substring(0, 30) + "...";
        $(this).find(".pos_bookmark small").text(shortText);
    });

    $('div#chapter-content').html(
        $('div#chapter-content').html().replace(
            /\[note(\d+)\]/gi, 
            '<span id="anchor-note$1" class="note-icon none-print inline note-tooltip" data-tooltip-content="#note$1 .note-content" data-note-id="note$1"><i class="fas fa-sticky-note"></i></span><a id="anchor-note$1" class="inline-print none" href="#note$1">[note]</a>'
        )
    )
    
    tippy('.note-tooltip', {
        delay: 50,
        maxWidth: 240,
        interactive: true,
        content(ref) {
            const selector = ref.getAttribute('data-tooltip-content');
            const template = document.querySelector(selector);
            return template ? template.innerHTML : 'Đặt sai ID của note';
        }
    });
        
    isLoggedIn = 0;
    series_id = parseInt('24812');
    chapter_id = parseInt('297890');

    readingObject = {
        series_id: series_id,
        series_title: 'Tiểu thư quý tộc cải tạo ký - Nobel Lady Reformation Guide',
        series_url: $('i.fa-home').first().parent().attr('href'),
        series_cover: $('.rd_sidebar-header a.img').css('background-image'),
        chapter_title: $('ul.sub-chap_list li.current a').text().trim(),
        chapter_url: $('ul.sub-chap_list li.current a').attr('href'),
        book_title: $('ul#chap_list > li.current a').text(),
        book_url: $('ul#chap_list > li.current a').attr('href'),
        read_time: +new Date() / 1000 | 0,
    };

// TTS Manager - Enhanced Web Speech API (Vietnamese). Chunked queue for long texts, no delays/interrupts.
const synth = window.speechSynthesis;
let voices = [];
let voicesLoaded = false;
let ttsRate = parseFloat(localStorage.getItem('tts-rate')) || 1;
let ttsPitch = parseFloat(localStorage.getItem('tts-pitch')) || 1;
let ttsState = 'idle'; // idle, speaking, paused, loading
let currentChunk = 0;
let totalChunks = 0;
let processingIndex = 0;
let paragraphs = [];
const BUFFER_SIZE = 5;

// --- Background Persistence (Wake Lock + Silent Audio) ---
let wakeLock = null;
const silentAudio = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTSVNFAAAAPAAADEVuY29kZWQgd2l0aCBMYW1lMy4xMDBhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUA==');
silentAudio.loop = true;

async function enableConnection() {
    // 1. Start Silent Audio Loop (tricks browser into thinking we are a music player)
    try {
        await silentAudio.play();
    } catch (err) {
        console.warn('Silent Audio Play Failed (likely no interaction):', err);
    }

    // 2. Request Screen Wake Lock (prevents screen from sleeping automatically)
    if ('wakeLock' in navigator) {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (err) {
            console.warn('Wake Lock Request Failed:', err);
        }
    }
}

function disableConnection() {
    // 1. Stop Silent Audio
    try {
        silentAudio.pause();
        silentAudio.currentTime = 0;
    } catch (e) {}

    // 2. Release Wake Lock
    if (wakeLock) {
        try {
            wakeLock.release();
            wakeLock = null;
        } catch (e) {}
    }
}

// Re-acquire Wake Lock if visibility changes and we are speaking
document.addEventListener('visibilitychange', async () => {
    if (wakeLock !== null && document.visibilityState === 'visible' && ttsState === 'speaking') {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (e) {}
    }
});
// ---------------------------------------------------------

let ttsVoiceIdx = localStorage.getItem('tts-voice') || '0';

function populateVoices() {
    voices = synth.getVoices().filter(v => v.lang.startsWith('vi'));
    voicesLoaded = true;
    let $select = $('#tts-voice-select');
    $select.empty();

    if (voices.length === 0) {
        $select.append('<option value="-1">Không có giọng Việt (cài Chrome/Edge)</option>');
        return;
    }

    voices.forEach((voice, idx) => {
        $select.append(`<option value="${idx}">${voice.name} (${voice.lang}) ${voice.default ? '(mặc định)' : ''}</option>`);
    });

    let idx = Math.max(0, Math.min(parseInt(ttsVoiceIdx), voices.length - 1));
    $select.val(idx);
}

function updateTTSUI(progress = '') {
    let $icon = $('#rd-tts_icon i');
    $icon.removeClass('fa-volume-up fa-volume-mute fa-spinner fa-spin');
    let $playBtn = $('#tts-play-btn'), $pauseBtn = $('#tts-pause-btn'), $stopBtn = $('#tts-stop-btn');
    $playBtn.prop('disabled', ttsState === 'speaking' || ttsState === 'loading'); // Enable on idle/paused
    $pauseBtn.prop('disabled', ttsState === 'idle');
    $stopBtn.prop('disabled', ttsState === 'idle');
    // Always remove old progress
    $('#tts-progress').remove();

    if (progress && totalChunks > 0) {
        $playBtn.after(`<span id="tts-progress" class="text-xs block text-center mt-1">${progress}</span>`);
    }

    if (ttsState === 'idle') {
        // Check resume preview
        const resumeData = loadResumeState();
        let currentParagraphs = $('#chapter-content p').map(function() {
            return $(this).text().trim();
        }).get().filter(p => p.trim().length > 0);

        if (resumeData && resumeData.total === currentParagraphs.length) {
            $playBtn.text(`Tiếp tục (${resumeData.index + 1}/${resumeData.total})`);
        } else {
            $playBtn.text('Phát');
        }

        $icon.addClass('fa-volume-up');
    } else if (ttsState === 'speaking' || ttsState === 'loading') {
        $icon.addClass('fa-volume-up fa-spinner fa-spin');
    } else if (ttsState === 'paused') {
        $icon.addClass('fa-volume-mute');
    }
}

$('#tts-play-btn').off('click').on('click', function() {
    // Always restart/resume from storage
    enableConnection(); // Start keep-alive
    synth.cancel();
    ttsState = 'idle';
    // queuedUtterances = []; // Removed global queue
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();

    if (!voicesLoaded || voices.length === 0) {
        ttsState = 'loading';
        updateTTSUI();
        setTimeout(() => {
            if (!voicesLoaded) {
                alert('Giọng nói chưa tải. Thử lại.');
                ttsState = 'idle';
                updateTTSUI();
                return;
            }
            playTTS();
        }, 500);
        return;
    }

    playTTS();
});

function createUtterance(item) {
    let u = new SpeechSynthesisUtterance(item.text);
    u.lang = 'vi-VN';
    u.rate = parseFloat($('#tts-rate').val()) || 1;
    u.pitch = parseFloat($('#tts-pitch').val()) || 1;
    let voiceIdx = parseInt($('#tts-voice-select').val());

    if (voiceIdx >= 0 && voices[voiceIdx]) {
        u.voice = voices[voiceIdx];
    }

    u.onstart = () => {
        currentChunk++;
        saveResumeState();
        updateTTSUI(`${currentChunk}/${totalChunks}`);
        
        // Highlight logic
        $('.current-reading').removeClass('current-reading');
        if (item.el) {
            $(item.el).addClass('current-reading');
            item.el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        feedQueue(); // Ensure buffer is maintained
    };
    u.onerror = (event) => {
        console.error('TTS Error:', event.error, event);

        if (event.error !== 'interrupted') {
             // alert(`Lỗi TTS: ${event.error}. Bỏ qua đoạn.`);
             console.warn('TTS Error skipping chunk', event.error);
        }

        saveResumeState(); // Save on error
        feedQueue();
    };
    u.onend = () => {
        saveResumeState();

        if (currentChunk >= totalChunks) {
            clearResumeState();
            $('.current-reading').removeClass('current-reading'); // Cleanup
            
            // Auto-Next Logic
            let $nextBtn = $('.rd-basic_icon a').last();
            if ($nextBtn.length && !$nextBtn.hasClass('disabled')) {
                localStorage.setItem('tts-autoplay', 'true');
                window.location.href = $nextBtn.attr('href');
                return;
            }

            ttsState = 'idle';
            disableConnection(); // Cleanup
            currentChunk = 0;
            totalChunks = 0;
            processingIndex = 0;
            updateTTSUI();
        } else {
            feedQueue();
        }
    };
    u.onpause = () => { saveResumeState(); };
    return u;
}

function getStorageData() {
    try {
        return JSON.parse(localStorage.getItem('tts-resume-data')) || {};
    } catch {
        return {};
    }
}

function setStorageData(data) {
    localStorage.setItem('tts-resume-data', JSON.stringify(data));
}

function saveResumeState() {
    if (totalChunks > 0) {
        const data = getStorageData();
        data[chapter_id] = {
            index: currentChunk,
            total: totalChunks,
            timestamp: Date.now()
        };
        // Optional: Clean up old entries (older than 7 days?) to prevent infinite growth, 
        // but for now we just save.
        setStorageData(data);
    }
}

function clearResumeState() {
    const data = getStorageData();

    if (data[chapter_id]) {
        delete data[chapter_id];
        setStorageData(data);
    }
}

function loadResumeState() {
    const data = getStorageData();
    const saved = data[chapter_id];
    
    if (!saved) return null;
    
    if (Date.now() - saved.timestamp > 3600000 * 24 * 7) { // 7 days
        clearResumeState();
        return null;
    }

    return saved;
}

function initTTS() {
    populateVoices();
    $('#tts-rate').val(ttsRate);
    $('#tts-rate-value').text(ttsRate);
    $('#tts-pitch').val(ttsPitch);
    $('#tts-pitch-value').text(ttsPitch);
    updateTTSUI();
    
    if (localStorage.getItem('tts-autoplay') === 'true') {
        localStorage.removeItem('tts-autoplay');
        $(window).on('load', function() {
             setTimeout(() => {
                 $('#tts-play-btn').click(); 
             }, 500); 
        });
    }
}

function getParagraphs() {
    return $('#chapter-content p').map(function() {
        let text = $(this).text().trim();
        
        // If paragraph contains an image, replace with "Hình ảnh"
        if ($(this).find('img').length > 0) {
            text = 'Hình ảnh';
        }
        
        if (text.length > 0) {
            return { text: text, el: this };
        }
    }).get();
}

function feedQueue() {
    if (ttsState !== 'speaking') return;
    
    // Maintain buffer
    while (processingIndex < totalChunks && processingIndex < currentChunk + BUFFER_SIZE) {
        let u = createUtterance(paragraphs[processingIndex]);
        synth.speak(u);
        processingIndex++;
    }
}

function playTTS() {
    paragraphs = getParagraphs();
    if (paragraphs.length === 0) {
        alert('Không có nội dung để đọc.');
        ttsState = 'idle';
        disableConnection(); // Cleanup
        updateTTSUI();
        return;
    }
    
    const resumeData = loadResumeState();
    if (resumeData && resumeData.total === paragraphs.length) {
        currentChunk = resumeData.index;
        totalChunks = resumeData.total;
        // processingIndex needs to match what we are about to play
        // Current chunk is what finished, so we start processing from currentChunk?
        // Wait, currentChunk is "index of just finished" in some contexts?
        // No, in loadResume, index is currentChunk.
        // If saved index is 5. means 0..4 played.
        // We start playing from 5 (index).
        // So processingIndex = currentChunk.
        processingIndex = currentChunk;
    } else {
        clearResumeState();
        currentChunk = 0;
        totalChunks = paragraphs.length;
        processingIndex = 0;
    }
    
    synth.cancel();
    ttsState = 'speaking';
    
    feedQueue();
    updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
}

$('#tts-rate').on('input', function() {
    $('#tts-rate-value').text(this.value);
    localStorage.setItem('tts-rate', this.value);
});

$('#tts-pitch').on('input', function() {
    $('#tts-pitch-value').text(this.value);
    localStorage.setItem('tts-pitch', this.value);
});

$('#tts-voice-select').on('change', function() {
    localStorage.setItem('tts-voice', this.value);
});

$('#tts-pause-btn').off('click').on('click', function() {
    if (ttsState === 'speaking') {
        synth.pause();
        ttsState = 'paused';
        disableConnection(); // Pause keep-alive
        updateTTSUI();
        saveResumeState();
    } else if (ttsState === 'paused') {
        enableConnection(); // Resume keep-alive
        synth.resume();
        ttsState = 'speaking';
        updateTTSUI();
    }
});

$('#tts-stop-btn').off('click').on('click', function() {
    synth.cancel();
    // clearResumeState(); // Stop doesn't necessarily clear resume, usually just pause? 
    // But UI says "Stop". Let's clear resume state to consistent with old behavior 
    // or maybe optional? Old behavior cleared it.
    clearResumeState();
    
    disableConnection(); // Stop keep-alive
    $('.current-reading').removeClass('current-reading'); // Cleanup
    ttsState = 'idle';
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();
});

// Visibility handler removed - TTS continues on tab switch

// Long-press to start TTS from selected paragraph (500ms hold)
let longPressTimer = null;
let longPressTarget = null;

// $('#chapter-content p').on('touchstart mousedown', function(e) {
//     longPressTarget = this;
//     longPressTimer = setTimeout(() => {
//         const allParagraphs = getParagraphs();
//         const startIndex = allParagraphs.findIndex(p => p.el === longPressTarget);

//         if (startIndex === -1) return;

//         clearResumeState();
//         synth.cancel();
        
//         paragraphs = allParagraphs;
//         currentChunk = startIndex;
//         totalChunks = paragraphs.length;
//         processingIndex = startIndex;
//         ttsState = 'speaking';
        
//         enableConnection();
//         feedQueue();
//         updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
//     }, 500);
// }).on('touchend touchmove mouseup mouseleave', function() {
//     clearTimeout(longPressTimer);
//     longPressTimer = null;
// });

synth.onvoiceschanged = populateVoices;
initTTS();


</script>





    
    <script src="/scripts/service-manager.js?r=4"></script>

    <script src="/scripts/app.js?id=a5a24eca66adcfc75cc0b2f62e2611db"></script>
    <script src="https://docln.net/vendor/livewire/livewire.min.js?id=df3a17f2"   data-csrf="RQLFQZYVaJfaomIxmhYCdYAVRQB4OEGFWF00QAmO" data-update-uri="/livewire/update" data-navigate-once="true"></script>

    
    <script src="https://confidecross.com/d5/6b/4b/d56b4bd6c3d2c1e161c4ab3c78c27670.js" async></script>

        
            <footer id="footer">
    <div class="container">
        <!--<span><a href="">Hako.re</a></span>-->
        <span class="right">Liên hệ: <a href="mailto:contact@hako.vn" target="_blank" style="color: #5fff46">contact@hako.vn</a></span>

        <span>© 2016 - 2026 Cổng Light Novel - Đọc Light Novel</span>
    </div>
</footer>    
    <div x-data x-show="$store.toast.on" @click="$store.toast.hide()" class="bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fixed w-3/4 md:w-1/2 z-20 inset-x-0 bottom-10 mx-auto" role="alert" style="display: none">
    <div class="flex">
        <div class="py-1"><svg class="fill-current h-6 w-6 text-teal-500 mr-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"/></svg></div>
        <div>
            <p class="font-bold capitalize">Chú ý</p>
            <p class="text-sm" x-text="$store.toast.message"></p>
        </div>
    </div>
</div><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c46d8393c8f6182',t:'MTc2OTUwMjE3MQ=='};var a=document.createElement('script');a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
