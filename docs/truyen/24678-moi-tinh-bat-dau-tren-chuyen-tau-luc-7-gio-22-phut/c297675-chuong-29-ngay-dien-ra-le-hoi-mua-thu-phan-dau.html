<!DOCTYPE html>
<html lang="vi" class="light">
<head>
    <meta charset="utf-8">
    
    <title>Đọc Mối tình bắt đầu trên chuyến tàu lúc 7 giờ 22 phút - Chương 29: Ngày diễn ra lễ hội mùa thu – Phần đầu - Cổng Light Novel - Đọc Light Novel</title>

    <meta name="description" content="Kenta là một nam sinh trung học mỗi sáng đều đi học bằng chuyến tàu khởi hành lúc 7 giờ 22 phút. Cậu luôn để ý đến một nữ sinh trung học thường đọc sách trên cùng một toa tàu, dù chỉ là thoáng qua. Một ngày nọ, từ việc...">
    <meta name="theme-color" content="#000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="8nwWpPdPjm4kKDfuuHe43Kdbcm2WCTcADoL7gmUF">
    <meta name="logged-in" content="0">
    <meta property="fb:app_id" content="1864643850436909">

    <link rel="canonical" href="https://docln.net/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c297675-chuong-29-ngay-dien-ra-le-hoi-mua-thu-phan-dau">
    <meta property="og:image" content="https://i.hako.vn/ln/series/covers/s24678-e26350a9-5d40-45ba-857e-5f2e6ad7ab0b.jpg">


<style type="text/css">@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek/wght/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/devanagari/wght/normal.woff2);unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek-ext/wght/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek-ext/400/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek/400/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}</style>
    <link rel="preload" href="/fonts/OpenSans-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/fonts/OpenSans-SemiBold.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preconnect" href="https://www.google-analytics.com">

    <link rel="shortcut icon" href="/img/favicon.png?v=3">
    <link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon.png?v=3">
    <link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png?v=3">
    <link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png?v=3">

    <link rel="stylesheet" href="/css/interface.css?id=300c3109a58d319c9bb94c8585835c77">
    <link rel="stylesheet" href="/css/tailwind.css?id=79c8956531b276c6564b6dfd12d504f8">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css" integrity="sha256-BtbhCIbtfeVWGsqxk1vOHEYXS6qcvQvLMZqjtpWUEx8=" crossorigin="anonymous" />
            
    
    <script src="/scripts/plugins.js?id=b612d946b32459430eed3066ed15adf2"></script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-34864968-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
      gtag('config', 'UA-34864968-3');
    </script>
</head>

<body>
	
    <div x-data="{ open: Cookies.get('globalwarning2') === undefined ? true : false }">
    <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4" x-show="open" style="display: none">
        <div class="flex">
            <div class="shrink-0">
                <button x-on:click="open = false; Cookies.set('globalwarning2', false, { expires: 0.5 })" type="button" class="inline-flex rounded-md bg-yellow-50 p-1.5 text-yellow-500 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-600 focus:ring-offset-2 focus:ring-offset-yellow-50">
                    <span class="sr-only">Dismiss</span>
                    <svg class="size-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
                    <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z" />
                    </svg>
                </button>
            </div>
            <div class="ml-3 font-bold">
                <p class="text-sm text-yellow-700">
                Nếu không thể <a class="font-medium text-blue-700" href="/thao-luan/2898-ten-mien-da-bi-chan">truy cập trang web</a> xin vui lòng sử dụng DNS 
                <a class="font-medium text-blue-700" href="https://www.google.com/search?q=c%C3%A1ch+c%C3%A0i+dns+1.1.1.1" target="_blank">1.1.1.1</a> hoặc <a class="font-medium text-blue-700" href="https://docln.sbs" target="_blank">docln.sbs</a>
                
                </p>
                <p>
                    <p class="text-sm text-orange-700">Hiện đang đứt cáp Internet APG, kết nối có thể chậm hoặc rất chậm. Dùng VPN không chắc có hiệu quả.</p>
                </p>
            </div>

        </div>
    </div>
</div>



	<style>
    body {
        background: inherit;
    }

    #footer {
        display: none;
    }
    
    .current-reading {
        background-color: rgba(189, 224, 254, 0.3);
        border-left: 5px solid #007bff;
        padding-left: 10px;
        transition: background-color 0.3s ease;
    }
</style>


<main id="mainpart" class="reading-page style-4">
    <section id="rd-side_icon" class="none force-block-l" aria-hidden="true">
                <a class="rd_sd-button_item rd_top-left" href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c297673-chuong-28-chuan-bi-cho-le-hoi-mua-thu"><i class="fas fa-backward"></i></a>
        
        <a class="rd_sd-button_item" href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut"><i class="fas fa-home"></i></a>     
        <a id="rd-setting_icon" data-affect="#" class="rd_sd-button_item"><i class="fas fa-font"></i></a>
        <a id="rd-tts_icon" class="rd_sd-button_item"><i class="fas fa-volume-up"></i></a>
        <a id="rd-info_icon" data-affect="#rd_sidebar.chapters" class="rd_sd-button_item"><i class="fas fa-info"></i></a>
        <a id="rd-bookmark_icon" data-affect="#rd_sidebar.bookmarks" class="rd_sd-button_item"><i class="fas fa-bookmark"></i></a>

        
                <a class="rd_sd-button_item rd_top-right" href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c297676-chuong-30-ngay-dien-ra-le-hoi-mua-thu-phan-ket"><i class="fas fa-forward"></i></a>
            </section>    
    
    <section id="chapters" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <header class="rd_sidebar-header clear">
                <a class="img" href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c297675-chuong-29-ngay-dien-ra-le-hoi-mua-thu-phan-dau" style="background: url('https://i.hako.vn/ln/series/covers/s24678-e26350a9-5d40-45ba-857e-5f2e6ad7ab0b.jpg') no-repeat"></a> 
                <div class="rd_sidebar-name">                    
                    <h5><a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut">Mối tình bắt đầu trên chu...</a></h5>
                    <small><i class="fas fa-pen"></i>ほしみん</small>
                    <small><i class="fas fa-paint-brush"></i></small>                
                </div>
            </header>

            <ul id="chap_list" class="unstyled">
                                                            <li class="current"><a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/t35808-web-novel-chuong-130">Web novel (chương 1~30)</a></li>
                        <ul class="sub-chap_list unstyled">
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c291641-chuong-01-tren-chuyen-tau-cuoi-xuan">
                                                                        Chương 01: Trên chuyến tàu cuối xuân
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c291644-chuong-02-su-boi-roi-cua-ngay-hom-sau">
                                                                        Chương 02: Sự bối rối của ngày hôm sau
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c291646-chuong-03-nhan-ra-vao-ngay-thu-ba">
                                                                        Chương 03: Nhận ra vào ngày thứ ba
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c291647-chuong-04-nhung-quan-sat-moi-ngay">
                                                                        Chương 04: Những quan sát mỗi ngày
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c291648-chuong-05-cuoc-tro-chuyen-dau-tien">
                                                                        Chương 05: Cuộc trò chuyện đầu tiên
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c292468-chuong-06-khoang-trong-cua-ky-nghi-xuan">
                                                                        Chương 06: Khoảng trống của kỳ nghỉ xuân
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c292470-chuong-07-nhung-thay-doi-nho">
                                                                        Chương 07: Những thay đổi nhỏ
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c292472-chuong-08-biet-duoc-ten-em">
                                                                        Chương 08: Biết được tên em
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c292474-chuong-09-cuon-sach-bi-che-giau">
                                                                        Chương 09: Cuốn sách bị che giấu
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c292479-chuong-10-han-gan-moi-quan-he">
                                                                        Chương 10: Hàn gắn mối quan hệ
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c293192-chuong-11-khoang-cach-duoc-rut-ngan">
                                                                        Chương 11: Khoảng cách được rút ngắn
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c293195-chuong-12-sach-khoa-hoc">
                                                                        Chương 12: Sách khoa học
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c293201-chuong-13-dau-hieu-cua-mua-he">
                                                                        Chương 13: Dấu hiệu của mùa hè
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c293207-chuong-14-loi-hua-truoc-ky-nghi-he">
                                                                        Chương 14: Lời hứa trước kỳ nghỉ hè
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c293213-chuong-15-tin-nhan-line-dau-tien">
                                                                        Chương 15: Tin nhắn LINE đầu tiên
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c293850-chuong-16-loi-khuyen-cua-me">
                                                                        Chương 16: Lời khuyên của mẹ
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c293872-chuong-17-cuoc-gap-go-voi-nguoi-tho-lam-banh">
                                                                        Chương 17: Cuộc gặp gỡ với người thợ làm bánh
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c293875-chuong-18-loi-moi-di-ngam-sao">
                                                                        Chương 18: Lời mời đi ngắm sao
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c295086-chuong-19-buoi-hen-ngam-sao-dau-tien">
                                                                        Chương 19: Buổi hẹn ngắm sao đầu tiên
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c295089-chuong-20-quyet-tam-cua-kenta">
                                                                        Chương 20: Quyết tâm của Kenta
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c295682-chuong-21-kenta-nhan-ra">
                                                                        Chương 21: Kenta nhận ra
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c295689-chuong-22-lan-dau-den-mizunoya">
                                                                        Chương 22: Lần đầu đến Mizunoya
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c296452-chuong-23-the-gioi-cua-chihiro">
                                                                        Chương 23: Thế giới của Chihiro
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c296462-chuong-24-buoc-khoi-dau-voi-google-sites">
                                                                        Chương 24: Bước khởi đầu với Google Sites
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c296476-chuong-25-chien-dich-lon-mo-sns">
                                                                        Chương 25: Chiến dịch lớn mở SNS
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c296932-chuong-26-nhung-phan-hoi-dau-tien">
                                                                        Chương 26: Những phản hồi đầu tiên
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c296933-chuong-27-man-ra-mat-blog-cua-chihiro">
                                                                        Chương 27: Màn ra mắt blog của Chihiro
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c297673-chuong-28-chuan-bi-cho-le-hoi-mua-thu">
                                                                        Chương 28: Chuẩn bị cho lễ hội mùa thu
                                </a>
                            </li>
                                                        <li  class="current" >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c297675-chuong-29-ngay-dien-ra-le-hoi-mua-thu-phan-dau">
                                                                        Chương 29: Ngày diễn ra lễ hội mùa thu – Phần đầu
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c297676-chuong-30-ngay-dien-ra-le-hoi-mua-thu-phan-ket">
                                                                        Chương 30: Ngày diễn ra lễ hội mùa thu – Phần kết
                                </a>
                            </li>
                                                    </ul>
                                        
                                        
            </ul>
        </main>
        <div class="black-click"></div>
    </section>
    
    <section id="bookmarks" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <div class="rd_sidebar-header">
                <h2 class="rd_s-name"><i class="fas fa-bookmark"></i><a href="/bookmark" style="color: white;"> Bookmarks</a></h2>
            </div>
            <ul id="bookmarks_list" class="unstyled">
                                            <li>Bạn phải đăng nhập để sử dụng bookmark</li>
                                        </ul>
        </main>
        <div class="black-click"></div>
    </section>

    <section id="setting" class="rdtoggle" aria-hidden="true">
        <section class="re_set-in basic-section clear rdtoggle_body">
        <header class="sect-header"><span class="sect-title">Tùy chỉnh</span></header>
            <main class="sect-body">
                <div class="set-list set-color clear">
                    <label class="font-bold">Màu nền</label>
                    <div class="set-input clear justify-center">
                        <span data-color="#ffffff" data-id="0" style="background-color: #ffffff"></span>
                        <span data-color="#e6f0e6" data-id="1" style="background-color: #e6f0e6"></span>
                        <span data-color="#e3f5fa" data-id="2" style="background-color: #e3f5fa"></span>
                        <span data-color="#f6f4ec" data-id="3" style="background-color: #f6f4ec"></span>
                        <span data-color="#eae4d3" data-id="4" style="background-color: #eae4d3"></span>
                        <span data-color="#f5e9ef" data-id="5" style="background-color: #f5e9ef"></span>
                        <span data-color="#222222" data-id="6" style="background-color: #222222"></span>
                        <span data-color="#000000" data-id="7" style="background-color: #000000"></span>
                    </div>
                </div>
                <div class="set-list set-font-family clear">
                    <label class="font-bold">Font chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <select>
                            <option>Times New Roman</option>
                            <option>Merriweather</option>
                            <option>Lora</option>
                            <option>Roboto</option>
                            <option>Noto Sans</option>
                            <option>Nunito</option>
                        </select>
                    </div>
                </div>
                <div class="set-list set-font clear">
                    <label class="font-bold">Kích cỡ chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="16px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-margin clear">
                    <label class="font-bold">Bản lề</label>
                    <div class="set-slide set-input justify-center">
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="20px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-text-align clear">
                    <label class="font-bold">Kiểu căn chỉnh</label>
                    <div class="set-input clear justify-center font-medium text-2xl flex flex-row gap-10">
                        <span data-align="text-left" class="p-1"><i class="fas fa-align-left"></i></span>
                        <span data-align="text-center" class="p-1"><i class="fas fa-align-center"></i></span>
                        <span data-align="text-right" class="p-1"><i class="fas fa-align-right"></i></span>
                        <span data-align="text-justify" class="p-1"><i class="fas fa-align-justify"></i></span>
                    </div>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>

    <section id="tts-panel" class="rdtoggle" aria-hidden="true">
        <section class="tts-settings basic-section clear rdtoggle_body">
            <header class="sect-header"><span class="sect-title">Text-to-Speech</span></header>
            <main class="sect-body">
                <div class="set-list clear" style="color: red; font-size: 14px; margin-bottom: 20px">
                    Đây là chức năng đang thử nghiệm, chi tiết xem tại <a href="/thao-luan/3305-chuc-nang-doc" style="color: blue">Link</a>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Giọng đọc</label>
                    <select id="tts-voice-select" class="w-full p-2 border rounded bg-white dark:bg-gray-800 text-sm dark:border-gray-600"></select>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Tốc độ</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-rate" min="0.1" max="3" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-rate-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Độ cao (Pitch)</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-pitch" min="0" max="2" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-pitch-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="flex gap-2 pt-4">
                    <button id="tts-play-btn" class="flex-1 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Phát</button>
                    <button id="tts-pause-btn" class="flex-1 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Tạm dừng</button>
                    <button id="tts-stop-btn" class="flex-1 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Dừng</button>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>
    
    <div class="container">
        <div class="row">
            <div class="reading-content col-12 col-lg-10 offset-lg-1" style="word-wrap: break-word;">
                <div id="bookmark_top" class="block d-lg-none"><i class="fas fa-bookmark"></i></div>
                <span class="save_bookmark" style="position: absolute; top: 9999px; display: none"><i class="fas fa-bookmark"></i></span>
                
                
                
                <div class="title-top" style="padding-top: 20px">
                    <h2 class="title-item text-xl font-bold" align="center">Web novel (chương 1~30)</h2>
                    <h4 class="title-item text-base font-bold" align="center">Chương 29: Ngày diễn ra lễ hội mùa thu – Phần đầu</h4>
                    <h6 class="title-item font-bold" align="center" aria-hidden="true">
                        <a href="https://docln.net/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c297675-chuong-29-ngay-dien-ra-le-hoi-mua-thu-phan-dau#chapter-comments" style="text-decoration: underline">0 Bình luận</a> -
                        Độ dài: 1,454 từ - Cập nhật: 
                        <time class="topic-time timeago" title="26-01-2026 20:22:47" datetime="2026-01-26T20:22:47+07:00"></time>                    </h6>
                </div>

                <div style="text-align: center; margin: 20px auto -20px auto;">
                                                        </div>

                <div class="pt-6 mb-6 mx-auto max-w-4xl" x-data="{ open: Cookies.get('affiliation_popup_closed2') === undefined }" x-cloak>
                    <div id="affiliation-popup" x-show="open" style="display: none" class="bg-slate-900 rounded-xl overflow-hidden shadow-lg border !border-slate-800">
                        <div class="p-4 flex flex-col md:flex-row items-center gap-4">
                            <button x-on:click="open = false; Cookies.set('affiliation_popup_closed2', 'true', { expires: 0.5 })" class="text-gray-400 hover:text-white transition-colors p-2" aria-label="Close">
                                <i class="fas fa-times text-xl"></i>
                            </button>
                            
                            <div class="flex-shrink-0">
                                <img src="https://i2.hako.vip/vault/992471336465223711.webp" alt="Pepe" class="w-16 h-16 rounded-md object-cover">
                            </div>

                            <div class="flex-grow text-center md:text-left">
                                <p class="text-white text-sm md:text-base font-medium">
                                    Click vào link khi MUA <span class="text-orange-500 font-bold uppercase">BẤT KỲ THỨ GÌ</span> trên <span class="text-orange-500 font-bold">Shopee</span> để hỗ trợ HAKO. Có thể được tặng mã Free ship khi mua.
                                </p>
                            </div>

                            <div class="flex flex-col sm:flex-row gap-3 w-full md:w-auto flex-shrink-0">
                                <a href="https://s.shopee.vn/4q9eci0DM3" target="_blank" class="flex-1 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white font-bold py-2 px-6 rounded shadow-md transition-all text-center whitespace-nowrap" rel="noopener noreferrer">
                                    Shopee
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="chapter-content" class="long-text no-select text-justify">
                    <p style="display: none">Chương 29: Ngày diễn ra lễ hội mùa thu – Phần đầu</p>
                    <p id="1">Enjoy!</p><p id="2">------------------------------------</p><p id="3"><strong>Ngày diễn ra lễ hội mùa thu – Phần đầu</strong></p><p id="4">Tôi thức dậy lúc 5 giờ rưỡi sáng. Việc tỉnh giấc trước cả khi đồng hồ báo thức reo có lẽ cho thấy tôi đang khá căng thẳng.</p><p id="5">Đúng 6 giờ, khi tôi đến Mizunoya thì Chihiro và bà đã bắt đầu chuẩn bị từ trước.</p><p id="6">“Chào buổi sáng.”</p><p id="7">“Kenta-san, vất vả rồi! Cậu đến sớm thật đấy.”</p><p id="8">Chihiro quay lại, trong bộ tạp dề. Dưới ánh sáng ban mai chiếu vào, gương mặt cô ấy trông nghiêm nghị và rắn rỏi hơn thường ngày. Hôm nay, cô ấy mang dáng vẻ của một người thợ thật sự.</p><p id="9">“Hôm nay là ngày quan trọng mà. Việc chuẩn bị ổn cả chứ?”</p><p id="10">“Ừm. Bà đã bắt đầu làm từ 4 giờ sáng rồi.”</p><p id="11">Chúng tôi chất đồ lên xe của bà rồi hướng đến công viên – nơi tổ chức lễ hội. Bà ngồi ghế lái, còn tôi và Chihiro ngồi cạnh nhau ở hàng ghế sau. Khi ngồi cạnh nhau như vậy, tôi có cảm giác như đang ở trong một không gian rất đặc biệt.</p><p id="12">“Tớ… hơi căng thẳng.”</p><p id="13">Chihiro nói nhỏ.</p><p id="14">“Không sao đâu. Wagashi của Chihiro-san chắc chắn sẽ làm mọi người hài lòng.”</p><p id="15">“Có Kenta-san ở đây, tớ thấy yên tâm hơn nhiều.”</p><p id="16">Nhìn nghiêng gương mặt của Chihiro, tôi cảm thấy lồng ngực mình ấm lên.</p><p id="17">—-------------------------------------</p><p id="18">Khi đến nơi, các gian hàng khác đã bắt đầu chuẩn bị từ trước. Takoyaki, yakisoba, đá bào… khung cảnh tràn ngập không khí lễ hội.</p><p id="19">“Mizuno-san, chào buổi sáng nhé!”</p><p id="20">Người bán ở gian hàng bên cạnh lên tiếng chào.</p><p id="21">“Chào buổi sáng! Hôm nay mong được giúp đỡ nhiều!”</p><p id="22">Chihiro cũng đáp lại lời chào.</p><p id="23">“Năm nào tôi cũng mong tới gian của các cô. Năm nay cũng trông cậy vào wagashi ngon nhé.”</p><p id="24">Nghe những lời ấm áp đó, Chihiro cúi đầu đáp lễ. Có thể thấy rõ Mizunoya được mọi người trong khu vực yêu mến đến mức nào.</p><p id="25">Chúng tôi bắt đầu từ việc dựng lều. Vì chưa quen nên khá lúng túng, nhưng Chihiro nhanh chóng đưa ra chỉ dẫn rất gọn gàng.</p><p id="26">“Kenta-san, cái cột kia dịch sang trái thêm một chút.”</p><p id="27">“Thế này à?”</p><p id="28">“Ừm, hoàn hảo rồi!”</p><p id="29">Khi cả hai cùng nhau dựng xong chiếc lều, tôi cảm nhận được không chỉ là cảm giác hoàn thành công việc, mà còn là một sợi dây gắn kết rất đặc biệt giữa chúng tôi.</p><p id="30">Chúng tôi sắp xếp bàn, lắp bếp gas, chuẩn bị nồi hấp. Mọi cử động của Chihiro đều gọn gàng, không thừa thãi — đúng phong thái của một nghệ nhân chuyên nghiệp.</p><p id="31">Sau khi việc dựng gian hàng xong xuôi, bà nói: “Còn lại nhờ hai đứa nhé”, rồi quay về Mizunoya để trông tiệm.</p><p id="32">“Ghê thật. Không ngờ Chihiro-san lại đáng tin cậy đến vậy.”</p><p id="33">“Bình thường thì toàn là tớ được Kenta-san chỉ bảo thôi nhỉ.”</p><p id="34">Chihiro cười, có chút ngượng ngùng.</p><p id="35">Đến 8 giờ sáng, khâu chuẩn bị cuối cùng cho việc làm wagashi bắt đầu. Chihiro nhào nhân, còn tôi phụ trách mang nguyên liệu.</p><p id="36">“Kenta-san, cho tớ xin bạch đậu nhé.”</p><p id="37">“Ok.”</p><p id="38">Mỗi lần tay chúng tôi chạm vào nhau, tim tôi lại khẽ giật mình. Thấy Chihiro cũng đỏ mặt ngượng ngùng, có lẽ cô ấy cũng có cảm giác giống tôi.</p><p id="39">—----------------------------------</p><p id="40">9 giờ 50 phút sáng. Còn 10 phút nữa là đến giờ mở bán.</p><p id="41">Chihiro nhìn đồng hồ rồi hít một hơi thật sâu.</p><p id="42">“Tớ bắt đầu thấy căng thẳng rồi…”</p><p id="43">“Ngay cả Chihiro-san năm nào cũng tham gia mà vẫn thấy hồi hộp sao?”</p><p id="44">“Mọi năm chỉ bán wagashi đã làm sẵn thôi, nhưng năm nay là lần đầu tiên tớ làm trình diễn trực tiếp trước mặt thực khách… Không biết tớ có làm tốt không nữa.”</p><p id="45">Nhìn vẻ lo lắng của Chihiro, tôi lên tiếng động viên.</p><p id="46">“Không sao đâu. Cậu còn có tớ ở đây mà, tớ sẽ hỗ trợ hết mình.”</p><p id="47">“Cảm ơn cậu.”</p><p id="48">Chihiro mỉm cười, trông có vẻ yên tâm hơn một chút.</p><p id="49">Từ xa vọng lại tiếng trống. Đó là tín hiệu báo hiệu lễ hội mùa thu bắt đầu.</p><p id="50">“Bắt đầu rồi nhỉ.”</p><p id="51">“Ừ… cuối cùng cũng tới.”</p><p id="52">Chihiro nhìn tôi.</p><p id="53">“Kenta-san, cùng nhau cố gắng nhé.”</p><p id="54">“Ừ, cùng cố gắng.”</p><p id="55">Đúng 10 giờ sáng.</p><p id="56">“Xin mời quý khách!”</p><p id="57">Giọng nói tươi tắn của Chihiro vang lên. Tôi cũng đứng bên cạnh, đồng thanh: “Xin mời quý khách!”</p><p id="58">Vị khách đầu tiên là bà Tanaka, người sống gần đó.</p><p id="59">“Chihiro-chan, năm nay bà cũng mong chờ lắm đấy.”</p><p id="60">“Cháu cảm ơn bà. Năm nay cháu có làm thêm wagashi hình lá đỏ mới ạ.”</p><p id="61">Khi Chihiro bắt đầu làm wagashi trước mặt khách, bà Tanaka chăm chú quan sát.</p><p id="62">“Ôi, khéo tay quá. Trông đúng như một nghệ nhân thực thụ.”</p><p id="63">Những chiếc wagashi hình lá đỏ xinh đẹp được tạo ra từ đôi tay của Chihiro khiến tôi cũng không thể rời mắt.</p><p id="64">“Cậu trai này là ai vậy?”</p><p id="65">Bà Tanaka nhìn sang tôi.</p><p id="66">“Là bạn của cháu, Kenta-san ạ. Hôm nay cậu ấy đang tạm thời giúp cháu.”</p><p id="67">“Ara? Không lẽ là bạn trai của cháu?”</p><p id="68">Câu hỏi bất ngờ khiến cả tôi và Chihiro đỏ bừng mặt.</p><p id="69">“À, không… không phải… chỉ là bạn thôi ạ…”</p><p id="70">Chihiro cuống cuồng phủ nhận, nhưng giọng lại nhỏ dần.</p><p id="71">“Trông rất đẹp đôi đấy. Nhìn Chihiro-chan vui vẻ thế kia mà.”</p><p id="72">Không rõ bà có nghe thấy không, nhưng câu chuyện cứ thế tiếp tục theo hướng “bạn trai”. Bà Tanaka mỉm cười mua wagashi rồi rời đi.</p><p id="73">Sau đó, một lúc lâu chúng tôi không dám nhìn thẳng vào mặt nhau.</p><p id="74">Khoảng 11 giờ sáng, lượng khách bắt đầu thưa dần. Dù vẫn có người đứng xem trình diễn và mua wagashi liên tục, nhưng cuối cùng cũng có chút thời gian lắng xuống.</p><p id="75">“Oa, giỏi quá!”</p><p id="76">Một bé gái khoảng 5 tuổi nhìn Chihiro làm wagashi với đôi mắt lấp lánh. Dù đang được mẹ nắm tay, bé vẫn nghiêng người nhìn chằm chằm.</p><p id="77">“Chị ơi, chị giỏi quá. Giống như phép thuật vậy!”</p><p id="78">“Cảm ơn em.”</p><p id="79">Chihiro dừng tay, cúi xuống ngang tầm mắt của bé.</p><p id="80">“Cái này là lá phong đấy. Vào mùa thu, lá cây sẽ chuyển sang màu như thế này, đúng không?”</p><p id="81">“Dạ! Ở công viên có rất nhiều.”</p><p id="82">“Đúng rồi. Chị đang làm chiếc lá đó bằng wagashi. Ăn vào sẽ ngọt và rất ngon.”</p><p id="83">Chihiro làm riêng một chiếc wagashi lá đỏ nhỏ cho bé xem, khiến cô bé reo lên vui sướng.</p><p id="84">“Cái này cho em hả?”</p><p id="85">“Ừ, cho em đó. Nhưng nhớ ăn cùng mẹ nhé.”</p><p id="86">Cô bé nâng niu chiếc wagashi như báu vật, còn người mẹ thì mỉm cười.</p><p id="87">“Cảm ơn con. Con thật sự tuyệt lắm đó.”</p><p id="88">“Năm sau mọi người nhớ ghé lễ hội mùa thu nữa nhé.”</p><p id="89">Sau khi hai mẹ con rời đi, tôi lại một lần nữa cảm động trước sự dịu dàng của Chihiro. Chỉ cần nhìn cách cô ấy đối xử với trẻ con cũng đủ hiểu cô ấy là người tốt bụng đến mức nào.</p><p id="90">—---------------------------------------------</p><p id="91">12 giờ trưa. Giờ nghỉ ăn.</p><p id="92">Ở chiếc ghế băng gần đó, tôi và Chihiro cùng ăn hộp cơm mà cô ấy đã chuẩn bị.</p><p id="93">“Buổi sáng vất vả rồi.”</p><p id="94">“Nhờ có Kenta-san mà mọi việc diễn ra rất suôn sẻ.”</p><p id="95">Dù trông có chút mệt mỏi, nhưng gương mặt Chihiro vẫn ánh lên sự mãn nguyện.</p><p id="96">“Cách Chihiro-san tiếp khách thật tuyệt. Ai cũng bị cuốn theo quá trình làm wagashi của cậu.”</p><p id="97">“Kenta-san cũng rất đáng tin cậy mà. Nếu chỉ có một mình tớ, chắc không thể làm tốt thế này đâu.”</p><p id="98">Vừa ăn cơm, chúng tôi vừa nhìn lại buổi sáng. Khoảnh khắc giản dị ấy lại khiến tôi cảm thấy vô cùng đặc biệt.</p><p id="99">“Buổi chiều cũng cùng cố gắng nhé.”</p><p id="100">“Ừ. Ở bên Chihiro-san, tớ cảm giác chuyện gì cũng vượt qua được.”</p><p id="101">Chihiro mỉm cười vui vẻ.</p><p id="102">“Tớ cũng vậy. Có Kenta-san ở đây, tớ thấy yên tâm lắm.”</p><p id="103">Kết thúc giờ nghỉ trưa, chúng tôi chuẩn bị cho buổi chiều. Nhờ kinh nghiệm buổi sáng, cả hai đã sẵn sàng đối mặt với khoảng thời gian bận rộn sắp tới.</p><p id="104">“Buổi chiều sẽ có nhiều gia đình đưa trẻ nhỏ đến hơn.”</p><p id="105">Chihiro nói.</p><p id="106">“Bọn trẻ rất thích xem làm wagashi, nên chắc sẽ còn bận rộn hơn cả buổi sáng.”</p><p id="107">“Cùng cố gắng nhé. Có Chihiro-san bên cạnh, dù bận rộn đến đâu cũng sẽ vượt qua được thôi.”</p><p id="108">Chihiro mỉm cười, gật đầu. Phần buổi chiều của lễ hội sắp bắt đầu.</p>

                    <p style="display: none">Hãy bình luận để ủng hộ người đăng nhé!</p>
                    
                    <!-- <div class="flex justify-center mt-10 mb-7 space-x-3">
                        <a
                            href="https://hako.vn/discord"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #7289da; text-decoration: initial; color: white !important;">
                            <svg
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                xmlns="http://www.w3.org/2000/svg"
                                fill-rule="evenodd"
                                clip-rule="evenodd"
                                viewbox="0 0 24 24">
                                <path
                                d="M19.54 0c1.356 0 2.46 1.104 2.46 2.472v21.528l-2.58-2.28-1.452-1.344-1.536-1.428.636 2.22h-13.608c-1.356 0-2.46-1.104-2.46-2.472v-16.224c0-1.368 1.104-2.472 2.46-2.472h16.08zm-4.632 15.672c2.652-.084 3.672-1.824 3.672-1.824 0-3.864-1.728-6.996-1.728-6.996-1.728-1.296-3.372-1.26-3.372-1.26l-.168.192c2.04.624 2.988 1.524 2.988 1.524-1.248-.684-2.472-1.02-3.612-1.152-.864-.096-1.692-.072-2.424.024l-.204.024c-.42.036-1.44.192-2.724.756-.444.204-.708.348-.708.348s.996-.948 3.156-1.572l-.12-.144s-1.644-.036-3.372 1.26c0 0-1.728 3.132-1.728 6.996 0 0 1.008 1.74 3.66 1.824 0 0 .444-.54.804-.996-1.524-.456-2.1-1.416-2.1-1.416l.336.204.048.036.047.027.014.006.047.027c.3.168.6.3.876.408.492.192 1.08.384 1.764.516.9.168 1.956.228 3.108.012.564-.096 1.14-.264 1.74-.516.42-.156.888-.384 1.38-.708 0 0-.6.984-2.172 1.428.36.456.792.972.792.972zm-5.58-5.604c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332.012-.732-.54-1.332-1.224-1.332zm4.38 0c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332 0-.732-.54-1.332-1.224-1.332z" />
                            </svg>
                            Discord
                        </a>
                        <a
                            href="https://fb.com/hako.page"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #1877f2; text-decoration: initial; color: white !important;">
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                viewBox="0 0 24 24">
                                <path
                                d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z" />
                            </svg>
                            Facebook
                        </a>
                    </div> -->

                                        <a href="/truyen/16221" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/16221/29902cc6-afcf-446e-8fff-62b938eb8f8d.jpg?t=1747982730" class="d-none d-md-block" style="width: 970px; height: auto">
                    </a>
                    <a href="/truyen/16221" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/16221/88df77ba-e124-4669-9aee-bf8635c395da.jpg?t=1747982730" class="d-md-none" style="width: 100%; height: auto">
                    </a>
                    
                                    </div>

                <div style="text-align: center; margin: 20px auto 10px auto;">
                                                        </div>
                
                <section class="rd-basic_icon row">
                    <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c297673-chuong-28-chuan-bi-cho-le-hoi-mua-thu" class="dark:text-black col text-center "><i class="fas fa-backward"></i></a>
                    <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut" class="dark:text-black col text-center"><i class="fas fa-home"></i></a>
                    <a href="/truyen/24678-moi-tinh-bat-dau-tren-chuyen-tau-luc-7-gio-22-phut/c297676-chuong-30-ngay-dien-ra-le-hoi-mua-thu-phan-ket" class="dark:text-black col text-center "><i class="fas fa-forward"></i></a>
                </section>
                
                <!--the code style is important to keep this comment section be out of the effect of user reading's setting-->
            </div>
            <div class="col-12 col-lg-10 offset-lg-1" aria-hidden="true">
                <section id="chapter-comments" class="basic-section dark:bg-[#1f1f1f] dark:text-white dark:border dark:border-[#1f1f1f]">
                    <header class="sect-header tab-list dark:bg-[#2a2a2a] dark:border-[#2a2a2a]"> 
                        <span class="sect-title tab-title" data-tab-index="1">Bình luận <span class="comments-count">(0)</span></span>
                    </header>
                    <main id="fbcmt_root" class="sect-body">
                        <span style="padding: 10px; display: inline-block;">Báo cáo bình luận không phù hợp ở <a href="/thao-luan/619-bao-cao-binh-luan" style="color: blue">đây</a></span>
                        <div id="tab-content-1" class="tab-content clear">
                            <section class="ln-comment">
    <header>
        <h3 class="text-lg font-bold dark:text-white">0 Bình luận </h3>
        <!-- <i id="refresh_comment" class="fas fa-refresh" aria-hidden="true" style="margin-left: 10px; font-size: 18px"></i></h3> -->
            </header>

    <main class="ln-comment-body">
                    <div class="ln-comment_sign-in long-text">
                Bạn phải <a href="/login">đăng nhập</a> hoặc <a href="/register">tạo tài khoản</a> để bình luận.
            </div>
                
        
        
        <div class="ln-comment-page">
</div>    </main>

    <script>
        var token = '8nwWpPdPjm4kKDfuuHe43Kdbcm2WCTcADoL7gmUF';
        var comment_type = 'chapter';
        var comment_typeid = '297675';
    </script>

    </section>


                        </div>
                    </main>
                </section>
            </div> 
        </div>
    </div>
</main>

<script>
    token = '8nwWpPdPjm4kKDfuuHe43Kdbcm2WCTcADoL7gmUF';
        
    function turnoffall() {
        $(".rdtoggle").removeClass("on");
        $(".rdtoggle_body").removeClass("animation fade-in-left-big fade-in-down");
        $("html").removeClass("overflow-hiden");
    }
    
    function rdtoggle(classicon, effect) {
        if ($(classicon).hasClass("on")) {
            turnoffall();
        } else {
            turnoffall();
            $(classicon).addClass("on");
            $("html").addClass("overflow-hiden");
            $(classicon + " .rdtoggle_body").addClass("animation " + effect);
        } 
    };
    
    $("#rd-setting_icon").on('click', function() {
        rdtoggle("#setting", "fade-in-down");                   
    });

    $("#rd-tts_icon").on('click', function() {
        rdtoggle("#tts-panel", "fade-in-down");
    });
        
    $("#rd-info_icon").on('click', function() {
        rdtoggle("#chapters", "fade-in-left-big");              
    });
        
    $("#rd-bookmark_icon").on('click', function() {
        rdtoggle("#bookmarks", "fade-in-left-big");                     
    });
        
    $(".black-click").on('click', function() {
        turnoffall();
        $("#rd-side_icon").hide();
        $("#bookmark_top").removeClass("on");
    });
        
    var bgcolor    = Cookies.get('color') || (Cookies.get('night_mode') ? 6 : 4);
    var fontfamily = Cookies.get('fontfamily') || '';
    var fontsize   = Cookies.get('font') || 18; 
    var margin     = Cookies.get('margin') || 0;
    var textAlign  = Cookies.get('textAlign') || 'text-justify';
        
    function setcolor(alter = true) {
        var switcher = $(".set-color .set-input span").eq(bgcolor);
        switcher.addClass("current");

        if (alter) {
            for (var i = 0; i < $(".set-color .set-input span").length; i++) {
                $("#mainpart").removeClass('style-' + i);
                $("#mainpart").removeClass('dark');
            }
            $("#mainpart").addClass('style-' + bgcolor);

            // Manually hardcoded to dark
            if (bgcolor >= 6) {
                $("#mainpart").addClass('dark');
            }
        }
    }

    // This creates unsmooth experience so we only use it for select box
    function setfontfamily() {
        $('.set-font-family select option').filter(function () {
            return fontfamily.split(',')[0].indexOf($(this).text()) != -1 ;
        }).attr('selected', true);
    }
        
    function setfontstyle(alter = true) {
        $(".set-font input.set-slide_input").val(fontsize + "px"); 

        if (alter) {
            $("div#chapter-content").css("font-size", fontsize + "px");

            var lineheight = +fontsize + 10;
            $("#chapter-content").css("line-height", lineheight + "px");
        }
    }
        
    function setmargin() {
        $(".set-margin input.set-slide_input").val(margin + "px"); 
        $("#chapter-content").css({
            'padding-left': margin + "px",
            'padding-right': margin + "px"
        });
    }

    function setTextAlign(alter = true) {
        var switcher = $(".set-text-align .set-input span[data-align='" + textAlign + "']");
        switcher.addClass("current");

        if (alter) {
            $(".set-text-align .set-input span").each(function () {
                $("#chapter-content").removeClass($(this).attr('data-align'));
            });

            $("#chapter-content").addClass(textAlign);
        }
    }
    
    setcolor(false);
    setfontfamily();
    setfontstyle(false);
    setmargin();
    setTextAlign(true);
    
    //1px = 0.0625rem;
    //16px = 1rem (default);
    
    $(".set-color .set-input span").click(function(){
        bgcolor = $(this).data("id");
        $(".set-color .set-input span").removeClass("current");
        setcolor();            
        Cookies.set('color', bgcolor, { expires: 365 });
    });

    $('.set-font-family select').on('change', function () {
        fontfamily = "'" + $('option:selected', this).text() + "', " + '\'Times New Roman\', Georgia, serif';
        
        $('div#chapter-content').css('font-family', fontfamily);

        Cookies.set('fontfamily', fontfamily, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-smaller").click(function () {
        fontsize = fontsize - 2;
        if (fontsize < 0) fontsize = 0;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-bigger").click(function () {
        fontsize = +fontsize + 2;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-smaller").click(function () {
        margin = margin - 20;
        if (margin < 0) margin = 0;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-bigger").click(function () {
        margin = +margin + 20;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    }); 

    $(".set-text-align .set-input span").click(function(){
        textAlign = $(this).data("align");
        $(".set-text-align .set-input span").removeClass("current");
        setTextAlign();        
        Cookies.set('textAlign', textAlign, { expires: 365 });
    });
        
    $("#bookmarks_list li").each(function(){
        var linepr = $(this).data("line");
        var preview = $(".reading-content p#" + linepr).text();

        var shortText = preview.trim().substring(0, 30) + "...";
        $(this).find(".pos_bookmark small").text(shortText);
    });

    $('div#chapter-content').html(
        $('div#chapter-content').html().replace(
            /\[note(\d+)\]/gi, 
            '<span id="anchor-note$1" class="note-icon none-print inline note-tooltip" data-tooltip-content="#note$1 .note-content" data-note-id="note$1"><i class="fas fa-sticky-note"></i></span><a id="anchor-note$1" class="inline-print none" href="#note$1">[note]</a>'
        )
    )
    
    tippy('.note-tooltip', {
        delay: 50,
        maxWidth: 240,
        interactive: true,
        content(ref) {
            const selector = ref.getAttribute('data-tooltip-content');
            const template = document.querySelector(selector);
            return template ? template.innerHTML : 'Đặt sai ID của note';
        }
    });
        
    isLoggedIn = 0;
    series_id = parseInt('24678');
    chapter_id = parseInt('297675');

    readingObject = {
        series_id: series_id,
        series_title: 'Mối tình bắt đầu trên chuyến tàu lúc 7 giờ 22 phút',
        series_url: $('i.fa-home').first().parent().attr('href'),
        series_cover: $('.rd_sidebar-header a.img').css('background-image'),
        chapter_title: $('ul.sub-chap_list li.current a').text().trim(),
        chapter_url: $('ul.sub-chap_list li.current a').attr('href'),
        book_title: $('ul#chap_list > li.current a').text(),
        book_url: $('ul#chap_list > li.current a').attr('href'),
        read_time: +new Date() / 1000 | 0,
    };

// TTS Manager - Enhanced Web Speech API (Vietnamese). Chunked queue for long texts, no delays/interrupts.
const synth = window.speechSynthesis;
let voices = [];
let voicesLoaded = false;
let ttsRate = parseFloat(localStorage.getItem('tts-rate')) || 1;
let ttsPitch = parseFloat(localStorage.getItem('tts-pitch')) || 1;
let ttsState = 'idle'; // idle, speaking, paused, loading
let currentChunk = 0;
let totalChunks = 0;
let processingIndex = 0;
let paragraphs = [];
const BUFFER_SIZE = 5;

// --- Background Persistence (Wake Lock + Silent Audio) ---
let wakeLock = null;
const silentAudio = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTSVNFAAAAPAAADEVuY29kZWQgd2l0aCBMYW1lMy4xMDBhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUA==');
silentAudio.loop = true;

async function enableConnection() {
    // 1. Start Silent Audio Loop (tricks browser into thinking we are a music player)
    try {
        await silentAudio.play();
    } catch (err) {
        console.warn('Silent Audio Play Failed (likely no interaction):', err);
    }

    // 2. Request Screen Wake Lock (prevents screen from sleeping automatically)
    if ('wakeLock' in navigator) {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (err) {
            console.warn('Wake Lock Request Failed:', err);
        }
    }
}

function disableConnection() {
    // 1. Stop Silent Audio
    try {
        silentAudio.pause();
        silentAudio.currentTime = 0;
    } catch (e) {}

    // 2. Release Wake Lock
    if (wakeLock) {
        try {
            wakeLock.release();
            wakeLock = null;
        } catch (e) {}
    }
}

// Re-acquire Wake Lock if visibility changes and we are speaking
document.addEventListener('visibilitychange', async () => {
    if (wakeLock !== null && document.visibilityState === 'visible' && ttsState === 'speaking') {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (e) {}
    }
});
// ---------------------------------------------------------

let ttsVoiceIdx = localStorage.getItem('tts-voice') || '0';

function populateVoices() {
    voices = synth.getVoices().filter(v => v.lang.startsWith('vi'));
    voicesLoaded = true;
    let $select = $('#tts-voice-select');
    $select.empty();

    if (voices.length === 0) {
        $select.append('<option value="-1">Không có giọng Việt (cài Chrome/Edge)</option>');
        return;
    }

    voices.forEach((voice, idx) => {
        $select.append(`<option value="${idx}">${voice.name} (${voice.lang}) ${voice.default ? '(mặc định)' : ''}</option>`);
    });

    let idx = Math.max(0, Math.min(parseInt(ttsVoiceIdx), voices.length - 1));
    $select.val(idx);
}

function updateTTSUI(progress = '') {
    let $icon = $('#rd-tts_icon i');
    $icon.removeClass('fa-volume-up fa-volume-mute fa-spinner fa-spin');
    let $playBtn = $('#tts-play-btn'), $pauseBtn = $('#tts-pause-btn'), $stopBtn = $('#tts-stop-btn');
    $playBtn.prop('disabled', ttsState === 'speaking' || ttsState === 'loading'); // Enable on idle/paused
    $pauseBtn.prop('disabled', ttsState === 'idle');
    $stopBtn.prop('disabled', ttsState === 'idle');
    // Always remove old progress
    $('#tts-progress').remove();

    if (progress && totalChunks > 0) {
        $playBtn.after(`<span id="tts-progress" class="text-xs block text-center mt-1">${progress}</span>`);
    }

    if (ttsState === 'idle') {
        // Check resume preview
        const resumeData = loadResumeState();
        let currentParagraphs = $('#chapter-content p').map(function() {
            return $(this).text().trim();
        }).get().filter(p => p.trim().length > 0);

        if (resumeData && resumeData.total === currentParagraphs.length) {
            $playBtn.text(`Tiếp tục (${resumeData.index + 1}/${resumeData.total})`);
        } else {
            $playBtn.text('Phát');
        }

        $icon.addClass('fa-volume-up');
    } else if (ttsState === 'speaking' || ttsState === 'loading') {
        $icon.addClass('fa-volume-up fa-spinner fa-spin');
    } else if (ttsState === 'paused') {
        $icon.addClass('fa-volume-mute');
    }
}

$('#tts-play-btn').off('click').on('click', function() {
    // Always restart/resume from storage
    enableConnection(); // Start keep-alive
    synth.cancel();
    ttsState = 'idle';
    // queuedUtterances = []; // Removed global queue
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();

    if (!voicesLoaded || voices.length === 0) {
        ttsState = 'loading';
        updateTTSUI();
        setTimeout(() => {
            if (!voicesLoaded) {
                alert('Giọng nói chưa tải. Thử lại.');
                ttsState = 'idle';
                updateTTSUI();
                return;
            }
            playTTS();
        }, 500);
        return;
    }

    playTTS();
});

function createUtterance(item) {
    let u = new SpeechSynthesisUtterance(item.text);
    u.lang = 'vi-VN';
    u.rate = parseFloat($('#tts-rate').val()) || 1;
    u.pitch = parseFloat($('#tts-pitch').val()) || 1;
    let voiceIdx = parseInt($('#tts-voice-select').val());

    if (voiceIdx >= 0 && voices[voiceIdx]) {
        u.voice = voices[voiceIdx];
    }

    u.onstart = () => {
        currentChunk++;
        saveResumeState();
        updateTTSUI(`${currentChunk}/${totalChunks}`);
        
        // Highlight logic
        $('.current-reading').removeClass('current-reading');
        if (item.el) {
            $(item.el).addClass('current-reading');
            item.el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        feedQueue(); // Ensure buffer is maintained
    };
    u.onerror = (event) => {
        console.error('TTS Error:', event.error, event);

        if (event.error !== 'interrupted') {
             // alert(`Lỗi TTS: ${event.error}. Bỏ qua đoạn.`);
             console.warn('TTS Error skipping chunk', event.error);
        }

        saveResumeState(); // Save on error
        feedQueue();
    };
    u.onend = () => {
        saveResumeState();

        if (currentChunk >= totalChunks) {
            clearResumeState();
            $('.current-reading').removeClass('current-reading'); // Cleanup
            
            // Auto-Next Logic
            let $nextBtn = $('.rd-basic_icon a').last();
            if ($nextBtn.length && !$nextBtn.hasClass('disabled')) {
                localStorage.setItem('tts-autoplay', 'true');
                window.location.href = $nextBtn.attr('href');
                return;
            }

            ttsState = 'idle';
            disableConnection(); // Cleanup
            currentChunk = 0;
            totalChunks = 0;
            processingIndex = 0;
            updateTTSUI();
        } else {
            feedQueue();
        }
    };
    u.onpause = () => { saveResumeState(); };
    return u;
}

function getStorageData() {
    try {
        return JSON.parse(localStorage.getItem('tts-resume-data')) || {};
    } catch {
        return {};
    }
}

function setStorageData(data) {
    localStorage.setItem('tts-resume-data', JSON.stringify(data));
}

function saveResumeState() {
    if (totalChunks > 0) {
        const data = getStorageData();
        data[chapter_id] = {
            index: currentChunk,
            total: totalChunks,
            timestamp: Date.now()
        };
        // Optional: Clean up old entries (older than 7 days?) to prevent infinite growth, 
        // but for now we just save.
        setStorageData(data);
    }
}

function clearResumeState() {
    const data = getStorageData();

    if (data[chapter_id]) {
        delete data[chapter_id];
        setStorageData(data);
    }
}

function loadResumeState() {
    const data = getStorageData();
    const saved = data[chapter_id];
    
    if (!saved) return null;
    
    if (Date.now() - saved.timestamp > 3600000 * 24 * 7) { // 7 days
        clearResumeState();
        return null;
    }

    return saved;
}

function initTTS() {
    populateVoices();
    $('#tts-rate').val(ttsRate);
    $('#tts-rate-value').text(ttsRate);
    $('#tts-pitch').val(ttsPitch);
    $('#tts-pitch-value').text(ttsPitch);
    updateTTSUI();
    
    if (localStorage.getItem('tts-autoplay') === 'true') {
        localStorage.removeItem('tts-autoplay');
        $(window).on('load', function() {
             setTimeout(() => {
                 $('#tts-play-btn').click(); 
             }, 500); 
        });
    }
}

function getParagraphs() {
    return $('#chapter-content p').map(function() {
        let text = $(this).text().trim();
        
        // If paragraph contains an image, replace with "Hình ảnh"
        if ($(this).find('img').length > 0) {
            text = 'Hình ảnh';
        }
        
        if (text.length > 0) {
            return { text: text, el: this };
        }
    }).get();
}

function feedQueue() {
    if (ttsState !== 'speaking') return;
    
    // Maintain buffer
    while (processingIndex < totalChunks && processingIndex < currentChunk + BUFFER_SIZE) {
        let u = createUtterance(paragraphs[processingIndex]);
        synth.speak(u);
        processingIndex++;
    }
}

function playTTS() {
    paragraphs = getParagraphs();
    if (paragraphs.length === 0) {
        alert('Không có nội dung để đọc.');
        ttsState = 'idle';
        disableConnection(); // Cleanup
        updateTTSUI();
        return;
    }
    
    const resumeData = loadResumeState();
    if (resumeData && resumeData.total === paragraphs.length) {
        currentChunk = resumeData.index;
        totalChunks = resumeData.total;
        // processingIndex needs to match what we are about to play
        // Current chunk is what finished, so we start processing from currentChunk?
        // Wait, currentChunk is "index of just finished" in some contexts?
        // No, in loadResume, index is currentChunk.
        // If saved index is 5. means 0..4 played.
        // We start playing from 5 (index).
        // So processingIndex = currentChunk.
        processingIndex = currentChunk;
    } else {
        clearResumeState();
        currentChunk = 0;
        totalChunks = paragraphs.length;
        processingIndex = 0;
    }
    
    synth.cancel();
    ttsState = 'speaking';
    
    feedQueue();
    updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
}

$('#tts-rate').on('input', function() {
    $('#tts-rate-value').text(this.value);
    localStorage.setItem('tts-rate', this.value);
});

$('#tts-pitch').on('input', function() {
    $('#tts-pitch-value').text(this.value);
    localStorage.setItem('tts-pitch', this.value);
});

$('#tts-voice-select').on('change', function() {
    localStorage.setItem('tts-voice', this.value);
});

$('#tts-pause-btn').off('click').on('click', function() {
    if (ttsState === 'speaking') {
        synth.pause();
        ttsState = 'paused';
        disableConnection(); // Pause keep-alive
        updateTTSUI();
        saveResumeState();
    } else if (ttsState === 'paused') {
        enableConnection(); // Resume keep-alive
        synth.resume();
        ttsState = 'speaking';
        updateTTSUI();
    }
});

$('#tts-stop-btn').off('click').on('click', function() {
    synth.cancel();
    // clearResumeState(); // Stop doesn't necessarily clear resume, usually just pause? 
    // But UI says "Stop". Let's clear resume state to consistent with old behavior 
    // or maybe optional? Old behavior cleared it.
    clearResumeState();
    
    disableConnection(); // Stop keep-alive
    $('.current-reading').removeClass('current-reading'); // Cleanup
    ttsState = 'idle';
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();
});

// Visibility handler removed - TTS continues on tab switch

// Long-press to start TTS from selected paragraph (500ms hold)
let longPressTimer = null;
let longPressTarget = null;

// $('#chapter-content p').on('touchstart mousedown', function(e) {
//     longPressTarget = this;
//     longPressTimer = setTimeout(() => {
//         const allParagraphs = getParagraphs();
//         const startIndex = allParagraphs.findIndex(p => p.el === longPressTarget);

//         if (startIndex === -1) return;

//         clearResumeState();
//         synth.cancel();
        
//         paragraphs = allParagraphs;
//         currentChunk = startIndex;
//         totalChunks = paragraphs.length;
//         processingIndex = startIndex;
//         ttsState = 'speaking';
        
//         enableConnection();
//         feedQueue();
//         updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
//     }, 500);
// }).on('touchend touchmove mouseup mouseleave', function() {
//     clearTimeout(longPressTimer);
//     longPressTimer = null;
// });

synth.onvoiceschanged = populateVoices;
initTTS();


</script>





    
    <script src="/scripts/service-manager.js?r=4"></script>

    <script src="/scripts/app.js?id=a5a24eca66adcfc75cc0b2f62e2611db"></script>
    <script src="https://docln.net/vendor/livewire/livewire.min.js?id=df3a17f2"   data-csrf="8nwWpPdPjm4kKDfuuHe43Kdbcm2WCTcADoL7gmUF" data-update-uri="/livewire/update" data-navigate-once="true"></script>

    
    <script src="https://confidecross.com/d5/6b/4b/d56b4bd6c3d2c1e161c4ab3c78c27670.js" async></script>

        
            <footer id="footer">
    <div class="container">
        <!--<span><a href="">Hako.re</a></span>-->
        <span class="right">Liên hệ: <a href="mailto:contact@hako.vn" target="_blank" style="color: #5fff46">contact@hako.vn</a></span>

        <span>© 2016 - 2026 Cổng Light Novel - Đọc Light Novel</span>
    </div>
</footer>    
    <div x-data x-show="$store.toast.on" @click="$store.toast.hide()" class="bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fixed w-3/4 md:w-1/2 z-20 inset-x-0 bottom-10 mx-auto" role="alert" style="display: none">
    <div class="flex">
        <div class="py-1"><svg class="fill-current h-6 w-6 text-teal-500 mr-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"/></svg></div>
        <div>
            <p class="font-bold capitalize">Chú ý</p>
            <p class="text-sm" x-text="$store.toast.message"></p>
        </div>
    </div>
</div><script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c415f0529dfeb6a',t:'MTc2OTQ0NDc3Nw=='};var a=document.createElement('script');a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
