<!DOCTYPE html>
<html lang="vi" class="light">
<head>
    <meta charset="utf-8">
    
    <title>Đọc Ma Vương Ở Ẩn Và Công Chúa Kiếm - Chương 2: Những chàng hoàng tử bạch mã (1) - Cổng Light Novel - Đọc Light Novel</title>

    <meta name="description" content="&quot;Ma Vương! Kết hôn với em đi!&quot; Những vị khách không mời cứ liên tục tìm đến nhằm tiêu diệt Ma Vương. Dưới quá nhiều áp lực, trong một phút cao hứng vì men rượu, Ma Vương đã bắt cóc nàng công chúa tám tuổi Kiiri. Sau nửa tháng chung...">
    <meta name="theme-color" content="#000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="5CAGulxnbnS3WR6Y1aiqo7CmRVaZu75jm08XtDsO">
    <meta name="logged-in" content="0">
    <meta property="fb:app_id" content="1864643850436909">

    <link rel="canonical" href="https://docln.net/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c292501-chuong-2-nhung-chang-hoang-tu-bach-ma-1">
    <meta property="og:image" content="https://i.hako.vn/ln/series/covers/s24523-1ee54abd-3d50-4acb-8877-cf5e5c1e815e.jpg">


<style type="text/css">@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Lora;font-style:normal;font-weight:400;src:url(/cf-fonts/v/lora/5.0.11/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Merriweather;font-style:normal;font-weight:400;src:url(/cf-fonts/s/merriweather/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek/wght/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/devanagari/wght/normal.woff2);unicode-range:U+0900-097F,U+1CD0-1CF9,U+200C-200D,U+20A8,U+20B9,U+25CC,U+A830-A839,U+A8E0-A8FF;font-display:swap;}@font-face {font-family:Noto Sans;font-style:normal;font-weight:400;src:url(/cf-fonts/v/noto-sans/5.0.18/greek-ext/wght/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin-ext/wght/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/vietnamese/wght/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic-ext/wght/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/latin/wght/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Nunito;font-style:normal;font-weight:400;src:url(/cf-fonts/v/nunito/5.0.16/cyrillic/wght/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek-ext/400/normal.woff2);unicode-range:U+1F00-1FFF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/greek/400/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Roboto;font-style:normal;font-weight:400;src:url(/cf-fonts/s/roboto/5.0.11/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}</style>
    <link rel="preload" href="/fonts/OpenSans-Regular.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preload" href="/fonts/OpenSans-SemiBold.ttf" as="font" type="font/ttf" crossorigin="anonymous">
    <link rel="preconnect" href="https://www.google-analytics.com">

    <link rel="shortcut icon" href="/img/favicon.png?v=3">
    <link rel="apple-touch-icon" sizes="57x57" href="/img/apple-touch-icon.png?v=3">
    <link rel="apple-touch-icon" sizes="72x72" href="/img/apple-touch-icon-72x72.png?v=3">
    <link rel="apple-touch-icon" sizes="114x114" href="/img/apple-touch-icon-114x114.png?v=3">

    <link rel="stylesheet" href="/css/interface.css?id=300c3109a58d319c9bb94c8585835c77">
    <link rel="stylesheet" href="/css/tailwind.css?id=9128bdee617e5eb876ffd418ed3597bf">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css" integrity="sha256-BtbhCIbtfeVWGsqxk1vOHEYXS6qcvQvLMZqjtpWUEx8=" crossorigin="anonymous" />
            
    
    <script src="/scripts/plugins.js?id=b612d946b32459430eed3066ed15adf2"></script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-34864968-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
      gtag('config', 'UA-34864968-3');
    </script>
</head>

<body>
	
    <div x-data="{ open: Cookies.get('globalwarning2') === undefined ? true : false }">
    <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4" x-show="open" style="display: none">
        <div class="flex">
            <div class="shrink-0">
                <button x-on:click="open = false; Cookies.set('globalwarning2', false, { expires: 0.5 })" type="button" class="inline-flex rounded-md bg-yellow-50 p-1.5 text-yellow-500 hover:bg-yellow-100 focus:outline-none focus:ring-2 focus:ring-yellow-600 focus:ring-offset-2 focus:ring-offset-yellow-50">
                    <span class="sr-only">Dismiss</span>
                    <svg class="size-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-slot="icon">
                    <path d="M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z" />
                    </svg>
                </button>
            </div>
            <div class="ml-3 font-bold">
                <p class="text-sm text-yellow-700">
                Nếu không thể <a class="font-medium text-blue-700" href="/thao-luan/2898-ten-mien-da-bi-chan">truy cập trang web</a> xin vui lòng sử dụng DNS 
                <a class="font-medium text-blue-700" href="https://www.google.com/search?q=c%C3%A1ch+c%C3%A0i+dns+1.1.1.1" target="_blank">1.1.1.1</a> hoặc <a class="font-medium text-blue-700" href="https://docln.sbs" target="_blank">docln.sbs</a>
                
                </p>
                <p>
                    <p class="text-sm text-orange-700">Hiện đang đứt cáp Internet APG, kết nối có thể chậm hoặc rất chậm. Dùng VPN không chắc có hiệu quả.</p>
                </p>
            </div>

        </div>
    </div>
</div>



	<style>
    body {
        background: inherit;
    }

    #footer {
        display: none;
    }
    
    .current-reading {
        background-color: rgba(189, 224, 254, 0.3);
        border-left: 5px solid #007bff;
        padding-left: 10px;
        transition: background-color 0.3s ease;
    }
</style>


<main id="mainpart" class="reading-page style-4">
    <section id="rd-side_icon" class="none force-block-l" aria-hidden="true">
                <a class="rd_sd-button_item rd_top-left" href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c285673-chuong-1-chuyen-ta-chua-tung-nghi-toi-o-do-tuoi-cua-co-7"><i class="fas fa-backward"></i></a>
        
        <a class="rd_sd-button_item" href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem"><i class="fas fa-home"></i></a>     
        <a id="rd-setting_icon" data-affect="#" class="rd_sd-button_item"><i class="fas fa-font"></i></a>
        <a id="rd-tts_icon" class="rd_sd-button_item"><i class="fas fa-volume-up"></i></a>
        <a id="rd-info_icon" data-affect="#rd_sidebar.chapters" class="rd_sd-button_item"><i class="fas fa-info"></i></a>
        <a id="rd-bookmark_icon" data-affect="#rd_sidebar.bookmarks" class="rd_sd-button_item"><i class="fas fa-bookmark"></i></a>

        
                <a class="rd_sd-button_item rd_top-right" href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c292508-chuong-2-nhung-chang-hoang-tu-bach-ma-2"><i class="fas fa-forward"></i></a>
            </section>    
    
    <section id="chapters" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <header class="rd_sidebar-header clear">
                <a class="img" href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c292501-chuong-2-nhung-chang-hoang-tu-bach-ma-1" style="background: url('https://i.hako.vn/ln/series/covers/s24523-1ee54abd-3d50-4acb-8877-cf5e5c1e815e.jpg') no-repeat"></a> 
                <div class="rd_sidebar-name">                    
                    <h5><a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem">Ma Vương Ở Ẩn Và Công Chú...</a></h5>
                    <small><i class="fas fa-pen"></i>Biei</small>
                    <small><i class="fas fa-paint-brush"></i>Lpip</small>                
                </div>
            </header>

            <ul id="chap_list" class="unstyled">
                                                            <li class="current"><a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/t35488-tap-1">Tập 1</a></li>
                        <ul class="sub-chap_list unstyled">
                                                        <li >
                                <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c285535-minh-hoa">
                                                                            <i class="fas fa-picture-o" aria-hidden="true" title="Có chứa ảnh"></i>
                                                                        Minh họa
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c285544-chuong-0-lich-su-bat-dau-tu-men-ruou">
                                                                        Chương 0: Lịch sử bắt đầu từ men rượu
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c285554-chuong-1-chuyen-ta-chua-tung-nghi-toi-o-do-tuoi-cua-co-1">
                                                                        Chương 1: Chuyện ta chưa từng nghĩ tới ở độ tuổi của cô (1)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c285567-chuong-1-chuyen-ta-chua-tung-nghi-toi-o-do-tuoi-cua-co-2">
                                                                            <i class="fas fa-picture-o" aria-hidden="true" title="Có chứa ảnh"></i>
                                                                        Chương 1: Chuyện ta chưa từng nghĩ tới ở độ tuổi của cô (2)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c285587-chuong-1-chuyen-ta-chua-tung-nghi-toi-o-do-tuoi-cua-co-3">
                                                                        Chương 1: Chuyện ta chưa từng nghĩ tới ở độ tuổi của cô (3)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c285624-chuong-1-chuyen-ta-chua-tung-nghi-toi-o-do-tuoi-cua-co-4">
                                                                        Chương 1: Chuyện ta chưa từng nghĩ tới ở độ tuổi của cô (4)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c285645-chuong-1-chuyen-ta-chua-tung-nghi-toi-o-do-tuoi-cua-co-5">
                                                                        Chương 1: Chuyện ta chưa từng nghĩ tới ở độ tuổi của cô (5)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c285669-chuong-1-chuyen-ta-chua-tung-nghi-toi-o-do-tuoi-cua-co-6">
                                                                        Chương 1: Chuyện ta chưa từng nghĩ tới ở độ tuổi của cô (6)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c285673-chuong-1-chuyen-ta-chua-tung-nghi-toi-o-do-tuoi-cua-co-7">
                                                                        Chương 1: Chuyện ta chưa từng nghĩ tới ở độ tuổi của cô (7)
                                </a>
                            </li>
                                                        <li  class="current" >
                                <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c292501-chuong-2-nhung-chang-hoang-tu-bach-ma-1">
                                                                        Chương 2: Những chàng hoàng tử bạch mã (1)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c292508-chuong-2-nhung-chang-hoang-tu-bach-ma-2">
                                                                        Chương 2: Những chàng hoàng tử bạch mã (2)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c292518-chuong-2-nhung-chang-hoang-tu-bach-ma-3">
                                                                            <i class="fas fa-picture-o" aria-hidden="true" title="Có chứa ảnh"></i>
                                                                        Chương 2: Những chàng hoàng tử bạch mã (3)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c292533-chuong-2-nhung-chang-hoang-tu-bach-ma-4">
                                                                        Chương 2: Những chàng hoàng tử bạch mã (4)
                                </a>
                            </li>
                                                        <li >
                                <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c292545-chuong-2-nhung-chang-hoang-tu-bach-ma-5">
                                                                            <i class="fas fa-picture-o" aria-hidden="true" title="Có chứa ảnh"></i>
                                                                        Chương 2: Những chàng hoàng tử bạch mã (5)
                                </a>
                            </li>
                                                    </ul>
                                        
                                        
            </ul>
        </main>
        <div class="black-click"></div>
    </section>
    
    <section id="bookmarks" class="rd_sidebar rdtoggle" aria-hidden="true">
        <main class="rdtoggle_body">
            <div class="rd_sidebar-header">
                <h2 class="rd_s-name"><i class="fas fa-bookmark"></i><a href="/bookmark" style="color: white;"> Bookmarks</a></h2>
            </div>
            <ul id="bookmarks_list" class="unstyled">
                                            <li>Bạn phải đăng nhập để sử dụng bookmark</li>
                                        </ul>
        </main>
        <div class="black-click"></div>
    </section>

    <section id="setting" class="rdtoggle" aria-hidden="true">
        <section class="re_set-in basic-section clear rdtoggle_body">
        <header class="sect-header"><span class="sect-title">Tùy chỉnh</span></header>
            <main class="sect-body">
                <div class="set-list set-color clear">
                    <label class="font-bold">Màu nền</label>
                    <div class="set-input clear justify-center">
                        <span data-color="#ffffff" data-id="0" style="background-color: #ffffff"></span>
                        <span data-color="#e6f0e6" data-id="1" style="background-color: #e6f0e6"></span>
                        <span data-color="#e3f5fa" data-id="2" style="background-color: #e3f5fa"></span>
                        <span data-color="#f6f4ec" data-id="3" style="background-color: #f6f4ec"></span>
                        <span data-color="#eae4d3" data-id="4" style="background-color: #eae4d3"></span>
                        <span data-color="#f5e9ef" data-id="5" style="background-color: #f5e9ef"></span>
                        <span data-color="#222222" data-id="6" style="background-color: #222222"></span>
                        <span data-color="#000000" data-id="7" style="background-color: #000000"></span>
                    </div>
                </div>
                <div class="set-list set-font-family clear">
                    <label class="font-bold">Font chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <select>
                            <option>Times New Roman</option>
                            <option>Merriweather</option>
                            <option>Lora</option>
                            <option>Roboto</option>
                            <option>Noto Sans</option>
                            <option>Nunito</option>
                        </select>
                    </div>
                </div>
                <div class="set-list set-font clear">
                    <label class="font-bold">Kích cỡ chữ</label>
                    <div class="set-slide set-input justify-center">    
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="16px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-margin clear">
                    <label class="font-bold">Bản lề</label>
                    <div class="set-slide set-input justify-center">
                        <span class="set-slide_button set-smaller"><i class="fas fa-chevron-left"></i></span>
                        <input class="set-slide_input" disabled="" value="20px" type="text">
                        <span class="set-bigger set-slide_button"><i class="fas fa-chevron-right"></i></span>
                    </div>
                </div>
                <div class="set-list set-text-align clear">
                    <label class="font-bold">Kiểu căn chỉnh</label>
                    <div class="set-input clear justify-center font-medium text-2xl flex flex-row gap-10">
                        <span data-align="text-left" class="p-1"><i class="fas fa-align-left"></i></span>
                        <span data-align="text-center" class="p-1"><i class="fas fa-align-center"></i></span>
                        <span data-align="text-right" class="p-1"><i class="fas fa-align-right"></i></span>
                        <span data-align="text-justify" class="p-1"><i class="fas fa-align-justify"></i></span>
                    </div>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>

    <section id="tts-panel" class="rdtoggle" aria-hidden="true">
        <section class="tts-settings basic-section clear rdtoggle_body">
            <header class="sect-header"><span class="sect-title">Text-to-Speech</span></header>
            <main class="sect-body">
                <div class="set-list clear" style="color: red; font-size: 14px; margin-bottom: 20px">
                    Đây là chức năng đang thử nghiệm, chi tiết xem tại <a href="/thao-luan/3305-chuc-nang-doc" style="color: blue">Link</a>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Giọng đọc</label>
                    <select id="tts-voice-select" class="w-full p-2 border rounded bg-white dark:bg-gray-800 text-sm dark:border-gray-600"></select>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Tốc độ</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-rate" min="0.1" max="3" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-rate-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="set-list clear">
                    <label class="font-bold block mb-2">Độ cao (Pitch)</label>
                    <div class="flex items-center space-x-2">
                        <input type="range" id="tts-pitch" min="0" max="2" step="0.1" value="1" class="flex-1 w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-500 dark:bg-gray-700 dark:accent-blue-400">
                        <span id="tts-pitch-value" class="text-sm font-medium min-w-[3rem]">1.0</span>
                    </div>
                </div>
                <div class="flex gap-2 pt-4">
                    <button id="tts-play-btn" class="flex-1 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Phát</button>
                    <button id="tts-pause-btn" class="flex-1 bg-yellow-500 hover:bg-yellow-600 active:bg-yellow-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Tạm dừng</button>
                    <button id="tts-stop-btn" class="flex-1 bg-red-500 hover:bg-red-600 active:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200 shadow-md">Dừng</button>
                </div>
            </main>
        </section>
        <div class="black-click"></div>
    </section>
    
    <div class="container">
        <div class="row">
            <div class="reading-content col-12 col-lg-10 offset-lg-1" style="word-wrap: break-word;">
                <div id="bookmark_top" class="block d-lg-none"><i class="fas fa-bookmark"></i></div>
                <span class="save_bookmark" style="position: absolute; top: 9999px; display: none"><i class="fas fa-bookmark"></i></span>
                
                
                
                <div class="title-top" style="padding-top: 20px">
                    <h2 class="title-item text-xl font-bold" align="center">Tập 1</h2>
                    <h4 class="title-item text-base font-bold" align="center">Chương 2: Những chàng hoàng tử bạch mã (1)</h4>
                    <h6 class="title-item font-bold" align="center" aria-hidden="true">
                        <a href="https://docln.net/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c292501-chuong-2-nhung-chang-hoang-tu-bach-ma-1#chapter-comments" style="text-decoration: underline">0 Bình luận</a> -
                        Độ dài: 3,202 từ - Cập nhật: 
                        <time class="topic-time timeago" title="18-01-2026 19:51:38" datetime="2026-01-18T19:51:38+07:00"></time>                    </h6>
                </div>

                <div style="text-align: center; margin: 20px auto -20px auto;">
                                                            <a href="https://docs.google.com/forms/d/e/1FAIpQLSe3y_bpPb6ADsKAgPWE3o3Jgzzftw8NKkp93_5vUayXLaQICg/viewform" target="_blank">
                        <img src="https://i2.hako.vip/vault/2025final_1.webp" style="width: 700px; height: auto">
                    </a>
                </div>

                <div id="chapter-content" class="long-text no-select text-justify">
                    <p style="display: none">Chương 2: Những chàng hoàng tử bạch mã (1)</p>
                    <p id="1">Ngôi làng bốc cháy.</p>
<p id="2">Dẫu đêm đã về khuya, bốn bề vẫn sáng rực như ban ngày. Hơn chục ngôi nhà chìm trong biển lửa, bất lực đổ sập xuống. Bất cứ nơi nào trong làng cũng biến thành địa ngục trần gian, hòa lẫn tiếng khóc trẻ thơ, tiếng rên rỉ của người già, tiếng gào thét của đàn ông và tiếng kêu thảm thiết của phụ nữ. Những xác chết nằm ngửa ngổn ngang trên đường lớn như thể chuyện chẳng có gì to tát. Giữa khung cảnh hỗn loạn ấy, tôi đứng đờ đẫn, ngước nhìn bầu trời đêm đang bị những vòng xoáy sắc màu đan xen xoay chuyển, miệng lẩm bẩm: "A, lại là nơi này."</p>
<p id="3">Đó là một ngôi làng nhỏ nằm ở phía Bắc Elevado. Tuy hiện giờ đã thuộc lãnh thổ nước khác, nhưng vào thời điểm đó, vùng phía Bắc Elevado vẫn nằm trong biên giới của Melbara. Tôi đã sống ở ngôi làng ấy hơn 50 năm. Tên làng là gì tôi chẳng còn nhớ rõ. Chỉ nhớ rằng con người nơi đó rất chất phác và chân thành. Những con người có tấm lòng lương thiện ấy đã chấp nhận một gã đàn ông kỳ lạ không rõ lai lịch, suốt nửa thế kỷ không hề già đi, trở thành một thành viên của ngôi làng.</p>
<p id="4">Khi ấy tôi vẫn còn một cái tên. Cũng có những người gọi tên tôi. Nhưng giờ tôi đã quên mất rồi. Chuyện cũng đã mấy trăm năm rồi còn gì.</p>
<p id="5">"——!"</p>
<p id="6">Đang rảo bước dọc theo con đường lớn chất đầy xác chết hướng về phía quảng trường, tôi khựng lại vì một tiếng gọi.</p>
<p id="7">Một người phụ nữ chắn ngang trước mặt tôi.</p>
<p id="8">Gương mặt lấm lem bụi đất, quần áo tả tơi, đầu ngón tay trầy trụa, máu thịt lẫn lộn. Mái tóc ngắn màu nâu vốn luôn được chải chuốt gọn gàng giờ rối bù, dính đầy những vệt máu khô. Chỉ có đôi mắt đang nhìn tôi là vẫn sáng ngời như thuở nào. Em luôn nhìn tôi bằng ánh mắt lẫm liệt và đầy khiêu khích như thế. Tôi không hề ghét ánh nhìn đó của em. Dù là giọng điệu có phần mạnh mẽ, tính cách tùy hứng, hay sự thất thường của em, thậm chí cả cái nết cố chấp không chịu giao du với ai, tôi đều thích tất cả. Thời gian thấm thoát thoi đưa, từ một đứa trẻ thành thiếu nữ, từ thiếu nữ thành một người phụ nữ, chỉ cần nhìn ngắm dáng vẻ trưởng thành của em thôi cũng đủ khiến tôi hạnh phúc vô cùng. Bởi tôi cảm giác đó như sự bù đắp cho những năm tháng tổn thương trong quá khứ của mình.</p>
<p id="9">Em là...</p>
<p id="10">Không, có vẻ như người đang đứng trước mặt tôi đây không nghĩ như vậy.</p>
<p id="11">"Thầy đang làm cái gì thế! Dừng lại ngay!"</p>
<p id="12">Em lao về phía tôi, túm lấy cánh tay tôi mà hét lên. Giọng nói bi thương ấy khắc sâu vào tâm khảm. Tên. Phải rồi, chẳng biết từ bao giờ em không còn gọi tôi là "Thầy" nữa, mà bắt đầu gọi thẳng tên tôi. Sự thay đổi ấy có ý nghĩa gì, tôi của khi đó vẫn chưa thể hiểu được. Quả nhiên tôi vẫn quá vụng về trong việc thấu hiểu lòng người.</p>
<p id="13">"Cứ thế này dân làng sẽ chết hết mất! Nên là dừng lại đi!"</p>
<p id="14">"... Không dừng được đâu."</p>
<p id="15">Tôi đáp lại bằng chất giọng khàn đặc.</p>
<p id="16">A. Biểu cảm thẫn thờ của em khi tôi nhìn thấy vào khoảnh khắc ấy... Cho dù hiện tại tôi đã quên cả tên mình, thì duy chỉ có điều đó là tôi không thể nào quên được.</p>
<p id="17">"Cho đến khi người trong làng chết hết thì ma pháp của tôi sẽ không dừng lại. Nên là bỏ cuộc đi."</p>
<p id="18">"Tại sao... rốt cuộc tại sao lại làm chuyện như thế...?"</p>
<p id="19">Tôi đã phạm phải một việc khiến bản thân hối hận suốt đời, tôi của khi đó đã nhận thức rõ điều này. Những lời van xin tha mạng của những người từng cười nói gọi tên tôi sẽ khiến tôi cả đời khó mà ngủ yên, tôi cũng biết rõ điều đó. Những tiếng oán hận và kêu gào thảm thiết vẫn còn văng vẳng bên tai, là tội lỗi được ban cho quãng thời gian gọi là sự sống vĩnh hằng mà tôi phải trải qua, tôi cũng biết rõ điều đó.</p>
<p id="20">Tôi từ từ đưa tay bóp lấy cổ em. Chiếc cổ mảnh khảnh còn vương hơi ấm nằm gọn trong hai tay tôi. Yếu ớt, nhưng dồn dập. Mạch đập của em đang nhảy múa trong lòng bàn tay tôi.</p>
<p id="21">Lúc đó tôi đã nói gì với em nhỉ?</p>
<p id="22">"Em thực sự... đến tận khoảnh khắc này cũng vẫn đẹp đến thế."</p>
<p id="23">Hình như không phải câu này. Nhưng có vẻ tôi đã nghĩ như vậy.</p>
<p id="24">Em thực sự rất đẹp.</p>
<p id="25">Cho đến tận khoảnh khắc cuối cùng.</p>
<p id="26">"Vĩnh biệt, Eve."</p>
<p id="27">Tôi siết chặt đôi tay đang bóp cổ em.</p>
<p id="28">Mi mắt em khẽ run rẩy. Trên gương mặt trắng bệch vì kinh hoàng thoáng hiện lên nỗi oán hận và nghi hoặc đối với tôi. Em giãy giụa trong tay tôi, dùng giọng nói không thành tiếng hỏi tôi: "Tại sao?". Tôi không thốt nên lời. Thế nên như để trốn tránh, tôi càng dùng sức siết chặt cổ em hơn nữa.</p>
<p id="29">Rắc, âm thanh ấy truyền qua lòng bàn tay.</p>
<p id="30">Chính nhờ cảm giác ớn lạnh của cái chết ấy.</p>
<p id="31">Mà cuối cùng tôi cũng tỉnh giấc.</p>
<p id="32">---</p>
<p id="33">"Hôm qua anh ngủ không ngon sao? Sắc mặt anh tệ quá."</p>
<p id="34">Kiiri nhìn bộ dạng ngáp ngắn ngáp dài uể oải của tôi, lo lắng hỏi. Cái trạng thái mà tôi vốn không muốn để lộ dường như đã bị nhìn thấu hoàn toàn, khiến tôi có chút chột dạ. Quả thật, số lượng thực khách tăng lên khiến ngay cả giấc mơ cũng trở nên phiền muộn. Có lẽ là do áp lực lo lắng không biết trong lúc tôi ngủ, Gallo có lẻn vào phòng bóp cổ tôi hay không.</p>
<p id="35">Tuy nhiên, tôi vẫn cố gắng trưng ra bộ mặt thản nhiên và đáp nhanh.</p>
<p id="36">"Làm sao mà ngon giấc nổi. Cái lũ kia cứ ngày đêm kéo đến làm loạn như thế."</p>
<p id="37">Tôi vừa chỉ tay ra ngoài cửa sổ, Kiiri lập tức hiểu ý, gật đầu "à" một tiếng.</p>
<p id="38">Ngoài cửa sổ hiện giờ có khoảng năm sáu tên đang đứng chôn chân, giăng biểu ngữ "Ma Vương ra đây!" suốt cả tiếng đồng hồ. Tên có vẻ là cầm đầu cưỡi trên một con bạch mã đeo yên cương cao cấp, trang bị vũ trang tận răng. Theo sau hắn là một gã kiếm sĩ cao khoảng 2 mét, một nữ tu sĩ dáng người bốc lửa, một lão pháp sư già lưng gù, cùng hai đứa nhóc trông chẳng rõ tác dụng là gì. Tên cầm đầu hô hào "Tiêu diệt Ma Vương!", đám người phía sau cũng khí thế hừng hực hùa theo nhịp điệu.</p>
<p id="39">Kể từ khi Gallo và Astrea ghé thăm, những vị khách không mời mà đến cứ liên tục tăng lên. Đám người này bất kể ngày đêm. Có nhóm thì tụ tập biểu tình trước cổng rồi bỏ đi, nhưng cũng có nhóm hôm qua đã chính thức trèo tường vào phóng hỏa trong sân, thực sự phiền phức không chịu nổi. Nhân tiện thì đám phóng hỏa đã bị Gallo tẩn cho một trận nhừ tử rồi tống cổ ra ngoài trước khi tôi kịp ra mặt. Lý do là dám cả gan phóng hỏa gây nguy hiểm tại nơi ở của Công chúa điện hạ. Chẳng biết là lòng trung thành cao hay đơn thuần là kẻ hết lòng cung phụng mù quáng nữa.</p>
<p id="40">"Chẳng phải có cuốn cẩm nang trở thành anh hùng sao? Nghe nói trong đó có mục bắt buộc phải tu luyện là 'Hét lời tuyên chiến đầy khí thế trước lâu đài Ma Vương' đấy."</p>
<p id="41">"Chà. Mấy kẻ tìm đến gần đây so với làm anh hùng thì muốn làm người giàu hơn đấy chứ? Bắt được tôi mang về là kiếm được tước vị, lại còn có khả năng kết hôn với cô nữa còn gì."</p>
<p id="42">"Nói cứ như chuyện nhà ai ấy nhỉ."</p>
<p id="43">Kiiri cười, nhún vai. Có vẻ cô ấy không muốn bàn sâu thêm về chủ đề này. Tôi cũng chẳng có ý định đổ lỗi tình trạng này cho Kiiri, nên chỉ im lặng quay đầu nhìn ra ngoài cửa sổ.</p>
<p id="44">Theo lời Gallo, hiện tại ở Wenz dường như đang lan truyền tin đồn ngầm rằng Ma Vương đã bắt cóc Công chúa điện hạ.</p>
<p id="45">Dù không có thông cáo chính thức nào, nhưng nghe nói hầu hết những người biết tin đồn đó đều coi đây là sự thật đã rồi. Đối với người tiêu diệt được Ma Vương và đưa Công chúa bình an trở về, nếu là thường dân sẽ được ban đất phong tước, nếu là quý tộc từ Bá tước trở lên sẽ được ban thưởng hậu hĩnh và hôn nhân với Công chúa. "Tất nhiên thần không phải vì mờ mắt trước vật chất mà đến cứu Công chúa điện hạ đâu!", Gallo cũng không quên biện minh cho bản thân mình như vậy.</p>
<p id="46">Mọi người bắt đầu đặt nghi vấn về sự biến mất của công chúa, kết quả là Quốc vương Wenz dường như đã bịa đặt rằng tôi bắt cóc nàng. Dù sao thì có méo miệng cũng chẳng thể nói ra sự thật là công chúa tự mình chạy đi tìm Ma Vương được. Dù oan uổng, nhưng xét việc tôi có tiền án tiền sự, nên tôi cũng chẳng còn gì để nói.</p>
<p id="47">Về phần tiền thưởng, có thể là do sau này thêm vào, cũng có thể là do Quốc vương đích thân ban bố. Nếu là vế sau, tôi trộm nghĩ, liệu năng lực của công chúa có lớn đến mức phải treo giải thưởng khổng lồ như thế để đoạt lại nàng bằng được hay không.</p>
<p id="48">Cũng phải, nàng được mệnh danh là thanh kiếm mạnh nhất đại lục mà. Chắc là cái danh tiếng ấy cũng được tận dụng triệt để cho mấy trò làm màu giữ thể diện với bên ngoài.</p>
<p id="49">"Ái chà. Những người kia, trông có vẻ như đang định làm gì đó."</p>
<p id="50">Lúc này, một lão già trông có vẻ là ma pháp sư trong hàng ngũ bỗng bước lên phía trước. Nói về diện mạo của lão, lưng thì còng, râu tóc bạc phơ dài thượt quét cả xuống đất, trông cơ thể yếu ớt đến mức phải dựa hẳn vào thanh gỗ dài có lẽ là ma trượng mới đứng vững được. Thay vì đứng đây hô hào bắt giữ Ma Vương, có lẽ lão nên đến bệnh viện ngay thì hơn.</p>
<p id="51">Lão già một tay nắm ma trượng, tay kia nâng cuốn sách ma pháp đang mở, bắt đầu ngâm xướng cấu trúc thức. Vì khoảng cách khá xa nên tôi nghe không rõ lắm. Tôi ngẩn ngơ nhìn vị ma pháp sư đáng thương kia, rồi khẽ hỏi Kiiri đang đứng bên cạnh.</p>
<p id="52">"Tôi thắc mắc từ nãy giờ rồi. Tại sao các ma pháp sư dạo gần đây cứ phải phô trương ta đây là ma pháp sư thế nhỉ? Trang phục thì y chang nhau, ngâm xướng cấu trúc thức thì cường điệu hóa, rốt cuộc là thiếu ma lực đến mức nào mới phải cầm theo ma trượng thế kia..."</p>
<p id="53">Trước đây thi thoảng cũng có mấy gã Dũng sĩ hô hào đòi bắt Ma Vương đến quấy rầy, về cơ bản thì cách ăn mặc của đám ma pháp sư trong đó cũng tương tự thế này. Nào là đội cái mũ chóp nhọn trông chẳng có chút tính thực dụng nào, rồi thì thêm thắt mấy cái hiệu ứng âm thanh ầm ầm đoàng đoàng lãng phí ma lực. Ngay cả gã ma pháp sư đang đứng ngoài kia cũng y hệt. Chẳng hiểu tại sao lại phải vác theo cuốn sách ma pháp nặng trịch đó làm gì. Nếu trình độ kém đến mức không thuộc nổi cấu trúc thức mà phải dùng phao cứu sinh, thì tốt nhất nên bỏ nghề ma pháp sư đi cho rồi.</p>
<p id="54">Trước thắc mắc của tôi, Kiiri vừa vuốt lại lọn tóc rơi xuống, vừa bắt đầu giải thích.</p>
<p id="55">"Một kiểu lễ nghi hình thức thôi. Dù sao thì khác với ngày xưa, thời đại bây giờ ma pháp sư rất được trọng vọng. Hơn nữa so với Morsaba, ma pháp sư ở Wenz đặc biệt hiếm hoi, nên chỉ cần biết sử dụng ma pháp là đã có được quyền lực rồi. Đương nhiên là phải ra sức khoe khoang rồi, đúng không?"</p>
<p id="56">"Morsaba là chỉ vùng đất phía Bắc Elevado sao?"</p>
<p id="57">Tôi hỏi lại về cái tên nghe quen quen này. Nhắc mới nhớ, 10 năm trước cha của Kiiri dẫn quân xâm nhập lâu đài của tôi cũng là để chiếm cứ điểm nhằm tấn công Morsaba thì phải.</p>
<p id="58">"Ừm. E rằng trong tất cả các quốc gia trên đại lục, Morsaba là nơi sở hữu nhiều ma pháp sư nhất. Hình như họ đã xây dựng chế độ sàng lọc những đứa trẻ có ma lực từ sớm để giáo dục đặc biệt. Chỉ cần có tài năng thì dù là người nước khác cũng được chấp nhận."</p>
<p id="59">Kiiri vừa giải thích xong thì câu thần chú của ma pháp sư cũng kết thúc. Lão ta ngửa mặt lên trời lầm bầm hét lớn, chắc cũng là lễ nghi hình thức thôi, cánh cổng thành bắt đầu đóng băng. Tôi và Kiiri đồng thanh thốt lên "Ồ".</p>
<p id="60">"Quả nhiên. Định dùng cách đóng băng cấp tốc để làm cổng thành vỡ vụn sao. Có điều vì thể tích quá lớn nên trông có vẻ khá tốn sức đấy."</p>
<p id="61">"Xem ra thực lực cũng khá đấy chứ?"</p>
<p id="62">"Bản thân cấu trúc thức không hề phức tạp. Chỉ là nhược điểm nằm ở chỗ thêm thắt quá nhiều câu điều kiện khiến công thức trở nên dài dòng. Thông thường để giảm thiểu sai số người ta sẽ vẽ ma pháp trận để thi triển, đằng này lại cố tình ngâm xướng một cách phô trương, xem ra là kẻ có tính cách quá thích làm màu rồi."</p>
<p id="63">"Cấu trúc thức? Là đang nói đến thần chú ma pháp sao?"</p>
<p id="64">Đôi mắt Kiiri sáng lấp lánh, để lộ rõ vẻ tò mò.</p>
<p id="65">"Nguyên lý ma pháp cũng tương tự như toán học vậy. Cứ coi như đó là các công thức được chuyển hóa thành ngôn ngữ là được. Hiện tượng ma pháp chính là phương trình để tìm ra đáp án. Ma pháp càng cao cấp thì cấu trúc thức càng dài và phức tạp, thế nên học thuộc lòng rất vất vả đúng không? Vì vậy mới phải dùng đến những thứ như ma pháp trận. Sự khác biệt nằm ở chỗ giải toán bằng tính nhẩm, giải bằng cách học vẹt, hay là viết hẳn công thức ra để giải. Và người kia đang giải bằng cách học vẹt."</p>
<p id="66">"Giống như học thuộc bảng cửu chương ấy hả?"</p>
<p id="67">"Đúng rồi, y hệt bảng cửu chương. Cô hiểu nhanh đấy."</p>
<p id="68">Tôi vừa cảm thán sự thông minh của Kiiri vừa xoa đầu cô ấy. Kiiri không hề che giấu vẻ mặt mãn nguyện, mỉm cười với tôi.</p>
<p id="69">Nhắc mới nhớ, không biết đã bao lâu rồi tôi mới lại giải thích về ma pháp cho người khác nghe như thế này. Rõ ràng trước đây tôi khá nhiệt tình với việc dạy dỗ. Rồi sau đó sẽ có một cô bé với đôi mắt sáng ngời cứ bám chặt lấy lưng tôi, miệng gọi "Thầy ơi, thầy ơi!" để hỏi han đủ điều về ma pháp... A. Trong giấc mơ hôm nay cũng xuất hiện chuyện đó nhỉ, thật là.</p>
<p id="70">Hễ hồi tưởng lâu một chút là y như rằng lôi ra cả những ký ức dư thừa.</p>
<p id="71">"Được rồi. Đuổi bọn họ đi thôi."</p>
<p id="72">Như muốn rũ bỏ những ký ức không vui vừa hiện lên, tôi đột ngột xắn tay áo, nói với giọng điệu đầy bi tráng. Cảm giác như tôi đang giận cá chém thớt lên những vị khách không mời này vậy. Biểu cảm của Kiiri cũng theo đó mà trở nên bi tráng, nhưng chuyện đó tạm thời khoan bàn tới, hai má cô ấy vẫn hừng hực hứng thú như mọi khi.</p>
<p id="73">"Đuổi thế nào?"</p>
<p id="74">"Can thiệp vào cấu trúc thức của kẻ đó để âm thầm sửa đổi công thức."</p>
<p id="75">"Sửa đổi công thức? Làm bằng cách nào?"</p>
<p id="76">"Ví dụ như lén viết thêm -1 vào cái công thức 1+1 mà gã ma pháp sư kia lập ra để tìm đáp án bằng 2. Như vậy thì giải toán theo công thức đó sẽ tuyệt đối không thể ra được đáp án chính xác nữa, đúng không?"</p>
<p id="77">"Ồ..., lấy ví dụ như vậy nghe có vẻ đơn giản thật đấy."</p>
<p id="78">"Quả thực về mặt nguyên lý thì đó là một ma pháp rất đơn giản. Có điều hiệu suất tiêu hao năng lượng rất tệ."</p>
<p id="79">"Hiệu suất tiêu hao tệ?"</p>
<p id="80">"Bởi vì bắt buộc phải tiêu tốn lượng ma lực gấp đôi đối phương sử dụng. Người bình thường mà dùng ma pháp này e là sẽ cạn kiệt ma lực mà gục ngã ngay tức khắc. Ừm, tất nhiên tiền đề là phải có đủ ma lực để mà cạn kiệt đã."</p>
<p id="81">"Hiệu suất kém như thế thì chẳng phải là đồ bỏ đi sao?"</p>
<p id="82">"Tại sao chứ? Hiệu suất kém một chút thì đã sao. Dù gì cũng chỉ có mình tôi dùng."</p>
<p id="83">"...Hửm?"</p>
<p id="84">Kiiri nghiêng đầu ngước nhìn tôi.</p>
<p id="85">"A, tôi chưa nói sao? Ma pháp này, là do tôi sáng tạo ra đấy."</p>
<p id="86">Khoảng 4 năm trước thì phải. Khi đó tôi quá mức buồn chán và cô đơn, nên đã thử sáng tạo ra ma pháp này với tâm trạng như đang tự đánh cờ một mình. Có thể nói đây là ma pháp khắc ghi sự nhàm chán và nỗi cô đơn của tôi. Tôi chẳng hơi đâu mà đi tính toán chi li để giảm thiểu tiêu hao năng lượng cho một ma pháp dùng để giết thời gian thế này. Đây cũng không phải thứ làm ra để đi khoe khoang với thiên hạ rằng: "Nhìn ma pháp này xem! Vừa to vừa đẹp đúng không?!".</p>
<p id="87">"Hả..., ưm. Các ma pháp sư bình thường cũng tự sáng tạo ma pháp để dùng sao? Em chưa từng nghe nói ông ma pháp sư Hoàng gia tự mình tạo ra ma pháp bao giờ."</p>
<p id="88">Giọng nói của Kiiri khi hỏi câu đó vô cùng chân thành. Tôi vừa thiết lập cấu trúc thức trong đầu vừa trả lời câu hỏi của Kiiri.</p>

                    <p style="display: none">Hãy bình luận để ủng hộ người đăng nhé!</p>
                    
                    <!-- <div class="flex justify-center mt-10 mb-7 space-x-3">
                        <a
                            href="https://hako.vn/discord"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #7289da; text-decoration: initial; color: white !important;">
                            <svg
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                xmlns="http://www.w3.org/2000/svg"
                                fill-rule="evenodd"
                                clip-rule="evenodd"
                                viewbox="0 0 24 24">
                                <path
                                d="M19.54 0c1.356 0 2.46 1.104 2.46 2.472v21.528l-2.58-2.28-1.452-1.344-1.536-1.428.636 2.22h-13.608c-1.356 0-2.46-1.104-2.46-2.472v-16.224c0-1.368 1.104-2.472 2.46-2.472h16.08zm-4.632 15.672c2.652-.084 3.672-1.824 3.672-1.824 0-3.864-1.728-6.996-1.728-6.996-1.728-1.296-3.372-1.26-3.372-1.26l-.168.192c2.04.624 2.988 1.524 2.988 1.524-1.248-.684-2.472-1.02-3.612-1.152-.864-.096-1.692-.072-2.424.024l-.204.024c-.42.036-1.44.192-2.724.756-.444.204-.708.348-.708.348s.996-.948 3.156-1.572l-.12-.144s-1.644-.036-3.372 1.26c0 0-1.728 3.132-1.728 6.996 0 0 1.008 1.74 3.66 1.824 0 0 .444-.54.804-.996-1.524-.456-2.1-1.416-2.1-1.416l.336.204.048.036.047.027.014.006.047.027c.3.168.6.3.876.408.492.192 1.08.384 1.764.516.9.168 1.956.228 3.108.012.564-.096 1.14-.264 1.74-.516.42-.156.888-.384 1.38-.708 0 0-.6.984-2.172 1.428.36.456.792.972.792.972zm-5.58-5.604c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332.012-.732-.54-1.332-1.224-1.332zm4.38 0c-.684 0-1.224.6-1.224 1.332 0 .732.552 1.332 1.224 1.332.684 0 1.224-.6 1.224-1.332 0-.732-.54-1.332-1.224-1.332z" />
                            </svg>
                            Discord
                        </a>
                        <a
                            href="https://fb.com/hako.page"
                            target="_blank"
                            type="button"
                            data-te-ripple-init
                            data-te-ripple-color="light"
                            class="flex font-sans rounded px-6 py-2.5 text-xs font-medium uppercase leading-normal text-white shadow-md transition duration-150 ease-in-out hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:shadow-lg"
                            style="background-color: #1877f2; text-decoration: initial; color: white !important;">
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                class="mr-2 h-4 w-4"
                                fill="currentColor"
                                viewBox="0 0 24 24">
                                <path
                                d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z" />
                            </svg>
                            Facebook
                        </a>
                    </div> -->

                                        <a href="/truyen/8476" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/8476/3269685b-c0ef-4013-a7d6-74104f39a24c.jpg?t=1739894654" class="d-none d-md-block" style="width: 970px; height: auto">
                    </a>
                    <a href="/truyen/8476" target="__blank">
                        <img src="https://i.hako.vn/ln/series/chapter-banners/8476/bf1184be-cf52-429e-8acb-0d29fb4eea33.jpg?t=1739894654" class="d-md-none" style="width: 100%; height: auto">
                    </a>
                    
                                    </div>

                <div style="text-align: center; margin: 20px auto 10px auto;">
                                                        </div>
                
                <section class="rd-basic_icon row">
                    <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c285673-chuong-1-chuyen-ta-chua-tung-nghi-toi-o-do-tuoi-cua-co-7" class="dark:text-black col text-center "><i class="fas fa-backward"></i></a>
                    <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem" class="dark:text-black col text-center"><i class="fas fa-home"></i></a>
                    <a href="/truyen/24523-ma-vuong-o-an-va-cong-chua-kiem/c292508-chuong-2-nhung-chang-hoang-tu-bach-ma-2" class="dark:text-black col text-center "><i class="fas fa-forward"></i></a>
                </section>
                
                <!--the code style is important to keep this comment section be out of the effect of user reading's setting-->
            </div>
            <div class="col-12 col-lg-10 offset-lg-1" aria-hidden="true">
                <section id="chapter-comments" class="basic-section dark:bg-[#1f1f1f] dark:text-white dark:border dark:border-[#1f1f1f]">
                    <header class="sect-header tab-list dark:bg-[#2a2a2a] dark:border-[#2a2a2a]"> 
                        <span class="sect-title tab-title" data-tab-index="1">Bình luận <span class="comments-count">(0)</span></span>
                    </header>
                    <main id="fbcmt_root" class="sect-body">
                        <span style="padding: 10px; display: inline-block;">Báo cáo bình luận không phù hợp ở <a href="/thao-luan/619-bao-cao-binh-luan" style="color: blue">đây</a></span>
                        <div id="tab-content-1" class="tab-content clear">
                            <section class="ln-comment">
    <header>
        <h3 class="text-lg font-bold dark:text-white">0 Bình luận </h3>
        <!-- <i id="refresh_comment" class="fas fa-refresh" aria-hidden="true" style="margin-left: 10px; font-size: 18px"></i></h3> -->
            </header>

    <main class="ln-comment-body">
                    <div class="ln-comment_sign-in long-text">
                Bạn phải <a href="/login">đăng nhập</a> hoặc <a href="/register">tạo tài khoản</a> để bình luận.
            </div>
                
        
        
        <div class="ln-comment-page">
</div>    </main>

    <script>
        var token = '5CAGulxnbnS3WR6Y1aiqo7CmRVaZu75jm08XtDsO';
        var comment_type = 'chapter';
        var comment_typeid = '292501';
    </script>

    </section>


                        </div>
                    </main>
                </section>
            </div> 
        </div>
    </div>
</main>

<script>
    token = '5CAGulxnbnS3WR6Y1aiqo7CmRVaZu75jm08XtDsO';
        
    function turnoffall() {
        $(".rdtoggle").removeClass("on");
        $(".rdtoggle_body").removeClass("animation fade-in-left-big fade-in-down");
        $("html").removeClass("overflow-hiden");
    }
    
    function rdtoggle(classicon, effect) {
        if ($(classicon).hasClass("on")) {
            turnoffall();
        } else {
            turnoffall();
            $(classicon).addClass("on");
            $("html").addClass("overflow-hiden");
            $(classicon + " .rdtoggle_body").addClass("animation " + effect);
        } 
    };
    
    $("#rd-setting_icon").on('click', function() {
        rdtoggle("#setting", "fade-in-down");                   
    });

    $("#rd-tts_icon").on('click', function() {
        rdtoggle("#tts-panel", "fade-in-down");
    });
        
    $("#rd-info_icon").on('click', function() {
        rdtoggle("#chapters", "fade-in-left-big");              
    });
        
    $("#rd-bookmark_icon").on('click', function() {
        rdtoggle("#bookmarks", "fade-in-left-big");                     
    });
        
    $(".black-click").on('click', function() {
        turnoffall();
        $("#rd-side_icon").hide();
        $("#bookmark_top").removeClass("on");
    });
        
    var bgcolor    = Cookies.get('color') || (Cookies.get('night_mode') ? 6 : 4);
    var fontfamily = Cookies.get('fontfamily') || '';
    var fontsize   = Cookies.get('font') || 18; 
    var margin     = Cookies.get('margin') || 0;
    var textAlign  = Cookies.get('textAlign') || 'text-justify';
        
    function setcolor(alter = true) {
        var switcher = $(".set-color .set-input span").eq(bgcolor);
        switcher.addClass("current");

        if (alter) {
            for (var i = 0; i < $(".set-color .set-input span").length; i++) {
                $("#mainpart").removeClass('style-' + i);
                $("#mainpart").removeClass('dark');
            }
            $("#mainpart").addClass('style-' + bgcolor);

            // Manually hardcoded to dark
            if (bgcolor >= 6) {
                $("#mainpart").addClass('dark');
            }
        }
    }

    // This creates unsmooth experience so we only use it for select box
    function setfontfamily() {
        $('.set-font-family select option').filter(function () {
            return fontfamily.split(',')[0].indexOf($(this).text()) != -1 ;
        }).attr('selected', true);
    }
        
    function setfontstyle(alter = true) {
        $(".set-font input.set-slide_input").val(fontsize + "px"); 

        if (alter) {
            $("div#chapter-content").css("font-size", fontsize + "px");

            var lineheight = +fontsize + 10;
            $("#chapter-content").css("line-height", lineheight + "px");
        }
    }
        
    function setmargin() {
        $(".set-margin input.set-slide_input").val(margin + "px"); 
        $("#chapter-content").css({
            'padding-left': margin + "px",
            'padding-right': margin + "px"
        });
    }

    function setTextAlign(alter = true) {
        var switcher = $(".set-text-align .set-input span[data-align='" + textAlign + "']");
        switcher.addClass("current");

        if (alter) {
            $(".set-text-align .set-input span").each(function () {
                $("#chapter-content").removeClass($(this).attr('data-align'));
            });

            $("#chapter-content").addClass(textAlign);
        }
    }
    
    setcolor(false);
    setfontfamily();
    setfontstyle(false);
    setmargin();
    setTextAlign(true);
    
    //1px = 0.0625rem;
    //16px = 1rem (default);
    
    $(".set-color .set-input span").click(function(){
        bgcolor = $(this).data("id");
        $(".set-color .set-input span").removeClass("current");
        setcolor();            
        Cookies.set('color', bgcolor, { expires: 365 });
    });

    $('.set-font-family select').on('change', function () {
        fontfamily = "'" + $('option:selected', this).text() + "', " + '\'Times New Roman\', Georgia, serif';
        
        $('div#chapter-content').css('font-family', fontfamily);

        Cookies.set('fontfamily', fontfamily, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-smaller").click(function () {
        fontsize = fontsize - 2;
        if (fontsize < 0) fontsize = 0;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-font .set-slide_button.set-bigger").click(function () {
        fontsize = +fontsize + 2;
        setfontstyle();
        Cookies.set('font', fontsize, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-smaller").click(function () {
        margin = margin - 20;
        if (margin < 0) margin = 0;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    });
    
    $(".set-margin .set-slide_button.set-bigger").click(function () {
        margin = +margin + 20;
        setmargin();
        Cookies.set('margin', margin, { expires: 365 });
    }); 

    $(".set-text-align .set-input span").click(function(){
        textAlign = $(this).data("align");
        $(".set-text-align .set-input span").removeClass("current");
        setTextAlign();        
        Cookies.set('textAlign', textAlign, { expires: 365 });
    });
        
    $("#bookmarks_list li").each(function(){
        var linepr = $(this).data("line");
        var preview = $(".reading-content p#" + linepr).text();

        var shortText = preview.trim().substring(0, 30) + "...";
        $(this).find(".pos_bookmark small").text(shortText);
    });

    $('div#chapter-content').html(
        $('div#chapter-content').html().replace(
            /\[note(\d+)\]/gi, 
            '<span id="anchor-note$1" class="note-icon none-print inline note-tooltip" data-tooltip-content="#note$1 .note-content" data-note-id="note$1"><i class="fas fa-sticky-note"></i></span><a id="anchor-note$1" class="inline-print none" href="#note$1">[note]</a>'
        )
    )
    
    tippy('.note-tooltip', {
        delay: 50,
        maxWidth: 240,
        interactive: true,
        content(ref) {
            const selector = ref.getAttribute('data-tooltip-content');
            const template = document.querySelector(selector);
            return template ? template.innerHTML : 'Đặt sai ID của note';
        }
    });
        
    isLoggedIn = 0;
    series_id = parseInt('24523');
    chapter_id = parseInt('292501');

    readingObject = {
        series_id: series_id,
        series_title: 'Ma Vương Ở Ẩn Và Công Chúa Kiếm',
        series_url: $('i.fa-home').first().parent().attr('href'),
        series_cover: $('.rd_sidebar-header a.img').css('background-image'),
        chapter_title: $('ul.sub-chap_list li.current a').text().trim(),
        chapter_url: $('ul.sub-chap_list li.current a').attr('href'),
        book_title: $('ul#chap_list > li.current a').text(),
        book_url: $('ul#chap_list > li.current a').attr('href'),
        read_time: +new Date() / 1000 | 0,
    };

// TTS Manager - Enhanced Web Speech API (Vietnamese). Chunked queue for long texts, no delays/interrupts.
const synth = window.speechSynthesis;
let voices = [];
let voicesLoaded = false;
let ttsRate = parseFloat(localStorage.getItem('tts-rate')) || 1;
let ttsPitch = parseFloat(localStorage.getItem('tts-pitch')) || 1;
let ttsState = 'idle'; // idle, speaking, paused, loading
let currentChunk = 0;
let totalChunks = 0;
let processingIndex = 0;
let paragraphs = [];
const BUFFER_SIZE = 5;

// --- Background Persistence (Wake Lock + Silent Audio) ---
let wakeLock = null;
const silentAudio = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTSVNFAAAAPAAADEVuY29kZWQgd2l0aCBMYW1lMy4xMDBhVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVUA==');
silentAudio.loop = true;

async function enableConnection() {
    // 1. Start Silent Audio Loop (tricks browser into thinking we are a music player)
    try {
        await silentAudio.play();
    } catch (err) {
        console.warn('Silent Audio Play Failed (likely no interaction):', err);
    }

    // 2. Request Screen Wake Lock (prevents screen from sleeping automatically)
    if ('wakeLock' in navigator) {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (err) {
            console.warn('Wake Lock Request Failed:', err);
        }
    }
}

function disableConnection() {
    // 1. Stop Silent Audio
    try {
        silentAudio.pause();
        silentAudio.currentTime = 0;
    } catch (e) {}

    // 2. Release Wake Lock
    if (wakeLock) {
        try {
            wakeLock.release();
            wakeLock = null;
        } catch (e) {}
    }
}

// Re-acquire Wake Lock if visibility changes and we are speaking
document.addEventListener('visibilitychange', async () => {
    if (wakeLock !== null && document.visibilityState === 'visible' && ttsState === 'speaking') {
        try {
            wakeLock = await navigator.wakeLock.request('screen');
        } catch (e) {}
    }
});
// ---------------------------------------------------------

let ttsVoiceIdx = localStorage.getItem('tts-voice') || '0';

function populateVoices() {
    voices = synth.getVoices().filter(v => v.lang.startsWith('vi'));
    voicesLoaded = true;
    let $select = $('#tts-voice-select');
    $select.empty();

    if (voices.length === 0) {
        $select.append('<option value="-1">Không có giọng Việt (cài Chrome/Edge)</option>');
        return;
    }

    voices.forEach((voice, idx) => {
        $select.append(`<option value="${idx}">${voice.name} (${voice.lang}) ${voice.default ? '(mặc định)' : ''}</option>`);
    });

    let idx = Math.max(0, Math.min(parseInt(ttsVoiceIdx), voices.length - 1));
    $select.val(idx);
}

function updateTTSUI(progress = '') {
    let $icon = $('#rd-tts_icon i');
    $icon.removeClass('fa-volume-up fa-volume-mute fa-spinner fa-spin');
    let $playBtn = $('#tts-play-btn'), $pauseBtn = $('#tts-pause-btn'), $stopBtn = $('#tts-stop-btn');
    $playBtn.prop('disabled', ttsState === 'speaking' || ttsState === 'loading'); // Enable on idle/paused
    $pauseBtn.prop('disabled', ttsState === 'idle');
    $stopBtn.prop('disabled', ttsState === 'idle');
    // Always remove old progress
    $('#tts-progress').remove();

    if (progress && totalChunks > 0) {
        $playBtn.after(`<span id="tts-progress" class="text-xs block text-center mt-1">${progress}</span>`);
    }

    if (ttsState === 'idle') {
        // Check resume preview
        const resumeData = loadResumeState();
        let currentParagraphs = $('#chapter-content p').map(function() {
            return $(this).text().trim();
        }).get().filter(p => p.trim().length > 0);

        if (resumeData && resumeData.total === currentParagraphs.length) {
            $playBtn.text(`Tiếp tục (${resumeData.index + 1}/${resumeData.total})`);
        } else {
            $playBtn.text('Phát');
        }

        $icon.addClass('fa-volume-up');
    } else if (ttsState === 'speaking' || ttsState === 'loading') {
        $icon.addClass('fa-volume-up fa-spinner fa-spin');
    } else if (ttsState === 'paused') {
        $icon.addClass('fa-volume-mute');
    }
}

$('#tts-play-btn').off('click').on('click', function() {
    // Always restart/resume from storage
    enableConnection(); // Start keep-alive
    synth.cancel();
    ttsState = 'idle';
    // queuedUtterances = []; // Removed global queue
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();

    if (!voicesLoaded || voices.length === 0) {
        ttsState = 'loading';
        updateTTSUI();
        setTimeout(() => {
            if (!voicesLoaded) {
                alert('Giọng nói chưa tải. Thử lại.');
                ttsState = 'idle';
                updateTTSUI();
                return;
            }
            playTTS();
        }, 500);
        return;
    }

    playTTS();
});

function createUtterance(item) {
    let u = new SpeechSynthesisUtterance(item.text);
    u.lang = 'vi-VN';
    u.rate = parseFloat($('#tts-rate').val()) || 1;
    u.pitch = parseFloat($('#tts-pitch').val()) || 1;
    let voiceIdx = parseInt($('#tts-voice-select').val());

    if (voiceIdx >= 0 && voices[voiceIdx]) {
        u.voice = voices[voiceIdx];
    }

    u.onstart = () => {
        currentChunk++;
        saveResumeState();
        updateTTSUI(`${currentChunk}/${totalChunks}`);
        
        // Highlight logic
        $('.current-reading').removeClass('current-reading');
        if (item.el) {
            $(item.el).addClass('current-reading');
            item.el.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        feedQueue(); // Ensure buffer is maintained
    };
    u.onerror = (event) => {
        console.error('TTS Error:', event.error, event);

        if (event.error !== 'interrupted') {
             // alert(`Lỗi TTS: ${event.error}. Bỏ qua đoạn.`);
             console.warn('TTS Error skipping chunk', event.error);
        }

        saveResumeState(); // Save on error
        feedQueue();
    };
    u.onend = () => {
        saveResumeState();

        if (currentChunk >= totalChunks) {
            clearResumeState();
            $('.current-reading').removeClass('current-reading'); // Cleanup
            
            // Auto-Next Logic
            let $nextBtn = $('.rd-basic_icon a').last();
            if ($nextBtn.length && !$nextBtn.hasClass('disabled')) {
                localStorage.setItem('tts-autoplay', 'true');
                window.location.href = $nextBtn.attr('href');
                return;
            }

            ttsState = 'idle';
            disableConnection(); // Cleanup
            currentChunk = 0;
            totalChunks = 0;
            processingIndex = 0;
            updateTTSUI();
        } else {
            feedQueue();
        }
    };
    u.onpause = () => { saveResumeState(); };
    return u;
}

function getStorageData() {
    try {
        return JSON.parse(localStorage.getItem('tts-resume-data')) || {};
    } catch {
        return {};
    }
}

function setStorageData(data) {
    localStorage.setItem('tts-resume-data', JSON.stringify(data));
}

function saveResumeState() {
    if (totalChunks > 0) {
        const data = getStorageData();
        data[chapter_id] = {
            index: currentChunk,
            total: totalChunks,
            timestamp: Date.now()
        };
        // Optional: Clean up old entries (older than 7 days?) to prevent infinite growth, 
        // but for now we just save.
        setStorageData(data);
    }
}

function clearResumeState() {
    const data = getStorageData();

    if (data[chapter_id]) {
        delete data[chapter_id];
        setStorageData(data);
    }
}

function loadResumeState() {
    const data = getStorageData();
    const saved = data[chapter_id];
    
    if (!saved) return null;
    
    if (Date.now() - saved.timestamp > 3600000 * 24 * 7) { // 7 days
        clearResumeState();
        return null;
    }

    return saved;
}

function initTTS() {
    populateVoices();
    $('#tts-rate').val(ttsRate);
    $('#tts-rate-value').text(ttsRate);
    $('#tts-pitch').val(ttsPitch);
    $('#tts-pitch-value').text(ttsPitch);
    updateTTSUI();
    
    if (localStorage.getItem('tts-autoplay') === 'true') {
        localStorage.removeItem('tts-autoplay');
        $(window).on('load', function() {
             setTimeout(() => {
                 $('#tts-play-btn').click(); 
             }, 500); 
        });
    }
}

function getParagraphs() {
    return $('#chapter-content p').map(function() {
        let text = $(this).text().trim();
        
        // If paragraph contains an image, replace with "Hình ảnh"
        if ($(this).find('img').length > 0) {
            text = 'Hình ảnh';
        }
        
        if (text.length > 0) {
            return { text: text, el: this };
        }
    }).get();
}

function feedQueue() {
    if (ttsState !== 'speaking') return;
    
    // Maintain buffer
    while (processingIndex < totalChunks && processingIndex < currentChunk + BUFFER_SIZE) {
        let u = createUtterance(paragraphs[processingIndex]);
        synth.speak(u);
        processingIndex++;
    }
}

function playTTS() {
    paragraphs = getParagraphs();
    if (paragraphs.length === 0) {
        alert('Không có nội dung để đọc.');
        ttsState = 'idle';
        disableConnection(); // Cleanup
        updateTTSUI();
        return;
    }
    
    const resumeData = loadResumeState();
    if (resumeData && resumeData.total === paragraphs.length) {
        currentChunk = resumeData.index;
        totalChunks = resumeData.total;
        // processingIndex needs to match what we are about to play
        // Current chunk is what finished, so we start processing from currentChunk?
        // Wait, currentChunk is "index of just finished" in some contexts?
        // No, in loadResume, index is currentChunk.
        // If saved index is 5. means 0..4 played.
        // We start playing from 5 (index).
        // So processingIndex = currentChunk.
        processingIndex = currentChunk;
    } else {
        clearResumeState();
        currentChunk = 0;
        totalChunks = paragraphs.length;
        processingIndex = 0;
    }
    
    synth.cancel();
    ttsState = 'speaking';
    
    feedQueue();
    updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
}

$('#tts-rate').on('input', function() {
    $('#tts-rate-value').text(this.value);
    localStorage.setItem('tts-rate', this.value);
});

$('#tts-pitch').on('input', function() {
    $('#tts-pitch-value').text(this.value);
    localStorage.setItem('tts-pitch', this.value);
});

$('#tts-voice-select').on('change', function() {
    localStorage.setItem('tts-voice', this.value);
});

$('#tts-pause-btn').off('click').on('click', function() {
    if (ttsState === 'speaking') {
        synth.pause();
        ttsState = 'paused';
        disableConnection(); // Pause keep-alive
        updateTTSUI();
        saveResumeState();
    } else if (ttsState === 'paused') {
        enableConnection(); // Resume keep-alive
        synth.resume();
        ttsState = 'speaking';
        updateTTSUI();
    }
});

$('#tts-stop-btn').off('click').on('click', function() {
    synth.cancel();
    // clearResumeState(); // Stop doesn't necessarily clear resume, usually just pause? 
    // But UI says "Stop". Let's clear resume state to consistent with old behavior 
    // or maybe optional? Old behavior cleared it.
    clearResumeState();
    
    disableConnection(); // Stop keep-alive
    $('.current-reading').removeClass('current-reading'); // Cleanup
    ttsState = 'idle';
    currentChunk = 0;
    totalChunks = 0;
    processingIndex = 0;
    updateTTSUI();
});

// Visibility handler removed - TTS continues on tab switch

// Long-press to start TTS from selected paragraph (500ms hold)
let longPressTimer = null;
let longPressTarget = null;

// $('#chapter-content p').on('touchstart mousedown', function(e) {
//     longPressTarget = this;
//     longPressTimer = setTimeout(() => {
//         const allParagraphs = getParagraphs();
//         const startIndex = allParagraphs.findIndex(p => p.el === longPressTarget);

//         if (startIndex === -1) return;

//         clearResumeState();
//         synth.cancel();
        
//         paragraphs = allParagraphs;
//         currentChunk = startIndex;
//         totalChunks = paragraphs.length;
//         processingIndex = startIndex;
//         ttsState = 'speaking';
        
//         enableConnection();
//         feedQueue();
//         updateTTSUI(`${currentChunk + 1}/${totalChunks}`);
//     }, 500);
// }).on('touchend touchmove mouseup mouseleave', function() {
//     clearTimeout(longPressTimer);
//     longPressTimer = null;
// });

synth.onvoiceschanged = populateVoices;
initTTS();
</script>



    
    <script src="/scripts/service-manager.js?r=4"></script>

    <script src="/scripts/app.js?id=a5a24eca66adcfc75cc0b2f62e2611db"></script>
    <script src="https://docln.net/vendor/livewire/livewire.min.js?id=df3a17f2"   data-csrf="5CAGulxnbnS3WR6Y1aiqo7CmRVaZu75jm08XtDsO" data-update-uri="/livewire/update" data-navigate-once="true"></script>

    
    <script src="https://confidecross.com/d5/6b/4b/d56b4bd6c3d2c1e161c4ab3c78c27670.js" async></script>

        
            <footer id="footer">
    <div class="container">
        <!--<span><a href="">Hako.re</a></span>-->
        <span class="right">Liên hệ: <a href="mailto:contact@hako.vn" target="_blank" style="color: #5fff46">contact@hako.vn</a></span>

        <span>© 2016 - 2026 Cổng Light Novel - Đọc Light Novel</span>
    </div>
</footer>    
    <div x-data x-show="$store.toast.on" @click="$store.toast.hide()" class="bg-teal-100 border-t-4 border-teal-500 rounded-b text-teal-900 px-4 py-3 shadow-md fixed w-3/4 md:w-1/2 z-20 inset-x-0 bottom-10 mx-auto" role="alert" style="display: none">
    <div class="flex">
        <div class="py-1"><svg class="fill-current h-6 w-6 text-teal-500 mr-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zm12.73-1.41A8 8 0 1 0 4.34 4.34a8 8 0 0 0 11.32 11.32zM9 11V9h2v6H9v-4zm0-6h2v2H9V5z"/></svg></div>
        <div>
            <p class="font-bold capitalize">Chú ý</p>
            <p class="text-sm" x-text="$store.toast.message"></p>
        </div>
    </div>
</div></body>
</html>
